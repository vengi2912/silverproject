System.register(["jimu-core","jimu-ui","jimu-layouts/layout-runtime","jimu-theme"],(function(e,t){var s={},o={},i={},n={};return{setters:[function(e){s.BrowserSizeMode=e.BrowserSizeMode,s.CONSTANTS=e.CONSTANTS,s.DataSourceManager=e.DataSourceManager,s.ExpressionPartType=e.ExpressionPartType,s.ExpressionResolverComponent=e.ExpressionResolverComponent,s.ExpressionResolverErrorCode=e.ExpressionResolverErrorCode,s.Immutable=e.Immutable,s.LinkType=e.LinkType,s.MultipleDataSourceComponent=e.MultipleDataSourceComponent,s.React=e.React,s.ReactDOM=e.ReactDOM,s.ReactResizeDetector=e.ReactResizeDetector,s.appConfigUtils=e.appConfigUtils,s.classNames=e.classNames,s.css=e.css,s.getAppStore=e.getAppStore,s.hooks=e.hooks,s.jsx=e.jsx,s.lodash=e.lodash,s.utils=e.utils,s.withRepeatedDataSource=e.withRepeatedDataSource},function(e){o.Button=e.Button,o.CropType=e.CropType,o.Draggable=e.Draggable,o.ImageFillMode=e.ImageFillMode,o.ImageWithParam=e.ImageWithParam,o.Link=e.Link,o.Loading=e.Loading,o.LoadingType=e.LoadingType,o.Modal=e.Modal,o.defaultMessages=e.defaultMessages},function(e){i.utils=e.utils},function(e){n.styled=e.styled}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=n},14321:e=>{"use strict";e.exports=o},23662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M7.5 0a.5.5 0 0 0-.5.5V7H.5a.5.5 0 0 0 0 1H7v6.5a.5.5 0 0 0 1 0V8h6.5a.5.5 0 0 0 0-1H8V.5a.5.5 0 0 0-.5-.5"></path></svg>'},37568:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M11.347 2.146a.485.485 0 0 1 0 .708L5.76 8l5.587 5.146a.486.486 0 0 1 0 .708.54.54 0 0 1-.738 0l-5.956-5.5a.485.485 0 0 1 0-.708l5.956-5.5a.54.54 0 0 1 .738 0" clip-rule="evenodd"></path></svg>'},41496:e=>{"use strict";e.exports=i},52943:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M4.653 13.854a.485.485 0 0 1 0-.708L10.24 8 4.653 2.854a.485.485 0 0 1 0-.708.54.54 0 0 1 .738 0l5.956 5.5a.485.485 0 0 1 0 .708l-5.956 5.5a.54.54 0 0 1-.738 0" clip-rule="evenodd"></path></svg>'},54502:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M0 7.5A.5.5 0 0 1 .5 7h14a.5.5 0 0 1 0 1H.5a.5.5 0 0 1-.5-.5"></path></svg>'},62838:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746z"></path></svg>'},73540:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M1 1v4h1V2h3V1zM15 1h-4v1h3v3h1zM1 15v-4h1v3h3v1zM15 15v-4h-1v3h-3v1z"></path><path fill="#000" fill-rule="evenodd" d="M4.182 10.546a4.5 4.5 0 0 0 5.991.334l2.14 2.14.708-.706-2.14-2.141a4.5 4.5 0 1 0-6.699.373m5.669-.72-.024.025a3.5 3.5 0 1 1 .024-.024" clip-rule="evenodd"></path></svg>'},79244:e=>{"use strict";e.exports=s}},t={};function a(s){var o=t[s];if(void 0!==o)return o.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,a),i.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="";var r={};return a.p=window.jimuConfig.baseUrl,(()=>{"use strict";a.r(r),a.d(r,{__set_webpack_public_path__:()=>ne,default:()=>ie});var e,t,s=a(79244),o=a(14321),i=a(41496);!function(e){e.ByUpload="BYUPLOAD",e.ByStaticUrl="BYSTATICURL",e.ByDynamicUrl="BYDYNAMICURL"}(e||(e={})),function(e){e.Expression="EXPRESSION",e.Attachment="ATTACHMENT",e.Symbol="SYMBOL"}(t||(t={}));var n=function(e,t,s,o){return new(s||(s=Promise))((function(i,n){function a(e){try{l(o.next(e))}catch(e){n(e)}}function r(e){try{l(o.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}l((o=o.apply(e,t||[])).next())}))};const l=["image/png","image/jpeg","image/gif","image/bmp","image/svg+xml","image/webp"];class c extends s.React.PureComponent{constructor(e){super(e),this.resolveExpressions=e=>n(this,void 0,void 0,(function*(){const t=e;let s=[];if(t&&t.attachmentInfos)s=t.attachmentInfos;else if(t&&t.queryAttachments)try{s=yield t.queryAttachments(l)}catch(e){console.error("Error querying attachments:",e)}this.props.onChange&&this.props.onChange(s)})),this.state={attachmentInfos:null}}componentDidMount(){this.resolveExpressions(this.props.record)}componentWillUnmount(){this.props.unmountAttachmentInfosChange&&this.props.unmountAttachmentInfosChange()}componentDidUpdate(e,t){var s,o,i,n;const a=(null===(s=this.props.record)||void 0===s?void 0:s.getId())===(null===(o=e.record)||void 0===o?void 0:o.getId()),r=(null===(i=this.props.record)||void 0===i?void 0:i.dataSource.id)===(null===(n=e.record)||void 0===n?void 0:n.dataSource.id);a&&r||this.resolveExpressions(this.props.record)}render(){return null}}class p extends s.React.PureComponent{constructor(e){super(e),this.isLoading=!1,this.resolveExpressions=e=>{if(e){const t=e;this.isLoading=!0,t&&t.fetchSymbolPreviewHTML&&t.fetchSymbolPreviewHTML().then((e=>{this.isLoading&&(this.isLoading=!1,this.setState({symbolElement:e}))}),(()=>{this.isLoading=!1}))}else this.isLoading=!1,this.setState({symbolElement:null})},this.shallowEquals=(e,t)=>!e&&!t||!(!e||!t)&&(Object.keys(e).length===Object.keys(t).length&&!Object.keys(e).some((s=>e[s]!==t[s]))),this.state={symbolElement:null}}componentDidMount(){this.resolveExpressions(this.props.record)}componentWillUnmount(){this.props.unmountSymbolElementChange&&this.props.unmountSymbolElementChange()}componentDidUpdate(e,t){this.shallowEquals(this.props.record,e.record)||this.resolveExpressions(this.props.record),t.symbolElement!==this.state.symbolElement&&this.props.onChange&&this.props.onChange(this.state.symbolElement)}render(){return null}}class u extends s.React.PureComponent{constructor(e){super(e),this.updateRecord=()=>{this.timer&&window.clearTimeout(this.timer),this.timer=window.setTimeout((()=>{const e=this.getSingleRecord(),t=null==e?void 0:e.dataSource.id,s=null==e?void 0:e.getId();!this.props.onRecordChange||this.previousDsId===t&&this.previousRecordId===s||this.props.onRecordChange(e),this.previousDsId=t,this.previousRecordId=s}),50)},this.shallowEquals=(e,t)=>!e&&!t||!(!e||!t)&&(Object.keys(e).length===Object.keys(t).length&&!Object.keys(e).some((s=>e[s]!==t[s]))),this.getSingleRecord=()=>{var e,t;if(this.props.isSelectedFromRepeatedDataSourceContext){const s=this.props.repeatedDataSource,o=Array.isArray(s)?null===(e=s[0])||void 0===e?void 0:e.record:null===(t=s)||void 0===t?void 0:t.record;return!o||o.fake?null:o}{if(!this.props.useDataSource)return null;const e=this.props.useDataSource.dataSourceId;if(e.split("-").reverse()[0]===s.CONSTANTS.SELECTION_DATA_VIEW_ID){const t=s.DataSourceManager.getInstance().getDataSource(e);let o=null==t?void 0:t.getRecords()[0];if(!o){const e=null==t?void 0:t.getMainDataSource().getDataView(s.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION);o=null==e?void 0:e.getRecords()[0]}return o}{const t=s.DataSourceManager.getInstance().getDataSource(e);return null==t?void 0:t.getRecords()[0]}}},this.onDataSourceCreated=e=>{if(e){const t={};Object.keys(e).forEach((s=>{s&&e[s]&&(t[s]=e[s].getInfo())})),this.setState({infos:t})}},this.onDataSourceInfoChange=e=>{this.setState({infos:e})},this.addDataViewForNoSelection=e=>{let t=(0,s.Immutable)([]);if(!e)return t;if(e.mainDataSourceId&&!t.some((t=>t.mainDataSourceId===e.mainDataSourceId))){const o=s.DataSourceManager.getInstance().getDataSource(e.mainDataSourceId),i=o&&o.getDataSourceJson();(null==i?void 0:i.dataViews)&&(null==i?void 0:i.dataViews[s.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION])&&(t=t.concat(e.set("dataSourceId",s.DataSourceManager.getInstance().getDataViewDataSourceId(e.mainDataSourceId,s.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION)).set("dataViewId",s.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION)))}return t.concat([e])},this.getQueries=e=>{const t={};return e?(e.forEach((e=>{t[e.dataSourceId]={}})),t):t},this.state={infos:null}}componentDidMount(){this.updateRecord()}componentWillUnmount(){this.timer&&(window.clearTimeout(this.timer),this.timer=null),this.props.onRecordChange(null)}componentDidUpdate(e,t){var s,o,i,n,a,r;this.props.isSelectedFromRepeatedDataSourceContext?this.props.repeatedDataSource===e.repeatedDataSource&&this.props.isSelectedFromRepeatedDataSourceContext===e.isSelectedFromRepeatedDataSourceContext&&(null===(i=null===(s=this.state.infos)||void 0===s?void 0:s[null===(o=this.props.useDataSource)||void 0===o?void 0:o.dataSourceId])||void 0===i?void 0:i.version)===(null===(r=null===(n=t.infos)||void 0===n?void 0:n[null===(a=this.props.useDataSource)||void 0===a?void 0:a.dataSourceId])||void 0===r?void 0:r.version)||this.updateRecord():this.props.useDataSource===e.useDataSource&&this.shallowEquals(this.state.infos,t.infos)||this.updateRecord()}render(){const e=this.addDataViewForNoSelection(this.props.useDataSource);return s.React.createElement(s.MultipleDataSourceComponent,{useDataSources:e,onDataSourceCreated:this.onDataSourceCreated,onDataSourceInfoChange:this.onDataSourceInfoChange,queries:this.getQueries(e),widgetId:this.props.widgetId})}}const h=(0,s.withRepeatedDataSource)(u);var d=a(37568),g=a.n(d),m=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};const f=e=>{const t=window.SVG,{className:o}=e,i=m(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",o);return t?s.React.createElement(t,Object.assign({className:n,src:g()},i)):s.React.createElement("svg",Object.assign({className:n},i))};var v=a(52943),x=a.n(v),y=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};const S=e=>{const t=window.SVG,{className:o}=e,i=y(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",o);return t?s.React.createElement(t,Object.assign({className:n,src:x()},i)):s.React.createElement("svg",Object.assign({className:n},i))},b={_widgetLabel:"Image",imageChooseShape:"Shape",imageCrop:"Crop",previousImage:"Previous image",nextImage:"Next image",imageViewer:"Image viewer"};var C=a(1888);const w=(0,C.styled)("div")(s.css`
  max-width: 100%;
  display: flex;
  justify-content: space-around;
  align-items: center;
  gap: 4px;
`),E=(0,C.styled)(o.Button)((({theme:e})=>s.css`
  padding: 0;
  width: 8px;
  height: 8px;
  background-color: rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(255, 255, 255, 0.7);
  border-radius: 4px;
  transition: ${e.sys.transitions.create("width")};
  &.active {
    width: 14px;
    background-color: ${e.sys.color.primary.light};
    border: 1px solid rgba(255, 255, 255, 1);
    border-radius: 4px;
  }
`)),T=e=>{const{imageCount:t=0,currentIndex:o=0,className:i,style:n,onChange:a}=e;if(t<1)return null;const r=new Array(t).fill("");return(0,s.jsx)(w,{className:i,style:n},r.map(((e,t)=>(0,s.jsx)(E,{key:t,variant:"contained",className:(0,s.classNames)("dot",{active:o===t}),onClick:()=>{a(t)}}))))},R=e=>s.css`
    ${e?`height: ${e}px !important;`:""}
    .dots-nav {
      max-width: 100%;
      position: absolute;
      z-index: 1;
      bottom: 5%;
      left: 50%;
      transform: translateX(-50%);
    }
    .image-gallery-content {
      position: relative;
      overflow: hidden;
      .image-gallery-item {
        transition: all .3s ease;
        position: absolute;
        inset: 0;
        opacity: 0;
        z-index: -1;
      }
      .image-gallery-current {
        position: unset;
        opacity: 1;
      }
      .image-gallery-current.image-gallery-current-loading {
        opacity: 0;
      }
      .image-gallery-previous {
        filter: blur(3px);
      }
      .image-gallery-previous.image-gallery-current-loading {
        opacity: 1;
      }
    }
    .image-gallery-button {
      color: rgba(255, 255, 255, 0.8);
      svg {
        height: 32px;
        filter: drop-shadow(0 0 4px #000);
      }
      &:hover {
        color: rgba(255, 255, 255, 1);
        svg {
          filter: drop-shadow(0 0 6px #000);
        }
      }
    }
  `;class I extends s.React.PureComponent{constructor(e){super(e),this.backImg=e=>{const t=this.getPreviousIndex(),s=[...this.state.statusArray];s[t]||(s[t]="loading"),this.setState({currentIndex:t,oldIndex:this.state.currentIndex,statusArray:s,height:"loading"===s[t]?this.rootRef.current.clientHeight:null}),null==e||e.preventDefault(),null==e||e.stopPropagation()},this.forwardImg=e=>{const t=this.getNextIndex(),s=[...this.state.statusArray];s[t]||(s[t]="loading"),this.setState({currentIndex:t,oldIndex:this.state.currentIndex,statusArray:s,height:"loading"===s[t]?this.rootRef.current.clientHeight:null}),null==e||e.preventDefault(),null==e||e.stopPropagation()},this.setCurrentImg=e=>{if(this.state.currentIndex===e)return;const t=[...this.state.statusArray];t[e]||(t[e]="loading"),this.setState({currentIndex:e,oldIndex:this.state.currentIndex,statusArray:t,height:"loading"===t[e]?this.rootRef.current.clientHeight:null})},this.handleLoad=e=>{const t=[...this.state.statusArray];t[e]="loaded",this.setState({statusArray:t,height:null})},this.handleTouchStart=e=>{1===e.touches.length&&(this.touchStart={x:e.touches[0].clientX,y:e.touches[0].clientY})},this.handleTouchMove=e=>{if(1!==e.touches.length)return;this.touchMove={x:e.touches[0].clientX,y:e.touches[0].clientY};const t=this.touchMove.x-this.touchStart.x,s=this.touchMove.y-this.touchStart.y;Math.abs(t)>Math.abs(s)&&(null==e||e.preventDefault())},this.handleTouchEnd=e=>{const t=this.props.sources||[];if(void 0!==this.touchStart&&void 0!==this.touchMove&&t.length>1){const t=this.touchMove.x-this.touchStart.x,s=this.touchMove.y-this.touchStart.y;Math.abs(t)>Math.abs(s)&&(t<-50&&this.forwardImg(e),t>50&&this.backImg(e))}this.touchStart=void 0,this.touchMove=void 0},this.rootRef=s.React.createRef(),this.state={currentIndex:0,oldIndex:null,statusArray:["loading"],height:null}}componentDidMount(){this.rootRef.current.addEventListener("touchstart",this.handleTouchStart,{passive:!1}),this.rootRef.current.addEventListener("touchmove",this.handleTouchMove,{passive:!1}),this.rootRef.current.addEventListener("touchend",this.handleTouchEnd,{passive:!1})}componentWillUnmount(){this.rootRef.current.removeEventListener("touchstart",this.handleTouchStart),this.rootRef.current.removeEventListener("touchmove",this.handleTouchMove),this.rootRef.current.removeEventListener("touchend",this.handleTouchEnd)}componentDidUpdate(e,t){e.sources!==this.props.sources&&this.setState({currentIndex:0,oldIndex:null,statusArray:["loading"],height:null})}getPreviousIndex(){return this.state.currentIndex>0?this.state.currentIndex-1:this.props.sources.length-1}getNextIndex(){return this.state.currentIndex<this.props.sources.length-1?this.state.currentIndex+1:0}render(){const{intl:e,toolTipWithAttachmentName:t,toolTip:i,altTextWithAttachmentName:n,altText:a,imageParam:r,size:l,imageFillMode:c,isAutoHeight:p,isAutoWidth:u,browserSizeMode:h}=this.props,d=this.props.sources||[],g=this.props.sources,{currentIndex:m,oldIndex:v,statusArray:x,height:y}=this.state,C=e.formatMessage({id:"previousImage",defaultMessage:b.previousImage}),w=e.formatMessage({id:"nextImage",defaultMessage:b.nextImage}),E="loading"===x[m]&&d.length>0,I=!g,j=h===s.BrowserSizeMode.Large;return(0,s.jsx)("div",{ref:this.rootRef,className:"w-100 h-100",css:R(y)},d&&d.length>1&&j&&(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)(o.Button,{icon:!0,variant:"text",size:"sm",disableHoverEffect:!0,disableRipple:!0,className:"image-gallery-button",style:{padding:0,top:"50%",transform:"translateY(-50%)",position:"absolute",left:0,zIndex:1},"aria-label":C,onClick:this.backImg},(0,s.jsx)(f,{size:26})),(0,s.jsx)(o.Button,{icon:!0,variant:"text",size:"sm",disableHoverEffect:!0,disableRipple:!0,className:"image-gallery-button",style:{padding:0,top:"50%",transform:"translateY(-50%)",position:"absolute",right:0,zIndex:1},"aria-label":w,onClick:this.forwardImg},(0,s.jsx)(S,{size:26}))),d&&d.length>1&&!j&&(0,s.jsx)(T,{className:"dots-nav",imageCount:d.length,currentIndex:m,onChange:this.setCurrentImg}),(0,s.jsx)("div",{className:"image-gallery-content w-100 h-100"},(E||I)&&(0,s.jsx)(o.Loading,{type:o.LoadingType.Donut,width:16,height:16}),d.map(((e,h)=>{let d={};x[h]&&(r.set?d=r.set("url",e.url):d.url=e.url);const g=t?e.name:i,f=n?e.name:a,y=h===m,S=h===v;return(0,s.jsx)(o.ImageWithParam,{key:e.id,className:(0,s.classNames)("image-gallery-item w-100 h-100",{"image-gallery-current":y,"image-gallery-previous":S,"image-gallery-current-loading":E}),imageParam:d,useFadein:!0,size:l,imageFillMode:c,isAutoHeight:p,isAutoWidth:u,toolTip:g,altText:f,onLoad:()=>{this.handleLoad(h)}})})),g&&0===g.length&&(0,s.jsx)(o.ImageWithParam,{imageParam:r,useFadein:!0,size:l,imageFillMode:c,isAutoHeight:p,isAutoWidth:u})))}}var j=a(62838),D=a.n(j),O=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};const M=e=>{const t=window.SVG,{className:o}=e,i=O(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",o);return t?s.React.createElement(t,Object.assign({className:n,src:D()},i)):s.React.createElement("svg",Object.assign({className:n},i))};var k=a(73540),N=a.n(k),A=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};const P=e=>{const t=window.SVG,{className:o}=e,i=A(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",o);return t?s.React.createElement(t,Object.assign({className:n,src:N()},i)):s.React.createElement("svg",Object.assign({className:n},i))};var W=a(54502),L=a.n(W),U=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};const z=e=>{const t=window.SVG,{className:o}=e,i=U(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",o);return t?s.React.createElement(t,Object.assign({className:n,src:L()},i)):s.React.createElement("svg",Object.assign({className:n},i))};var H=a(23662),F=a.n(H),_=function(e,t){var s={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(s[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(s[o[i]]=e[o[i]])}return s};const B=e=>{const t=window.SVG,{className:o}=e,i=_(e,["className"]),n=(0,s.classNames)("jimu-icon jimu-icon-component",o);return t?s.React.createElement(t,Object.assign({className:n,src:F()},i)):s.React.createElement("svg",Object.assign({className:n},i))},V=(0,C.styled)("div")(s.css`
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
`),$=(0,C.styled)("img")((({theme:e,styleState:t})=>s.css`
    width: 100%;
    height: 100%;
    object-fit: contain;
    scale: ${t.scale};
    user-select: none;
    cursor: pointer;
  `)),Y=(0,C.styled)("div")((({theme:e})=>s.css`
  height: 36px;
  border-radius: 18px;
  background-color: ${e.sys.color.surface.overlay};
  position: absolute;
  left: 50%;
  bottom: 56px;
  transform: translateX(-50%);
  display: flex;
  gap: 8px;
  align-items: center;
`)),q=(0,C.styled)(o.Button)((({theme:e})=>s.css`
  background-color: transparent;
  color: ${e.sys.color.surface.overlayText};
`)),X=(0,C.styled)("span")((({theme:e})=>s.css`
  color: ${e.sys.color.surface.overlayText};
  font-size: 16px;
  width: 50px;
  text-align: center;
`)),G=e=>{const{src:t,isCurrent:i}=e,[n,a]=s.React.useState({x:0,y:0}),[r,l]=s.React.useState(1),[c,p]=s.React.useState(!0),u=s.hooks.useTranslation(o.defaultMessages),h=s.React.useRef(null),d=s.React.useRef(null),g=s.React.useCallback((e=>{p(!1)}),[]),m=s.React.useCallback((()=>{l((e=>{let t=e;if(e>.1){const s=e>1?.2:.1;t=Math.round(10*(e-s))/10}else t=.1;return t}))}),[]),f=s.React.useCallback((()=>{l((e=>{let t=e;if(e<10){const s=e>=1?.2:.1;t=Math.round(10*(e+s))/10}else t=10;return t}))}),[]),v=s.React.useCallback((e=>{e.deltaY>0?m():f(),e.preventDefault(),e.stopPropagation()}),[f,m]);s.React.useEffect((()=>{const e=h.current;if(e)return e.addEventListener("wheel",v,{passive:!1}),()=>{e.removeEventListener("wheel",v)}}),[v]);const x=s.React.useCallback(((e,t)=>{s.ReactDOM.flushSync((()=>{a({x:t.x,y:t.y})}))}),[]),y=s.React.useRef(null),S=s.React.useRef(null),b=s.hooks.useLatest(r),C=s.React.useCallback((e=>{2===e.targetTouches.length&&(y.current=Math.hypot(e.touches[0].clientX-e.touches[1].clientX,e.touches[0].clientY-e.touches[1].clientY),S.current=b.current)}),[b]),w=s.React.useCallback((e=>{if("number"==typeof y.current&&2===e.targetTouches.length){const t=Math.hypot(e.touches[0].clientX-e.touches[1].clientX,e.touches[0].clientY-e.touches[1].clientY);let o=S.current*t/y.current;o<.1?o=.1:o>10&&(o=10),s.ReactDOM.flushSync((()=>{l(o)}))}}),[]),E=s.React.useCallback((e=>{"number"==typeof y.current&&(y.current=null,S.current=null)}),[]),T=s.React.useMemo((()=>"number"==typeof r?s.utils.formatPercentageNumber(Math.round(100*r*10)/10+"%"):""),[r]);return(0,s.jsx)(V,{ref:h,className:(0,s.classNames)({"d-none":!i}),onTouchStart:C,onTouchMove:w,onTouchEnd:E},(0,s.jsx)(o.Draggable,{bounds:!1,position:n,onDrag:x},(0,s.jsx)("div",{className:"w-100 h-100"},(0,s.jsx)($,{ref:d,src:t,draggable:!1,className:"jimu-image-viewer-image",styleState:{scale:r},onLoad:g,onError:g}),c&&(0,s.jsx)(o.Loading,{type:o.LoadingType.Donut}))),(0,s.jsx)(Y,{className:"jimu-image-viewer-tools"},(0,s.jsx)(q,{className:"jimu-image-viewer-zoom-out","aria-label":u("zoomOut"),disableHoverEffect:!0,disableRipple:!0,icon:!0,variant:"text",onClick:m},(0,s.jsx)(z,null)),(0,s.jsx)(X,{className:"jimu-image-viewer-percent"},T),(0,s.jsx)(q,{className:"jimu-image-viewer-zoom-in","aria-label":u("zoomIn"),disableHoverEffect:!0,disableRipple:!0,icon:!0,variant:"text",onClick:f},(0,s.jsx)(B,null))))},Q=(0,C.styled)(o.Button)(s.css`
  position: absolute;
  z-index: 1;
  top: 8px;
  right: 8px;
  border-radius: 50%;
  border: none;
  opacity: .7;
  &:hover {
    opacity: 1;
  }
`),J=(0,C.styled)(o.Modal)(s.css`
&.modal-dialog {
  width: 100%;
  height: 100%;
  max-width: 100vw;
  margin: 0;
  backdrop-filter: blur(3px);
  .modal-content{
    width: 100%;
    height: 100%;
    border: 0 !important;
    background-color: transparent !important;
  }
}
`),K=(0,C.styled)("div")(s.css`
  width: 100%;
  height: 100%;
  .jimu-image-viewer-dots {
    position: absolute;
    z-index: 1;
    bottom: 24px;
    left: 50%;
    transform: translateX(-50%);
  }
`),Z=(0,C.styled)(o.Button)(s.css`
  position: absolute;
  right: 8px;
  top: 8px;
  border-radius: 50%;
  border: none;
  opacity: 0.7;
  &:hover {
    opacity: 1;
  }
`),ee=(0,C.styled)(o.Button)((({styleState:e})=>s.css`
  position: absolute;
  ${"previous"===e.type?"left: 8px;":""}
  ${"next"===e.type?"right: 8px;":""}
  top: 50%;
  translate: 0 -50%;
  padding: 0;
  color: rgba(255, 255, 255, 0.8);
  svg {
    height: 32px;
    filter: drop-shadow(0 0 4px #000);
  }
  &:hover {
    color: rgba(255, 255, 255, 1);
    svg {
      filter: drop-shadow(0 0 6px #000);
    }
  }
`)),te=e=>{const{srcList:t=[],defaultIndex:i=0}=e,[n,a]=s.React.useState(!1),[r,l]=s.React.useState(0),[c,p]=s.React.useState([i]),u=s.hooks.useTranslation(b,o.defaultMessages),h=s.React.useCallback((e=>{const t=e;l(t),c.includes(t)||p((e=>{const s=[...e];return s.push(t),s}))}),[c]),d=s.React.useCallback((()=>{let e=r-1;e<0&&(e=t.length-1),h(e)}),[r,h,t.length]),g=s.React.useCallback((()=>{let e=r+1;e>t.length-1&&(e=0),h(e)}),[r,h,t.length]);s.React.useEffect((()=>{const e=e=>{"ArrowLeft"===e.key?d():"ArrowRight"===e.key&&g()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[g,d]);const m=t.length>1;return(0,s.jsx)(s.React.Fragment,null,t.length>0&&(0,s.jsx)(Q,{"aria-label":u("imageViewer"),disableHoverEffect:!0,icon:!0,variant:"contained",size:"sm",onClick:e=>{a(!0),e.stopPropagation()}},(0,s.jsx)(P,null)),(0,s.jsx)(J,{isOpen:n,centered:!0,keyboard:!0,toggle:e=>{"keyup"===e.type&&"Escape"===e.key&&a(!1)}},(0,s.jsx)(K,null,t.filter(((e,t)=>e&&c.includes(t))).map(((e,t)=>(0,s.jsx)(G,{key:t,isCurrent:r===t,src:s.appConfigUtils.processResourceUrl(e)}))),(0,s.jsx)(Z,{className:"jimu-image-viewer-close","aria-label":u("closeTour"),icon:!0,disableHoverEffect:!0,variant:"contained",size:"sm",onClick:()=>{a(!1)}},(0,s.jsx)(M,null)),m&&(0,s.jsx)(s.React.Fragment,null,(0,s.jsx)(ee,{className:"jimu-image-viewer-previous","aria-label":u("previous"),disableHoverEffect:!0,disableRipple:!0,icon:!0,variant:"text",styleState:{type:"previous"},onClick:d},(0,s.jsx)(f,{autoFlip:!0,size:26})),(0,s.jsx)(ee,{className:"jimu-image-viewer-next","aria-label":u("next"),disableHoverEffect:!0,disableRipple:!0,icon:!0,variant:"text",styleState:{type:"next"},onClick:g},(0,s.jsx)(S,{autoFlip:!0,size:26}))),m&&(0,s.jsx)(T,{className:"jimu-image-viewer-dots",imageCount:t.length,currentIndex:r,onChange:h}))))},se={};class oe extends s.React.PureComponent{constructor(t){var o,i,n,a,r,l,c,p,u,h,d,g,m,f;super(t),this.__unmount=!1,this.widgetConRef=s.React.createRef(),this.checkIsStaticSrc=t=>t===e.ByUpload||t===e.ByStaticUrl||!t,this.getSrcExpression=()=>this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.srcExpression||(0,s.Immutable)({name:"",parts:[{type:s.ExpressionPartType.String,exp:`"${this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.imageParam&&this.props.config.functionConfig.imageParam.url}"`}]}),this.getAltTextExpression=()=>this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.altTextExpression||(0,s.Immutable)({name:"",parts:[{type:s.ExpressionPartType.String,exp:`"${this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.altText}"`}]}),this.getToolTipExpression=()=>this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.toolTipExpression||(0,s.Immutable)({name:"",parts:[{type:s.ExpressionPartType.String,exp:`"${this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.toolTip}"`}]}),this.getLinkUrlExpression=()=>this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.linkParam&&this.props.config.functionConfig.linkParam&&this.props.config.functionConfig.linkParam.expression||null,this.onSrcExpResolveChange=e=>{if(e.isSuccessful)this.setState({src:"null"===e.value?"":e.value});else{let t="";e.value===s.ExpressionResolverErrorCode.Failed&&(t=this.state.srcExpression&&this.state.srcExpression.name),this.setState({src:t})}},this.onToolTipExpResolveChange=e=>{if(e.isSuccessful)this.setState({toolTip:"null"===e.value?"":e.value});else{let t="";e.value===s.ExpressionResolverErrorCode.Failed&&(t=this.state.srcExpression&&this.state.srcExpression.name),this.setState({toolTip:t})}},this.onAltTextExpResolveChange=e=>{if(e.isSuccessful)this.setState({altText:"null"===e.value?"":e.value});else{let t="";e.value===s.ExpressionResolverErrorCode.Failed&&(t=this.state.srcExpression&&this.state.srcExpression.name),this.setState({altText:t})}},this.onLinkUrlExpResolveChange=e=>{if(e.isSuccessful)this.setState({linkUrl:e.value});else{let t="";e.value===s.ExpressionResolverErrorCode.Failed&&(t=this.state.srcExpression&&this.state.srcExpression.name),this.setState({linkUrl:t})}},this.onAttachmentInfosChange=e=>{this.setState({attachmentInfos:e})},this.unmountAttachmentInfosChange=()=>{this.setState({attachmentInfos:[]})},this.onSymbolElementChange=e=>{var t;const s=["IMG","SVG"].includes(null==e?void 0:e.tagName)?e:null===(t=null==e?void 0:e.querySelector)||void 0===t?void 0:t.call(e,"svg,img");if(s){const{altText:e}=this.state;s.setAttribute("alt",e)}this.setState({symbolElement:e})},this.unmountSymbolElementChange=()=>{this.setState({symbolElement:null})},this.getRecordsFromRepeatedDataSource=()=>{const e=this.props.useDataSources&&this.props.useDataSources[0]&&this.props.useDataSources[0].dataSourceId;if(e&&this.props.repeatedDataSource&&e===this.props.repeatedDataSource.dataSourceId){const t=this.props.repeatedDataSource.record;return{[e]:t}}return null},this.onClick=e=>{const t=this.props.config.functionConfig.linkParam;t&&t.value&&t.linkType!==s.LinkType.None&&(e.exbEventType="linkClick")},this.getWidgetWidth=()=>this.state.widgetWidth,this.getWidgetHeight=()=>this.state.widgetHeight,this.onResize=(e,t)=>{this.__unmount||(e||t)&&(e===this.state.widgetWidth&&t===this.state.widgetHeight||(se[this.props.id+"-"+this.props.layoutId]={width:e,height:t},this.setState({widgetWidth:e,widgetHeight:t})))},this.onCropWidgetResize=({width:e,height:t})=>{this.__unmount||(e||t)&&this.setState({cropWidgetWidth:e,cropWidgetHeight:t})},this.clearCropWidgetSize=()=>{this.setState({cropWidgetWidth:null,cropWidgetHeight:null})},this.handleRecordChange=e=>{this.setState({record:e,attachmentInfos:null})},this.debounceOnResize=s.lodash.debounce((({width:e,height:t})=>{this.onResize(e,t)}),200),this.state={record:null,toolTip:(null===(n=null===(i=null===(o=this.props)||void 0===o?void 0:o.config)||void 0===i?void 0:i.functionConfig)||void 0===n?void 0:n.toolTip)||"",altText:(null===(l=null===(r=null===(a=this.props)||void 0===a?void 0:a.config)||void 0===r?void 0:r.functionConfig)||void 0===l?void 0:l.altText)||"",src:(null===(h=null===(u=null===(p=null===(c=this.props)||void 0===c?void 0:c.config)||void 0===p?void 0:p.functionConfig)||void 0===u?void 0:u.imageParam)||void 0===h?void 0:h.url)||"",linkUrl:(null===(f=null===(m=null===(g=null===(d=this.props)||void 0===d?void 0:d.config)||void 0===g?void 0:g.functionConfig)||void 0===m?void 0:m.linkParam)||void 0===f?void 0:f.value)||"",srcExpression:this.props.useDataSourcesEnabled&&this.getSrcExpression(),altTextExpression:this.props.useDataSourcesEnabled&&this.getAltTextExpression(),toolTipExpression:this.props.useDataSourcesEnabled&&this.getToolTipExpression(),linkUrlExpression:this.props.useDataSourcesEnabled&&this.getLinkUrlExpression(),attachmentInfos:[],symbolElement:null,widgetWidth:se[this.props.id+"-"+this.props.layoutId]&&se[this.props.id+"-"+this.props.layoutId].width,widgetHeight:se[this.props.id+"-"+this.props.layoutId]&&se[this.props.id+"-"+this.props.layoutId].height,cropWidgetWidth:null,cropWidgetHeight:null}}getStyle(){var e;const{aspectRatio:t,useAspectRatio:n}=this.props,a=this.props.config.functionConfig.symbolScale?this.props.config.functionConfig.symbolScale:1,r=null===(e=this.props.config.functionConfig.imageParam)||void 0===e?void 0:e.cropParam,l=null==r?void 0:r.cropPixel,c=null==r?void 0:r.cropType,p=!l||!c||c===o.CropType.Real;return s.css`
      ${p&&n&&`img {\n        aspect-ratio: ${i.utils.parseAspectRatio(t)};\n      }`}
      .widget-image-link {
        display: block;
        padding: 0;
        border: none;
        width: 100%;
        height: 100%;
        outline-offset: -2px !important;
        border-radius: unset;
      }
      .image-symbol {
        display: grid;
        place-items: center;
        svg, img {
          transform: scale(${a});
        }
      }
    `}componentDidMount(){this.__unmount=!1}componentDidUpdate(s,o){var i,n,a,r,l,c,p,u,h,d,g,m,f,v,x,y,S,b;this.props.useDataSourcesEnabled||this.props.config===s.config&&!s.useDataSourcesEnabled||this.setState({src:(null===(r=null===(a=null===(n=null===(i=this.props)||void 0===i?void 0:i.config)||void 0===n?void 0:n.functionConfig)||void 0===a?void 0:a.imageParam)||void 0===r?void 0:r.url)||"",toolTip:null===(p=null===(c=null===(l=this.props)||void 0===l?void 0:l.config)||void 0===c?void 0:c.functionConfig)||void 0===p?void 0:p.toolTip,altText:null===(d=null===(h=null===(u=this.props)||void 0===u?void 0:u.config)||void 0===h?void 0:h.functionConfig)||void 0===d?void 0:d.altText,linkUrl:null===(v=null===(f=null===(m=null===(g=this.props)||void 0===g?void 0:g.config)||void 0===m?void 0:m.functionConfig)||void 0===f?void 0:f.linkParam)||void 0===v?void 0:v.value}),!this.props.useDataSourcesEnabled||this.props.config===s.config&&s.useDataSourcesEnabled||(this.checkIsStaticSrc(this.props.config.functionConfig.imgSourceType)?this.setState({src:(null===(b=null===(S=null===(y=null===(x=this.props)||void 0===x?void 0:x.config)||void 0===y?void 0:y.functionConfig)||void 0===S?void 0:S.imageParam)||void 0===b?void 0:b.url)||"",toolTipExpression:this.getToolTipExpression(),altTextExpression:this.getAltTextExpression(),linkUrlExpression:this.getLinkUrlExpression()}):this.props.config.functionConfig.imgSourceType!==e.ByDynamicUrl||this.props.config.functionConfig.dynamicUrlType&&this.props.config.functionConfig.dynamicUrlType!==t.Expression?this.setState({src:"",toolTipExpression:this.getToolTipExpression(),altTextExpression:this.getAltTextExpression(),linkUrlExpression:this.getLinkUrlExpression()}):this.setState({record:null,srcExpression:this.getSrcExpression(),toolTipExpression:this.getToolTipExpression(),altTextExpression:this.getAltTextExpression(),linkUrlExpression:this.getLinkUrlExpression()}))}componentWillUnmount(){this.__unmount=!0;(0,s.getAppStore)().getState().appConfig.widgets[this.props.id]||delete se[this.props.id+"-"+this.props.layoutId]}render(){const i=this.props.useDataSourcesEnabled,{queryObject:n,browserSizeMode:a}=this.props,{toolTip:r,altText:l,src:u}=this.state;let d=null,g=null,m=this.props.config.functionConfig.imageParam?this.props.config.functionConfig.imageParam:(0,s.Immutable)({});m.set?m=m.set("url",u):m.url=u;const f=m&&m.cropParam,v=f&&(f.cropType===o.CropType.Fake||f.cropShape);let x=[];const y=this.props.config.functionConfig.dynamicUrlType;let S,b;y===t.Attachment?x=this.state.attachmentInfos&&this.state.attachmentInfos.length>0?this.state.attachmentInfos.map((e=>e.url)):[""]:y!==t.Symbol&&(x=[u]),g=(0,s.jsx)(s.React.Fragment,null,this.props.config.functionConfig.dynamicUrlType!==t.Attachment&&this.props.config.functionConfig.dynamicUrlType!==t.Symbol&&(0,s.jsx)(o.ImageWithParam,{imageParam:m,toolTip:r,altText:l,useFadein:!0,size:v?{width:this.state.widgetWidth,height:this.state.widgetHeight}:null,imageFillMode:this.props.config.functionConfig.imageFillMode,isAutoHeight:this.props.autoHeight,isAutoWidth:this.props.autoWidth,imageDisplayQualityMode:this.props.config.functionConfig.imageDisplayQualityMode}),this.props.config.functionConfig.dynamicUrlType===t.Attachment&&(0,s.jsx)("div",{className:"w-100 h-100"},i&&(0,s.jsx)(I,{sources:this.state.attachmentInfos,imageParam:m,imageFillMode:this.props.config.functionConfig.imageFillMode,size:v?{width:this.state.widgetWidth,height:this.state.widgetHeight}:null,isAutoHeight:this.props.autoHeight,isAutoWidth:this.props.autoWidth,toolTip:r,altText:l,altTextWithAttachmentName:this.props.config.functionConfig.altTextWithAttachmentName,toolTipWithAttachmentName:this.props.config.functionConfig.toolTipWithAttachmentName,useFadein:!0,intl:this.props.intl,browserSizeMode:a}),!i&&(0,s.jsx)(o.ImageWithParam,{imageParam:m,toolTip:r,altText:l,useFadein:!0,size:v?{width:this.state.widgetWidth,height:this.state.widgetHeight}:null,imageFillMode:this.props.config.functionConfig.imageFillMode,isAutoHeight:this.props.autoHeight,isAutoWidth:this.props.autoWidth,imageDisplayQualityMode:this.props.config.functionConfig.imageDisplayQualityMode})),this.props.config.functionConfig.dynamicUrlType===t.Symbol&&(0,s.jsx)("div",{className:"w-100 h-100"},(!this.state.symbolElement||!i)&&(0,s.jsx)(o.ImageWithParam,{imageParam:m,toolTip:r,altText:l,useFadein:!0,size:v?{width:this.state.widgetWidth,height:this.state.widgetHeight}:null,imageFillMode:this.props.config.functionConfig.imageFillMode,isAutoHeight:this.props.autoHeight,isAutoWidth:this.props.autoWidth,imageDisplayQualityMode:this.props.config.functionConfig.imageDisplayQualityMode}),this.state.symbolElement&&i&&(0,s.jsx)("div",{className:"w-100 h-100 image-symbol",title:r,dangerouslySetInnerHTML:{__html:this.state.symbolElement.outerHTML}})),v&&(0,s.jsx)(s.ReactResizeDetector,{targetRef:this.widgetConRef,handleWidth:!0,handleHeight:!0,onResize:this.debounceOnResize}));const C=this.props.config.functionConfig.linkParam;if(C&&C.linkType&&(S=C.openType,b={linkType:C.linkType},C.linkType===s.LinkType.WebAddress?b.value=this.state.linkUrl:b.value=C.value),d=b&&(null==b?void 0:b.linkType)!==s.LinkType.None?(0,s.jsx)(o.Link,{to:b,target:S,queryObject:n,className:"widget-image-link",unstyled:!0},g):g,this.props.config.functionConfig.imageFillMode!==o.ImageFillMode.Fit&&this.props.isInlineEditing&&u&&(!this.props.repeatedDataSource||this.props.repeatedDataSource&&0===this.props.repeatedDataSource.recordIndex)){const e=this.props.builderSupportModules.widgetModules.WidgetInBuilder;d=(0,s.jsx)("div",{className:"widget-image w-100 h-100",ref:this.widgetConRef,css:this.getStyle()},(0,s.jsx)(s.ReactResizeDetector,{targetRef:this.widgetConRef,handleWidth:!0,handleHeight:!0,onResize:this.onCropWidgetResize}),d,this.state.cropWidgetHeight&&this.state.cropWidgetWidth&&(0,s.jsx)(e,{widgetId:this.props.id,config:this.props.config,onUnmount:()=>{this.clearCropWidgetSize()},widgetWidth:this.state.cropWidgetWidth,widgetHeight:this.state.cropWidgetHeight}))}else d=(0,s.jsx)("div",{className:"widget-image w-100 h-100",ref:this.widgetConRef,css:this.getStyle(),onClick:e=>{this.onClick(e)},onTouchEnd:e=>{this.onClick(e)}},d,(0,s.jsx)("div",{style:{display:"none"}},i&&this.props.config.functionConfig.imgSourceType===e.ByDynamicUrl&&(!this.props.config.functionConfig.dynamicUrlType||this.props.config.functionConfig.dynamicUrlType===t.Expression)&&(0,s.jsx)("div",null,(0,s.jsx)(s.ExpressionResolverComponent,{useDataSources:this.props.useDataSources,expression:this.getSrcExpression(),onChange:this.onSrcExpResolveChange,widgetId:this.props.id})),i&&(0,s.jsx)("div",null,(0,s.jsx)(s.ExpressionResolverComponent,{useDataSources:this.props.useDataSources,expression:this.getAltTextExpression(),onChange:this.onAltTextExpResolveChange,widgetId:this.props.id}),(0,s.jsx)(s.ExpressionResolverComponent,{useDataSources:this.props.useDataSources,expression:this.getToolTipExpression(),onChange:this.onToolTipExpResolveChange,widgetId:this.props.id}),(0,s.jsx)(s.ExpressionResolverComponent,{useDataSources:this.props.useDataSources,expression:this.state.linkUrlExpression,onChange:this.onLinkUrlExpResolveChange,widgetId:this.props.id})),i&&this.props.config.functionConfig.dynamicUrlType===t.Attachment&&(0,s.jsx)("div",null,(0,s.jsx)(c,{record:this.state.record,unmountAttachmentInfosChange:this.unmountAttachmentInfosChange,onChange:this.onAttachmentInfosChange})),i&&this.props.config.functionConfig.dynamicUrlType===t.Symbol&&(0,s.jsx)("div",null,(0,s.jsx)(p,{record:this.state.record,unmountSymbolElementChange:this.unmountSymbolElementChange,onChange:this.onSymbolElementChange})),i&&(this.props.config.functionConfig.dynamicUrlType===t.Attachment||this.props.config.functionConfig.dynamicUrlType===t.Symbol)&&(0,s.jsx)("div",null,(0,s.jsx)(h,{widgetId:this.props.id,useDataSource:this.props.config.functionConfig.useDataSourceForMainDataAndViewSelector,isSelectedFromRepeatedDataSourceContext:this.props.config.functionConfig.isSelectedFromRepeatedDataSourceContext,onRecordChange:this.handleRecordChange}))),this.props.config.functionConfig.imageViewer&&x.length>0&&(0,s.jsx)(te,{srcList:x}));return d}}oe.mapExtraStateProps=(e,t)=>{var s,o;const i=e.appConfig,{layouts:n}=i,{layoutId:a,layoutItemId:r}=t,l=n[a],c=(null===(o=null===(s=null==l?void 0:l.content)||void 0===s?void 0:s[r])||void 0===o?void 0:o.setting)||{};return{useAspectRatio:"ratio"===c.heightMode&&null!=c.aspectRatio,aspectRatio:c.aspectRatio,queryObject:e.queryObject,browserSizeMode:e.browserSizeMode}};const ie=oe;function ne(e){a.p=e}})(),r})())}}}));