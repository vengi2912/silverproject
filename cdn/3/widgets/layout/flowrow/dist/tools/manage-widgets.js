System.register(["jimu-core","jimu-ui","jimu-ui/advanced/setting-components","jimu-theme","jimu-layouts/layout-builder","jimu-for-builder"],(function(e,t){var o={},i={},n={},r={},a={},s={};return{setters:[function(e){o.BrowserSizeMode=e.BrowserSizeMode,o.LayoutItemType=e.LayoutItemType,o.ReactRedux=e.ReactRedux,o.appActions=e.appActions,o.css=e.css,o.getAppStore=e.getAppStore,o.i18n=e.i18n,o.jsx=e.jsx,o.lodash=e.lodash},function(e){i.defaultMessages=e.defaultMessages},function(e){n.SortTree=e.SortTree},function(e){r.useTheme=e.useTheme},function(){},function(e){s.appBuilderSync=e.appBuilderSync,s.builderAppSync=e.builderAppSync,s.getAppConfigAction=e.getAppConfigAction}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=r},4108:e=>{"use strict";e.exports=s},6055:e=>{"use strict";e.exports=a},14321:e=>{"use strict";e.exports=i},73549:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M6.667 4.667 11.333 0 16 4.667l-4.667 4.666zM0 1.333V8h6.667V1.333zM6.667 16H0V9.333h6.667zM8 16V9.333h6.667V16z" clip-rule="evenodd"></path></svg>'},79244:e=>{"use strict";e.exports=o},79298:e=>{"use strict";e.exports=n},91455:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" fill-rule="evenodd" d="M20 2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2zM2 1h16a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1" clip-rule="evenodd"></path><path fill="#000" fill-rule="evenodd" d="M9 4a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1zM4 8V4h4v4zM17 4a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1zm-5 4V4h4v4zM9 12a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1zm-5 4v-4h4v4zM17 14a3 3 0 1 0-6 0 3 3 0 0 0 6 0m-5 0a2 2 0 1 1 4 0 2 2 0 0 1-4 0" clip-rule="evenodd"></path></svg>'}},t={};function l(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,l),n.exports}l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var o in t)l.o(t,o)&&!l.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="";var d={};return l.p=window.jimuConfig.baseUrl,(()=>{"use strict";l.r(d),l.d(d,{default:()=>S});var e=l(79244),t=l(14321),o=l(91455),i=l.n(o),n=l(73549),r=l.n(n),a=l(79298),s=l(1888),p=(l(6055),l(4108));const u=(t,o)=>{window.jimuConfig.isBuilder?p.builderAppSync.publishWidgetToolbarStateChangeToApp(t,o):(0,e.getAppStore)().dispatch(e.appActions.widgetToolbarStateChange(t,o))},g=t=>e.css`
width: 300px;
height: 400px;
overflow-y: auto;
padding: ${t.sys.spacing[4]};
.jimu-tree-item__main-line {
  height: 32px;
  background-color: ${t.ref.palette.neutral[500]};
  &:hover {
    background-color: ${t.ref.palette.neutral[600]};
  }
  color: ${t.ref.palette.neutral[1100]};
}
.jimu-tree-item__body {
  border: none !important;
}
`,c=e=>{const{dropType:t}=e;return"to-inside"!==t},m=t=>{const{widgetId:o}=t,i=e.ReactRedux.useSelector((e=>{const t=e.appStateInBuilder?e.appStateInBuilder:e;return t.appConfig.widgets[o].layouts.DEFAULT[t.browserSizeMode]})),n=e.ReactRedux.useSelector((t=>{const n=t.appStateInBuilder?t.appStateInBuilder:t,r=n.appConfig.layouts[i],a=[...r.order].map((t=>{const o=r.content[t];let a="";return"WIDGET"===o.type?a=n.appConfig.widgets[o.widgetId].label:o.type===e.LayoutItemType.Section&&(a=n.appConfig.sections[o.sectionId].label),{itemKey:`${i},${t}`,itemStateTitle:a}}));return{itemKey:o,itemChildren:a}}),e.ReactRedux.shallowEqual),r=(0,s.useTheme)();return(0,e.jsx)("div",{css:g(r)},(0,e.jsx)(a.SortTree,{rootItemJson:n,isItemDroppable:c,onSort:e=>{const{targetDropItemIndex:t,dragItemJsons:o}=e,i=(0,p.getAppConfigAction)(),[n,r]=o[0].itemKey.split(",");i.adjustOrderOfItem({layoutId:n,layoutItemId:r},t).exec()},onRemove:t=>{const[i,n]=t.itemKey.split(",");((t,o)=>{var i,n,r;const a=(0,p.getAppConfigAction)();a.removeLayoutItem(t,!0,!0),a.exec();const s=(0,e.getAppStore)().getState(),{layoutId:l,layoutItemId:d}=t,u=s.appRuntimeInfo.selection;if(!u||(null==u?void 0:u.layoutId)===l&&(null==u?void 0:u.layoutItemId)===d){const t=null===(r=null===(n=null===(i=s.appConfig.widgets[o])||void 0===i?void 0:i.parent)||void 0===n?void 0:n[s.browserSizeMode])||void 0===r?void 0:r[0];(0,e.getAppStore)().dispatch(e.appActions.selectionChanged(t))}})({layoutId:i,layoutItemId:n},o),e.lodash.defer((()=>{u(o,["flowrow-manage-widgets"])}))}}))};class S{constructor(){this.index=3,this.id="flowrow-manage-widgets",this.name="flowrow-manage-widgets"}getAppState(){const t=(0,e.getAppStore)().getState();return t.appStateInBuilder?t.appStateInBuilder:t}getGroupId(){return"flowrow-tools"}getTitle(){const o=e.i18n.getIntl("_jimu");return o?o.formatMessage({id:"manageWidgets",defaultMessage:t.defaultMessages.manageWidgets}):"Manage widgets"}getIcon(){return window.jimuConfig.isBuilder?r():i()}visible(){return!0}disabled(e){var t,o,i,n,r;const a=this.getAppState(),{appConfig:s,browserSizeMode:l}=a,d=e.layoutItem.widgetId,p=s.widgets[d],u=Object.keys(p.layouts)[0],g=(null===(t=p.layouts[u])||void 0===t?void 0:t[l])||(null===(o=p.layouts[u])||void 0===o?void 0:o[s.mainSizeMode]);return 0===(null!==(r=null===(n=null===(i=s.layouts[g])||void 0===i?void 0:i.order)||void 0===n?void 0:n.length)&&void 0!==r?r:0)}checked(){if(this.getAppState().browserSizeMode===e.BrowserSizeMode.Small)return this.isOpenInSidePanel}onClick(t){const o=t.layoutItem.widgetId;if(this.getAppState().browserSizeMode===e.BrowserSizeMode.Small){this.isOpenInSidePanel=!this.isOpenInSidePanel;const e=()=>{this.isOpenInSidePanel=!1,u(o,["flowrow-manage-widgets"])};p.appBuilderSync.publishSidePanelToApp({type:"manageWidgets",uri:"widgets/layout/flowrow/",widgetId:o,keepPanel:!0,active:this.isOpenInSidePanel,onClose:e})}}getSettingPanel(t){return this.getAppState().browserSizeMode===e.BrowserSizeMode.Small?null:m}}})(),d})())}}}));