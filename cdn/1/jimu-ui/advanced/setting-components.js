System.register(["jimu-arcgis","jimu-core","jimu-core/react","jimu-for-builder","jimu-for-builder/templates","jimu-layouts/layout-runtime","jimu-theme","jimu-ui","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/expression-builder","jimu-ui/advanced/resource-selector","jimu-ui/advanced/setting-components","jimu-ui/advanced/utility-selector","jimu-ui/basic/list-tree"],(function(e,t){var i={},o={},a={},s={},n={},r={},l={},c={},d={},p={},u={},m={},g={},h={};return{setters:[function(e){i.MapViewManager=e.MapViewManager},function(e){o.AllDataSourceTypes=e.AllDataSourceTypes,o.CONSTANTS=e.CONSTANTS,o.ContainerType=e.ContainerType,o.DataSourceComponent=e.DataSourceComponent,o.DataSourceManager=e.DataSourceManager,o.DataSourceStatus=e.DataSourceStatus,o.DataSourceTypes=e.DataSourceTypes,o.DialogMode=e.DialogMode,o.EsriFieldType=e.EsriFieldType,o.ExpressionPartType=e.ExpressionPartType,o.Immutable=e.Immutable,o.JimuFieldType=e.JimuFieldType,o.LayoutItemType=e.LayoutItemType,o.LayoutParentType=e.LayoutParentType,o.LayoutType=e.LayoutType,o.LinkType=e.LinkType,o.MultipleDataSourceComponent=e.MultipleDataSourceComponent,o.OpenTypes=e.OpenTypes,o.OrderRule=e.OrderRule,o.PagePart=e.PagePart,o.PageType=e.PageType,o.React=e.React,o.ReactRedux=e.ReactRedux,o.ReactResizeDetector=e.ReactResizeDetector,o.ServiceManager=e.ServiceManager,o.SessionManager=e.SessionManager,o.SupportedUtilityType=e.SupportedUtilityType,o.UtilityManager=e.UtilityManager,o.appConfigUtils=e.appConfigUtils,o.cancelablePromise=e.cancelablePromise,o.classNames=e.classNames,o.css=e.css,o.dataSourceUtils=e.dataSourceUtils,o.defaultMessages=e.defaultMessages,o.esri=e.esri,o.focusElementInKeyboardMode=e.focusElementInKeyboardMode,o.getAppStore=e.getAppStore,o.hooks=e.hooks,o.i18n=e.i18n,o.injectIntl=e.injectIntl,o.jsx=e.jsx,o.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules,o.lodash=e.lodash,o.moduleLoader=e.moduleLoader,o.polished=e.polished,o.proxyUtils=e.proxyUtils,o.urlUtils=e.urlUtils,o.useIntl=e.useIntl},function(e){a.cloneElement=e.cloneElement,a.createElement=e.createElement,a.default=e.default,a.isValidElement=e.isValidElement,a.useCallback=e.useCallback,a.useEffect=e.useEffect,a.useReducer=e.useReducer,a.useRef=e.useRef,a.useState=e.useState},function(e){s.builderAppSync=e.builderAppSync,s.getAppConfigAction=e.getAppConfigAction,s.messageActionUtils=e.messageActionUtils},function(e){n.TemplateType=e.TemplateType,n.getAnchoredWindowTemplates=e.getAnchoredWindowTemplates,n.getFixedModalWindowTemplates=e.getFixedModalWindowTemplates,n.getFixedNonModalWindowTemplates=e.getFixedNonModalWindowTemplates,n.getFullScreenGridPageTemplates=e.getFullScreenGridPageTemplates,n.getFullScreenPageTemplates=e.getFullScreenPageTemplates,n.getScrollingPageTemplates=e.getScrollingPageTemplates,n.getTemplateCapabilitiesOnlyInCurrentLocale=e.getTemplateCapabilitiesOnlyInCurrentLocale,n.getTemplatesByCapabilityTags=e.getTemplatesByCapabilityTags,n.getWindowTemplates=e.getWindowTemplates},function(e){r.searchUtils=e.searchUtils,r.utils=e.utils},function(e){l.Theme2GlobalStyleClassName=e.Theme2GlobalStyleClassName,l.ThemeGlobalStyleClassName=e.ThemeGlobalStyleClassName,l.ThemeSwitchComponent=e.ThemeSwitchComponent,l.UseTheme2Context=e.UseTheme2Context,l.getBoxStyles=e.getBoxStyles,l.getBuilderThemeVariables=e.getBuilderThemeVariables,l.getTheme=e.getTheme,l.getTheme2=e.getTheme2,l.popperPointer=e.popperPointer,l.registerStyles=e.registerStyles,l.styled=e.styled,l.useTheme=e.useTheme,l.utils=e.utils,l.withStyles=e.withStyles,l.withTheme=e.withTheme},function(e){c.AdvancedButtonGroup=e.AdvancedButtonGroup,c.AdvancedSelect=e.AdvancedSelect,c.Alert=e.Alert,c.Badge=e.Badge,c.Button=e.Button,c.Checkbox=e.Checkbox,c.CollapsableCheckbox=e.CollapsableCheckbox,c.CollapsablePanel=e.CollapsablePanel,c.CollapsableRadio=e.CollapsableRadio,c.CollapsableToggle=e.CollapsableToggle,c.Collapse=e.Collapse,c.ConfirmDialog=e.ConfirmDialog,c.Container=e.Container,c.Dropdown=e.Dropdown,c.DropdownButton=e.DropdownButton,c.DropdownItem=e.DropdownItem,c.DropdownMenu=e.DropdownMenu,c.FOCUSABLE_CONTAINER_CLASS=e.FOCUSABLE_CONTAINER_CLASS,c.FloatingPanel=e.FloatingPanel,c.FormGroup=e.FormGroup,c.Icon=e.Icon,c.Input=e.Input,c.Label=e.Label,c.Link=e.Link,c.Loading=e.Loading,c.LoadingType=e.LoadingType,c.Message=e.Message,c.Modal=e.Modal,c.ModalBody=e.ModalBody,c.ModalFooter=e.ModalFooter,c.ModalHeader=e.ModalHeader,c.NumericInput=e.NumericInput,c.Option=e.Option,c.PanelHeader=e.PanelHeader,c.Popper=e.Popper,c.Radio=e.Radio,c.Row=e.Row,c.Select=e.Select,c.Switch=e.Switch,c.Tab=e.Tab,c.Tabs=e.Tabs,c.TextInput=e.TextInput,c.Tooltip=e.Tooltip,c.UrlInput=e.UrlInput,c.defaultMessages=e.defaultMessages,c.isOutBoundary=e.isOutBoundary},function(e){d.DataSourceSelector=e.DataSourceSelector,d.FieldSelector=e.FieldSelector,d.FieldSelectorWithFullTextIndex=e.FieldSelectorWithFullTextIndex,d.dataComponentsUtils=e.dataComponentsUtils},function(e){p.ExpressionInput=e.ExpressionInput,p.ExpressionInputType=e.ExpressionInputType},function(e){u.IconPicker=e.IconPicker},function(e){m.JimuLayerViewSelector=e.JimuLayerViewSelector,m.SettingRow=e.SettingRow,m.SettingSection=e.SettingSection,m.SidePopper=e.SidePopper,m.getAllItemsInMapView=e.getAllItemsInMapView},function(e){g.UtilitySelector=e.UtilitySelector,g.addNewUtility=e.addNewUtility,g.extractService=e.extractService},function(e){h.List=e.List,h.Tree=e.Tree,h.TreeAlignmentType=e.TreeAlignmentType,h.TreeCollapseStyle=e.TreeCollapseStyle,h.TreeItemActionType=e.TreeItemActionType,h.TreeStyle=e.TreeStyle}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=l},2918:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 32 32"><path fill="#000" d="M2.15 24 19.3 13.974h8.896c.274 0 .52.207.52.489 0 .23-.108.334-.245.411l-8.426 4.744c-.549.31-.739.927-.739 1.388l-.009 2.99H30V6.618a.6.6 0 0 0-.052-.242.6.6 0 0 0-.149-.204.69.69 0 0 0-.482-.17h-10.21L2 15.979v8.019h.15z"></path></svg>'},4108:e=>{"use strict";e.exports=s},12046:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M11.227 1.312c-.404-.404-1.045-.417-1.432-.03L2.49 8.587l-.48 2.674a.637.637 0 0 0 .73.73l2.673-.48 7.305-7.306c.387-.387.374-1.028-.03-1.431zm-8.114 9.575.32-1.781 4.991-4.992 1.462 1.462-4.992 4.991zm7.473-6.012 1.402-1.4-1.462-1.463-1.401 1.402z" clip-rule="evenodd"></path><path fill="#000" d="M1.5 14a.5.5 0 0 0 0 1h13a.5.5 0 0 0 0-1z"></path></svg>'},13089:e=>{"use strict";e.exports=d},13424:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 17"><path stroke="#000" d="M1 3.5h5M1 9.5h14M1 14.5h14M14 3.5H9l2.5 3z"></path></svg>'},14321:e=>{"use strict";e.exports=c},14962:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M1.5 3a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1zM1 6.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5M1.5 9a.5.5 0 0 0 0 1h10a.5.5 0 0 0 0-1zM1.5 12a.5.5 0 0 0 0 1h13a.5.5 0 0 0 0-1z"></path></svg>'},16435:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M3.646 10.354a.5.5 0 0 0 .708-.708L2.707 8h10.586l-1.647 1.646a.5.5 0 0 0 .708.708l2.5-2.5a.5.5 0 0 0 0-.708l-2.5-2.5a.5.5 0 0 0-.708.708L13.293 7H2.707l1.647-1.646a.5.5 0 1 0-.708-.708l-2.5 2.5a.5.5 0 0 0 0 .708z"></path></svg>'},16884:e=>{"use strict";e.exports=n},18249:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M1 2h14v12H1zm13 1H2v4h12zm0 5h-3v2h3zm0 3h-3v2h3zm-4 2v-2H6v2zm-5 0v-2H2v2zm-3-3h3V8H2zm8-2v2H6V8z" clip-rule="evenodd"></path></svg>'},23662:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M7.5 0a.5.5 0 0 0-.5.5V7H.5a.5.5 0 0 0 0 1H7v6.5a.5.5 0 0 0 1 0V8h6.5a.5.5 0 0 0 0-1H8V.5a.5.5 0 0 0-.5-.5"></path></svg>'},28996:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 2.125 14.334 14H1.667zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47zM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},29435:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M14.938 8A7 7 0 0 1 1.01 9H0a8.001 8.001 0 0 0 15.938-1A8 8 0 0 0 1.02 3.98L1 .702a.5.5 0 1 0-1 .006L.031 5.9l5.128-.826a.5.5 0 0 0-.16-.987L1.819 4.6A7 7 0 0 1 14.938 8"></path></svg>'},30655:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .54.54 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.54.54 0 0 1 0-.738" clip-rule="evenodd"></path></svg>'},32881:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M7 14a1 1 0 1 0 2 0 1 1 0 0 0-2 0m1-5a1 1 0 1 1 0-2 1 1 0 0 1 0 2m0-6a1 1 0 1 1 0-2 1 1 0 0 1 0 2" clip-rule="evenodd"></path></svg>'},35809:e=>{"use strict";e.exports=u},41496:e=>{"use strict";e.exports=r},48799:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#181818" d="M1.998 8.5V16h1V8.5h1v-1h-1V0h-1v7.5h-1v1zM7.998 0v3.5h-1v1h1V16h1V4.5h1v-1h-1V0zM13.998 11.5V0h1v11.5h1v1h-1V16h-1v-3.5h-1v-1z"></path></svg>'},50170:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0m-1.27 4.936a6.5 6.5 0 1 1 .707-.707l4.136 4.137a.5.5 0 1 1-.707.707z" clip-rule="evenodd"></path></svg>'},53195:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M0 3.307V15l5.722-2.117 4.528 1.937L16 12.693V1l-5.722 2.117L5.75 1.18zm1 10.286V3.974l4-1.48v9.619zm5-1.65 4 1.711V4.057L6 2.346zm5 1.563V3.887l4-1.48v9.619z" clip-rule="evenodd"></path></svg>'},54578:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M1.5 13a.5.5 0 0 1 0-1h4a.5.5 0 0 1 0 1zM1 9.5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 0-1h-7a.5.5 0 0 0-.5.5M1.5 7a.5.5 0 0 1 0-1h10a.5.5 0 0 1 0 1zM1.5 4a.5.5 0 0 1 0-1h13a.5.5 0 0 1 0 1z"></path></svg>'},56499:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m6.036 12.157 8.01-8.01a.5.5 0 1 1 .707.707l-8.01 8.01a1 1 0 0 1-1.415 0L1.146 8.682a.5.5 0 1 1 .708-.707z"></path></svg>'},57993:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M10.354 12.354a.5.5 0 0 0-.708-.708L8 13.293V2.707l1.646 1.647a.5.5 0 0 0 .708-.708l-2.5-2.5a.5.5 0 0 0-.708 0l-2.5 2.5a.5.5 0 1 0 .708.708L7 2.707v10.586l-1.646-1.647a.5.5 0 0 0-.708.708l2.5 2.5a.5.5 0 0 0 .708 0z"></path></svg>'},62686:e=>{"use strict";e.exports=i},62838:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746z"></path></svg>'},68972:e=>{"use strict";e.exports=a},71245:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 32 32"><path fill="#000" fill-rule="evenodd" d="M2.596 6.357c.39-.59.944-1.055 1.595-1.337L15.544.094a1.14 1.14 0 0 1 .91 0L30 5.97V23.66a3.6 3.6 0 0 1-.596 1.983 3.65 3.65 0 0 1-1.595 1.337l-11.353 4.927a1.14 1.14 0 0 1-.91 0L2 26.029V8.34a3.6 3.6 0 0 1 .596-1.984m3.419 15.162q.014.024.037.038l9.594 5.351a.72.72 0 0 0 .705 0l9.144-5.103a1 1 0 0 0 .37-.356.95.95 0 0 0 .135-.488v-9.89a.85.85 0 0 0-.122-.438.9.9 0 0 0-.331-.32l-9.497-5.3a.1.1 0 0 0-.104 0l-2.415 1.348a.1.1 0 0 0-.026.025.066.066 0 0 0 .026.092l8.947 4.992c.39.218.716.532.941.91.226.378.345.807.345 1.243v5.514q0 .121-.062.226a.46.46 0 0 1-.172.165l-5.633 3.145a3.9 3.9 0 0 1-1.899.49c-.666 0-1.32-.169-1.898-.49L8.972 19.81a1.46 1.46 0 0 1-.542-.524 1.4 1.4 0 0 1-.198-.715V11.76a.07.07 0 0 1 .07-.068q.018 0 .035.009l7.651 4.268q.076.043.121.117a.3.3 0 0 1 .045.16v2.526q0 .019.009.034a.07.07 0 0 0 .06.033.1.1 0 0 0 .035-.009l1.972-1.1c.28-.156.511-.38.673-.651.161-.27.247-.577.247-.89v-.964c0-.278-.076-.55-.22-.79-.144-.241-.35-.44-.598-.58L9.65 9.011a.89.89 0 0 0-.86 0L6.052 10.54a.104.104 0 0 0-.052.088v10.842q0 .027.015.05" clip-rule="evenodd"></path></svg>'},71371:e=>{"use strict";e.exports=g},72529:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8.027 0A8 8 0 1 1 0 8a8 8 0 0 1 8.027-8m-2.07 1.303A7 7 0 0 0 2.256 4h1.6a8.3 8.3 0 0 1 2.103-2.697M3.453 5H1.674a7 7 0 0 0-.656 2.5H3.01q.06-1.336.441-2.5m.56 2.5a8.1 8.1 0 0 1 .5-2.5H7.5v2.5zm-1.001 1H1.018c.062.89.291 1.733.656 2.5h1.778a9.3 9.3 0 0 1-.441-2.5M4.512 11a8.1 8.1 0 0 1-.5-2.5H7.5V11zm-.657 1h-1.6a7 7 0 0 0 3.702 2.697A8.3 8.3 0 0 1 3.855 12M7.5 14.61V12H4.985q.869 1.516 2.515 2.61M7.5 4V1.39Q5.854 2.484 4.985 4zm2.543 10.697A7 7 0 0 0 13.745 12h-1.6a8.3 8.3 0 0 1-2.102 2.697M12.548 11h1.778c.365-.767.594-1.61.656-2.5H12.99a9.3 9.3 0 0 1-.441 2.5m-.56-2.5a8.1 8.1 0 0 1-.5 2.5H8.5V8.5zm1.001-1h1.993a7 7 0 0 0-.656-2.5h-1.778q.381 1.164.441 2.5M11.488 5q.434 1.146.5 2.5H8.5V5zm.657-1h1.6a7 7 0 0 0-3.703-2.697Q11.408 2.473 12.145 4M8.5 1.39Q10.146 2.484 11.015 4H8.5zM8.5 12h2.515q-.869 1.516-2.515 2.61z" clip-rule="evenodd"></path></svg>'},76490:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m1.373 8 2.07-2.071.83.828L2.2 8.828a3.515 3.515 0 0 0 4.97 4.971l2.072-2.071.828.828L8 14.627A4.686 4.686 0 1 1 1.373 8M13.799 7.172l-2.071 2.07.828.83L14.627 8A4.686 4.686 0 1 0 8 1.373l-2.071 2.07.828.83L8.828 2.2a3.515 3.515 0 0 1 4.971 4.97"></path><path fill="#000" d="M5.515 9.657a.586.586 0 0 0 .828.828l4.142-4.142a.586.586 0 0 0-.828-.828z"></path></svg>'},79244:e=>{"use strict";e.exports=o},79298:e=>{"use strict";e.exports=m},84845:e=>{"use strict";e.exports=p},94064:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M13.854 11.347a.486.486 0 0 1-.708 0L8 5.76l-5.146 5.587a.485.485 0 0 1-.708 0 .54.54 0 0 1 0-.738l5.5-5.956a.485.485 0 0 1 .708 0l5.5 5.956a.54.54 0 0 1 0 .738" clip-rule="evenodd"></path></svg>'},96745:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0m1 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-7.676 2.228H7.34c-.213-1.138.621-2.13 1.375-3.025C9.28 6.532 9.8 5.914 9.8 5.328 9.8 4.5 9.2 3.9 7.976 3.9c-.816 0-1.572.36-2.268 1.092l-.648-.6C5.852 3.552 6.788 3 8.096 3c1.692 0 2.772.864 2.772 2.244 0 .864-.652 1.628-1.3 2.387-.71.831-1.413 1.655-1.244 2.597m.3 2.172c0 .48-.348.792-.768.792-.432 0-.78-.312-.78-.792s.348-.804.78-.804c.42 0 .768.324.768.804" clip-rule="evenodd"></path></svg>'},98640:e=>{"use strict";e.exports=h}},t={};function v(i){var o=t[i];if(void 0!==o)return o.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,v),a.exports}v.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return v.d(t,{a:t}),t},v.d=(e,t)=>{for(var i in t)v.o(t,i)&&!v.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},v.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),v.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var f={};return(()=>{"use strict";v.r(f),v.d(f,{ByFieldSeriesX:()=>Do,ByFieldSeriesY:()=>Ao,CardLayout:()=>Zs,CardLayoutSetting:()=>cn,CollapsableCheckbox:()=>he,CollapsableRadio:()=>ge,CollapsableResetPanel:()=>Si,CollapsableToggle:()=>me,DEFAULT_GEOCODE_KEY:()=>Ro,DEFAULT_MAX_SUGGESTION:()=>Oo,DefaultAddress:()=>Vo,DefaultAddressAlias:()=>Wo,DefaultGeocodeLabel:()=>Ho,DefaultGeocodeURL:()=>Go,DirectionSelector:()=>vo,JimuLayerViewSelector:()=>ee,JimuLayerViewSelectorComponent:()=>Z,JimuLayerViewSelectorDeprecated:()=>U,JimuLayerViewSelectorDropdown:()=>ie,JimuLayerViewSelectorDropdownComponent:()=>te,JimuMapViewSelector:()=>se,JimuMapViewSelectorComponent:()=>ae,LabelReset:()=>bi,LayerSetting:()=>pn,LinkSelector:()=>nt,LinkSelectorContent:()=>He,LinkSelectorSidePopper:()=>Qe,LinkSetting:()=>_e,LinkSettingPopup:()=>Ze,MAX_RECENT_SEARCHES:()=>Po,MAX_SUGGESTION:()=>To,MIN_SCALE:()=>Mo,MapWidgetSelector:()=>D,MapWidgetSelectorComponent:()=>L,MaxCategories:()=>Eo,MaxPieces:()=>Fo,MaxSeries:()=>Bo,MessageActionDataSelector:()=>gn,MultipleJimuMapConfig:()=>Qs,ObjectIdSchema:()=>ra,OutStatisticFieldNameSplit:()=>Uo,OutputDsAddress:()=>$o,OutputDsObjectField:()=>zo,PageTemplatePopper:()=>Mi,ProxySetting:()=>Pt,ProxySettingPopup:()=>At,QuickStylePopper:()=>jo,RadioGroup:()=>de,SearchDataSetting:()=>rs,SearchDataType:()=>No,SearchGeneralSetting:()=>ds,SearchServiceType:()=>Lo,SearchSuggestionSetting:()=>cs,SettingCollapse:()=>pe,SettingLayout:()=>t,SettingRow:()=>k,SettingSection:()=>C,SidePopper:()=>Xe,SizeMode:()=>fo,SizeModeSelector:()=>So,SortSetting:()=>so,SortTree:()=>li,SortTreePopper:()=>pi,Status:()=>en,StylePicker:()=>re,TemplateList:()=>Ii,TemplateSelector:()=>Fi,UnControlledSettingCollapse:()=>ue,WidgetList:()=>ei,WidgetListPopper:()=>si,WindowTemplatePopper:()=>Di,_LinkSelector:()=>st,_LinkSelectorContent:()=>Ge,_LinkSelectorSidePopper:()=>Ye,_SidePopper:()=>qe,changeCurrentDialog:()=>yn,changeCurrentPage:()=>fn,checkIsTableDs:()=>Ra,checkIsUseDsChanged:()=>ha,checkIsWidgetJsonDsChanged:()=>va,getAddressFieldsSchemaAndDefaultFieldName:()=>da,getAllDataSourceBySearchDataConfig:()=>Oa,getAllDsByDataConfigWithMapCentric:()=>ja,getAllItemsInMapView:()=>un,getConfigIdList:()=>fa,getDefaultField:()=>Ia,getDefaultGeocodeConfig:()=>sa,getDsInWidgetJson:()=>Ta,getDsJsonOfOriginDs:()=>ka,getInitOutDataSource:()=>pa,getInitSchema:()=>la,getNameOfDefaultAddressField:()=>ca,getNewConfigId:()=>ya,getNewDataSourceConfig:()=>Ca,getNewDsConfigItem:()=>wa,getOutputDataSourceId:()=>ba,getOutputDsJson:()=>Pa,getOutputJsonOriginDs:()=>ua,getWhetherDsInUseDataSources:()=>ma,handelDialogInfos:()=>hn,initNewDatasourceConfigByField:()=>xa,isDsInDataSources:()=>ga,proxySettingUtils:()=>i,setLayoutAuto:()=>an,setLayoutCustom:()=>sn});var e={};v.r(e),v.d(e,{JimuLayerViewSelector:()=>S,JimuLayerViewSelectorDeprecated:()=>m,JimuLayerViewSelectorDropdown:()=>y,LinkSelectorContent:()=>l,ProxySetting:()=>c,ProxySettingPopup:()=>d,RadioGroup:()=>p,SettingCollapse:()=>r,SidePopper:()=>u,SortSetting:()=>s,StylePicker:()=>n,WidgetSelector:()=>a});var t={};v.r(t),v.d(t,{SettingRow:()=>k,SettingSection:()=>C});var i={};v.r(i),v.d(i,{deleteProxies:()=>ft,getCreateProxyUrl:()=>bt,getDeleteProxyUrl:()=>wt,getNeedProxyDataSources:()=>dt,getNeedProxyItems:()=>ct,getNeedProxyUtilities:()=>pt,getProxyJsonFromSourceUrl:()=>mt,getProxyRootUrl:()=>St,isRegisteredApp:()=>ht,isSameProxy:()=>gt,needToConfigProxy:()=>vt,traverseToGetNeedProxyDataSources:()=>ut});var o=v(79244);const a=e=>{const t=e.theme;return o.css`
    .component-choose-widget-popup{
      .widget-card-active-btn{
        outline: none;
      }
    }
    div.component-choose-widget-popup-modal{
      width: 850px;
      max-width: 850px;
      height: 600px;
      background: ${t.ref.palette.white};
      border-radius: 4px;
      position: absolute;
      margin: auto;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      .component-choose-widget-clear-border{
        border: 0;
        padding: 0;
      }
      .modal-content{
        border: 0;
        padding: 20px 10px 20px 40px;
        position: static;
      }
      .component-choose-widget-modal-header{
        .choose-widget-popup-close{
          width: 50px;
          height: 50px;
          display: inline-block;
          right: 28px;
          position: absolute;
          top: 10px;
          &:hover{
            cursor: pointer;
          }
        }
        .choose-widget-popup-close:after{
          content: '';
          display: inline-block;
          width: 16px;
          height: 16px;
          background-image: url(${"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAsElEQVQ4jaWSLQ7EIBhEv2LxnAzP1cBzAU6DhKCpZneaQHYpP2k6omreCzA9yjf0IgyfGCMZY+g8zy2ADrpgmsA5R977raTC6IJpAiklCSEopTSVVBgddME0AeeclFJTSQ+jCwY5fh9xVERm8E0wkiAzeCjoJcgMbm/wJjdBf4XdOmwF49irdf4Es6l2E7MVXLOSXAJr7XKqkQTMFcwYQiha65JzLruggy4YZPgfPMkHXzQME+F7oHYAAAAASUVORK5CYII="});
          position: relative;
          left: 18px;
          top: 12px;
        }
      }
      .component-choose-widget-modal-body{
        display: -webkit-box;
        display: -ms-flexbox;
        display: flex;
        -ms-flex-wrap: wrap;
        flex-wrap: wrap;
        -webkit-box-pack: start;
        -ms-flex-pack: start;
        justify-content: flex-start;
        margin: 40px 0 10px 0;
        .widget-card-item{
          width: 70px;
          height: 120px;
          border: 0;
          margin: 0 30px 0 0;
          &:hover{
            cursor: pointer;
          }
          .widget-card-image{
            width: 70px;
            height: 70px;
            border: 1px solid #ccc;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
            -webkit-box-pack: center;
            -ms-flex-pack: center;
            justify-content: center;
            >div{
              width: 30px;
              height: 30px;
              position: relative;
              &:after{
                display: none;
              }
            }
          }
          .widget-card-content{
            font-size: 12px;
            color: #000;
            letter-spacing: 0.33px;
            padding: 2px;
            text-align: center;
            line-height: 14px;
          }
        }
        .widget-card-selected{
          .widget-card-image{
            border: 2px solid #0C5CB6;
            >div:after{
              content: '';
              display: block;
              width: 16px;
              height: 16px;
              position: absolute;
              top: -20px;
              right: -20px;
              background-image: url(${"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA20lEQVQ4jWPkidn2n4ECwESJ5iFgABsLI8PBRiuGS732DKJ8bKQbwMHKzKAqyc0gK8zBIMDNilUNI6FYkBBgBxrExPDg9Xes8iy4NIZYSDJ4GYkx/Pj1j6F25Q2cFuD0wo2nXxi42ZkZYu1lGMItpUg34Mrjzwx//0HYT9//IN0AFiZGBjstIaAh/xkOXntLugHGyvwM/FysDBcefGT48PUP6QaI8ELinZ2FicFGQ4iBnRW7UmY2vegGbBIPXn1j+P//P8OXn38ZPn77zXDxwSesBhBMB4QAxXkBAMaDOywJrob4AAAAAElFTkSuQmCC"});
            }
          }
        }
      }
      .component-choose-widget-modal-footer{
        position: absolute;
        bottom: 20px;
        right: 40px;
        >button{
          font-size: 14px;
          letter-spacing: 0.39px;
          text-align: center;
          vertical-align: middle;
        }
        button:first-of-type {
          background-color: #0075D0;
          border: 1px solid  #0075D0;
          border-radius: 3px;
          color: #ffffff;
        }
        button:last-of-type{
          background-color: #ffffff;
          border: 1px solid #CCCCCC;
          border-radius: 3px;
          color: #000000;
        }
      }
    }
  `},s=e=>{const t=e.theme;return o.css`
    width:100%;
    &.single-row-item {
        .select-con {
            padding: ${o.polished.rem(10)} ${o.polished.rem(0)};
            .option-name-con {
                margin-bottom: 0;
                .close-con>span {
                    margin-left: ${o.polished.rem(10)};
                }
            }
        }
    }
    .padding-0 {
        padding: 0;
    }
    .jimu-tree-item {
        margin-bottom:${o.polished.rem(10)};
    }
    .jimu-tree-item__draggable {
        box-shadow: 0 0 0 2px ${o.polished.rgba(t.ref.palette.white,.3)};
    }
    .add-option-btn {
        & {
            color:${t.sys.color.primary.light};
            margin-top:${o.polished.rem(10)};
            margin-bottom: ${o.polished.rem(17)};
            cursor: pointer;
            font-size:13px;
            overflow: hidden;
            padding: 0;
        }
        .add-option-icon{
            margin-right: 4px;
        }
    }
    .no-sort-remind {
        margin: 70px auto 0;
        color: ${t.ref.palette.neutral[700]};
        font-size: 13px;
        text-align: center;
    }
    .select-con {
        & {
            box-sizing:border-box;
            padding-right: ${o.polished.rem(10)};
            padding: ${o.polished.rem(8)} ${o.polished.rem(10)} ${o.polished.rem(10)} ${o.polished.rem(6)};
        }
        .option-name-con {
            & {
              display: flex;
              align-items: center;
              margin-bottom:${o.polished.rem(5)};
              width: 100%;
            }
            .option-name {
              font-size: 13px;
              line-height: 13px;
              color: ${t.ref.palette.neutral[1100]};
              height: ${o.polished.rem(30)};
              line-height: ${o.polished.rem(25)};
              cursor: pointer;
              overflow: hidden;
              width: 0;
              padding-right: ${o.polished.rem(4)};
              .edit-input {
                max-width: 88%;
                input {
                    width: 80px;
                }
                input:placeholder-shown {
                    text-overflow: ellipsis;
                }
              }
            }
            .option-name input {
                display:inline-block;
                width: auto;
                height: 100%;
            }
            .jimu-input {
                line-height: ${o.polished.rem(30)};
                vertical-align: middle;
            }
            .input-wrapper {
                vertical-align: middle;
            }
            .option-name-icon-con {
                margin-left: ${o.polished.rem(5)};
                svg {
                    margin-top:  ${o.polished.rem(5)};
                }
            }
            .option-name-icon {
                color: ${t.ref.palette.neutral[900]};
                cursor: pointer;
            }
            .option-name span {
                display: inline-block;
                text-overflow: ellipsis;
                overflow:hidden;
            }
            .close-con {
                svg {
                    margin: 0;
                    margin-top:  ${o.polished.rem(2)};
                }
            }
            .close-con>span {
                margin-right: ${o.polished.rem(10)};
                color: ${t.ref.palette.black};
                cursor: pointer;
            }
        }

        .select-down-con {
            & {
                display: flex;
                align-items: center;
                height: ${o.polished.rem(34)};
            }
            .sort-arrow-down-icon {
                margin-right: 0;
            }
            .select-input {
                flex-grow:1;
                color: ${t.ref.palette.neutral[1200]};
            }
            .sort-button {
                margin-left: 5px;
                cursor: pointer;
                border:none;
            }
            .sort-field-selector {
                & {
                    background:${t.sys.color.secondary.light};
                    border-radius: 2px;
                    flex-grow: 1;
                    width: 0;
                }
            }
        }
    }


  `},n=e=>{const t=e.theme;return o.css`
    .widget-setting--stylepicker {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      grid-gap: 10px;
    }

    .widget-setting--stylepicker-item {
      height: 93px;
      border: 1px solid ${t.ref.palette.neutral[500]};
      background-color: ${t.ref.palette.white};
      background-repeat: no-repeat;
      background-position: center;
      &:hover {
        border-color: ${t.sys.color.primary.main};
      }
      &.active {
        border: 2px solid ${t.sys.color.primary.main};
      }
      &.full-width {
        grid-column-start: 1;
        grid-column-end: 3;
      }
    }
  `},r=e=>{var t,i,a,s,n,r;const l=null==e?void 0:e.isOpen,c=null!==(t=null==e?void 0:e.type)&&void 0!==t?t:"default",d=e.theme,p=null===(a=null===(i=null==d?void 0:d.ref.palette)||void 0===i?void 0:i.neutral)||void 0===a?void 0:a[500],u=null===(n=null===(s=null==d?void 0:d.ref.palette)||void 0===s?void 0:s.neutral)||void 0===n?void 0:n[700],m=null===(r=null==d?void 0:d.sys.color)||void 0===r?void 0:r.primary.main;return"primary"!==c?o.css`
    .dividing-line {
      background-color: ${u};
    }
    `:o.css`
    .handle {
      border-top: 2px solid ${l?m:p};
      background-color: ${p};
      .title {
        padding-left: 8px;
        padding-right: 8px;
      }
    }
    .dividing-line {
      background-color: ${u};
    }
    `};function l(e){var t,i,a,s,n;const r=e.theme,l=null!==(a=null===(i=null===(t=null==r?void 0:r.ref)||void 0===t?void 0:t.palette)||void 0===i?void 0:i.neutral[500])&&void 0!==a?a:"#ccc",c=null!==(n=null===(s=null==r?void 0:r.sys)||void 0===s?void 0:s.color.primary.main)&&void 0!==n?n:"blue",d=o.polished.rgba(l,.5);return window.jimuConfig.isInBuilder?o.css`
    .widget-builder-link-selector {
      .collapse-btn{
        margin-right: ${o.polished.rem(-16)};
      }
      .option-name{
        font-size: ${o.polished.rem(13)};
        color: ${r.ref.palette.neutral[900]};
      }
      .link-selector-list {
        .view-border{
          border-width: 1px;
          border-style: solid;
        }
        .link-selector-list-item {
          height: ${o.polished.rem(30)};
          cursor: pointer;

          &:hover {
            background-color: ${d};
          }
        }

        .link-selector-list-select {
          background-color: ${d};
        }
      }

      select {
        padding-top: ${o.polished.rem(2)} !important;
      }

      .item-selected {
        background-color: ${c} !important;
      }

      .form-check-input {
        span {
          background: #00A6B6 !important;
        }
      }

      .form-check-input:hover {
        border-color: gray;
      }

      input[type='radio'].form-check-input {
        -webkit-appearance: none;
        -moz-appearance: none;
        background: transparent;
        border: 1px solid #000;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        transition: all 0.2s ease;
        &:before {
        content: '';
        display: block;
        position: absolute;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: #00A6B6 !important;
        margin: 8px;
        transition: all 0.2s ease-out;
        }
        &:hover {
        border-color: #00A6B6 !important;
        }
        &:checked {
        &:before {
            width: 8px;
            height: 8px;
            margin: 3px;
        }
        }
      }
      .link-setting-cursor-pointer{
        cursor: pointer;
      }
      .open-type-label{
        width: 100%;
        display: block;
      }
    }
    .url-error-container{
      *{
        color: ${r.sys.color.error.main};
      }
      div{
        width: calc(100% - 20px);
        margin-left: 4px;
        overflow: hidden;
        text-overflow: ellipsis;
      }
    }
  `:o.css`
    .widget-builder-link-selector {
      .collapse-btn{
        position: absolute;
        right: ${o.polished.rem(-4)};
      }
      .option-name{
        font-size: ${o.polished.rem(13)};
        color: ${r.ref.palette.neutral[900]};
        font-weight: 500;
      }
      .item-common{
        background: ${r.ref.palette.white};
      }
      .view-border{
        border: 1px solid ${r.ref.palette.neutral[500]};
      }
      .link-selector-list {

        .link-selector-list-item {
          height: ${o.polished.rem(30)};
          cursor: pointer;

          &:hover {
            background-color: ${d};
          }
        }

        .link-selector-list-select {
          background-color: ${d};
        }
      }

      select {
        padding-top: ${o.polished.rem(2)} !important;
      }

      .item-selected {
        background-color: ${c} !important;
      }
      .link-setting-cursor-pointer{
        cursor: pointer;
      }
      .open-type-label{
        width: 100%;
        display: block;
      }
      .url-error-container{
        *{
          color: ${r.sys.color.error.main};
        }
        div{
          width: calc(100% - 20px);
          margin-left: 4px;
          overflow: hidden;
          text-overflow: ellipsis;
        }
      }
    }
  `}function c(e){const t=e.theme;return o.css`
    color: ${t.ref.palette.neutral[1e3]};
    .font-size-13{
      font-size: ${o.polished.rem(13)} !important;
    }
    .subscriber-warning{
      font-size: ${o.polished.rem(13)};
    }
    .secondary-title{
      font-size: ${o.polished.rem(14)};
    }
    .content-table{
      font-size: ${o.polished.rem(13)};
      color: ${t.ref.palette.neutral[1100]};
    }
    .content-table-header{
      height: ${o.polished.rem(32)};
      background-color: ${t.ref.palette.neutral[500]};
      display: block;
      line-height: ${o.polished.rem(30)};
    }
    .content-table-tr{
      height: ${o.polished.rem(39)};
      line-height: ${o.polished.rem(39)};
      border-bottom: 1px solid ${t.ref.palette.neutral[500]};
    }
    .col-4, .col-2{
      height: 100%;
    }
    .request-limit{
      margin-top: ${o.polished.rem(6)};
    }
    .request-interval{
      display: block;
      margin-top: ${o.polished.rem(-3)};
    }
  `}function d(e){const t=e.theme;return o.css`
    max-width: ${o.polished.rem(960)} !important;
    .header{
      font-size: ${o.polished.rem(16)};
      color: ${t.ref.palette.neutral[1e3]};
    }
    .proxy-setting-container{
      width: ${o.polished.rem(960)};
      height: ${o.polished.rem(640)};
      border: 0;
      color: ${t.ref.palette.neutral[1e3]};
    }
    .px-30{
      padding-right: ${o.polished.rem(30)};
      padding-left: ${o.polished.rem(30)};
    }
  `}const p=e=>{const t=e.theme,i=e.gutter;return o.css`
    margin-bottom: 0;
    label {
      display: inline-flex;
      align-items: center;
      margin-right: ${i||t.sys.spacing(4)};
      .jimu-radio {
        margin-right: 8px;
      }
    }
  `};function u(e){const t=e.theme;return o.css`
    width: ${o.polished.rem(260)};
    height: calc(100vh - 70px);
    padding: 0;
    overflow: hidden;
    border-radius: 0;
    box-shadow: 0 0 0;
    border-left: 1px solid ${t.ref.palette.neutral[700]};
    border-right: 1px solid ${t.ref.palette.neutral[700]};
    border-top: 0;
    border-bottom: 0;
    margin: 0 !important;
  `}const m=e=>{const t=e.theme;return o.css`
    .dropdown-menu--inner {
      background-color: ${t.sys.color.secondary.light};
      padding: 0;
    }

    .dropdown-toggle-content {
      width: 100%;
    }

    .layerviewselector-input {
      width: 100%;
      height: 30px !important;
      background-color: ${t.sys.color.secondary.light};
      &:hover {
        background-color: ${t.sys.color.secondary.light};
      }
      flex-direction: unset !important;
    }

    .layerviewselector-input-text {
      max-width: calc(100% - 13px);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .layerviewselector-bg {
      max-height: 270px;
      overflow-y: auto;
      background-color: ${t.sys.color.secondary.light};
    }

    .layerviewselector-item-bg {
      cursor: pointer;
    }

    .layerviewselector-item-bg:hover {
      background-color: ${t.sys.color.primary.main};
    }

    .layerviewselector-ds-item {
      cursor: pointer;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      width: 100%;
    }

    .layerviewselector-ds-item:hover {
      background-color: ${t.sys.color.primary.main};
    }

    .layerviewselector-ds-item-selected {
      background-color: ${t.sys.color.primary.main};
    }
  `};var g=v(1888);function h(e,t){const i=e.sizes[t];return`\n    height: ${"auto"!==i.height?i.height:function(e,t){const i=o.polished.math(`\n    ${e.fontSize} * ${e.lineHeight} +\n    ${e.paddingY} * 2`);return"0"===t.toString()?i:`calc(${i} + ${t} * 2)`}(i,e.border.width)};\n    padding: ${i.paddingY} ${i.paddingX};\n    font-size: ${i.fontSize};\n    line-height: ${i.lineHeight};\n    border-radius: ${i.borderRadius};\n  `}const y=e=>{var t,i;const a=e.theme,s=null==e?void 0:e.buttonProps,n=null===(t=null==a?void 0:a.components)||void 0===t?void 0:t.input;return o.css`
    width: 100%;
      > .dropdown{
        > .dropdown-button {
          text-align: start;
        }
      }
      ${null!==(i=null==s?void 0:s.type)&&void 0!==i?i:o.css`
      /* Button override */
        > .dropdown{
          > .dropdown-button {
            &,
            &:hover {
              color: ${n.color};
              background-color: ${n.bg};
              background-clip: padding-box;
              box-shadow: ${n.boxShadow};
              transition: ${n.transition};
              text-decoration: none;
              ${h(n,"sm")}
              ${(0,g.getBoxStyles)(n)}
            }
            &[aria-expanded="true"] {
              color: ${n.color};
              background-color: ${n.focus.bg};
              border-color: ${n.focus.borderColor};
              text-decoration: none;
              box-shadow: ${n.boxShadow}, ${n.focus.boxShadow};
            }
          }
        }
      `}

  `},S=e=>{const t=e.isInDropdown?"366px":"calc(100% - 34px)";return o.css`
    .button-container {
      display: flex;
      justify-content: space-between;
      .search-input {
        width: calc(100% - 32px);
      }
      .layer-label {
        font-size: 14px;
        color: ${e.theme.sys.color.surface.paperHint};
        font-weight: 600;
        margin-left: 2px;
      }
      .right-buttons {
        display: flex;
        gap: var(--sys-spacing-1);
      }
    }
    .tree-container{
      margin-top: 16px;
      ${e.autoHeight?"":`height: ${t};`}
      ${e.autoHeight?"min-height: 164px;":""}
    }
    `};var b=v(4108),w=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const x=(0,g.styled)("div")((({theme:e})=>({padding:e.sys.spacing(4),borderBottom:`1px solid ${e.sys.color.divider.secondary}`,"&:last-child":{borderBottom:"none"},"&:nth-of-type(1):nth-last-of-type(1)":{borderBottom:"none"},".jimu-widget-setting--section-header":{"> h6":{color:e.sys.color.surface.paperText,marginBottom:0},"+ *":{marginTop:e.sys.spacing(4)},"&.row":{marginLeft:0,marginRight:0}}}))),C=o.React.forwardRef(((e,t)=>{const{className:i,title:a,children:s}=e,n=w(e,["className","title","children"]),r=(0,o.classNames)(i,"jimu-widget-setting--section");return o.React.createElement(x,Object.assign({styleState:e,className:r,ref:t},n),a&&o.React.createElement("div",{className:"jimu-widget-setting--section-header"},"string"==typeof a?o.React.createElement("h6",{className:"w-100 title2 hint-paper"},a):o.React.createElement("div",{className:"w-100 text-truncate title2 hint-paper"},a)),s)})),I=(0,g.styled)("div")((({theme:e,styleState:t})=>{const i=t.flow,o=t.level,a=1===o?e.sys.typography.title2:e.sys.typography.title3;return{margin:0,"+ .jimu-widget-setting--row":{marginTop:e.sys.spacing(4)},"&.bottom-line":{paddingBottom:e.sys.spacing(4),borderBottom:`1px solid ${e.sys.color.divider.secondary}`},"> .jimu-widget-setting--row-label":{display:"inline-block",marginBottom:"wrap"===i?e.sys.spacing(2):0,marginRight:e.sys.spacing(5),fontFamily:a.fontFamily,fontSize:a.fontSize,fontWeight:a.fontWeight,lineHeight:a.lineHeight,color:1===o?e.sys.color.surface.paperHint:2===o?e.sys.color.surface.backgroundText:e.sys.color.surface.backgroundHint},"> input":{'[type="number"]':{width:"50px",flexShrink:0,"&::-webkit-inner-spin-button, &::-webkit-outer-spin-button":{WebkitAppearance:"none",margin:0}}},"&.form-inline":{flexWrap:"nowrap",".jimu-widget-setting--row-label":{maxWidth:"80%","+ *":{flexShrink:0}}}}})),k=o.React.forwardRef(((e,t)=>{const{flow:i,truncateLabel:a=!1,label:s,role:n,indented:r,className:l,level:c=3,"aria-label":d,bottomLine:p=!1,tag:u="div",children:m}=e,g=Object.assign({level:c,truncateLabel:a},e),h="string"==typeof s?s:"",v=(0,o.classNames)(l,"jimu-widget-setting--row row form-group align-items-center",{"form-inline":"wrap"!==i,"bottom-line":p,"pl-5":r}),f="div"===u?"label":"span";return o.React.createElement(I,{ref:t,styleState:g,as:u,className:v,role:n,"aria-label":d},s&&o.React.createElement(f,{title:h,className:(0,o.classNames)("jimu-widget-setting--row-label justify-content-start flex-grow-1 text-break",{"w-100 mr-0":"wrap"===i,"text-truncate":a})},s),m)}));var j=v(14321),O=v(41496);const T={label:"divider",divider:!0},P=(e,t)=>{var i,o;let a=[],s=[];for(let i=1;i<t.length;i++)if("dialogs"===t[i].type){e=i;break}return 1===e&&"dialogs"===(null===(i=t[1])||void 0===i?void 0:i.type)?s=t.slice(1):1===e&&"pages"===(null===(o=t[1])||void 0===o?void 0:o.type)?a=t.slice(1):(a=t.slice(1,e),s=t.slice(e)),{pageList:a,dialogList:s}};var R;!function(e){e.Page="pages",e.Dialog="dialogs",e.Widget="widgets"}(R||(R={}));const M=(e,t,i)=>e.sort(((e,o)=>{const a=i===R.Widget?t[i][e].label:t[i][e.id].label,s=i===R.Widget?t[i][o].label:t[i][o.id].label;return a.localeCompare(s,null===window||void 0===window?void 0:window.locale,{numeric:!0,sensitivity:"base"})})),{useState:N}=o.React,L=e=>{var t;const{autoSelect:i=!0,onSelect:a,showLabel:s=!1,warningMessage:n="",isNeedConfirmBeforeChange:r}=e,l=o.hooks.useTranslation(j.defaultMessages),[c,d]=N(!1),[p,u]=N(null),m={id:"none",label:l("none")},g=o.ReactRedux.useSelector((e=>{var t,i;return(null===(t=null===window||void 0===window?void 0:window.jimuConfig)||void 0===t?void 0:t.isBuilder)?null===(i=e.appStateInBuilder)||void 0===i?void 0:i.appConfig:e.appConfig})),h=o.ReactRedux.useSelector((e=>{var t;return null===(t=e.appStateInBuilder)||void 0===t?void 0:t.browserSizeMode})),v=o.ReactRedux.useSelector((e=>{var t;return null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appRuntimeInfo.currentPageId})),f=o.ReactRedux.useSelector((e=>{var t;return null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appRuntimeInfo.currentDialogId})),y=f?o.ContainerType.Dialog:o.ContainerType.Page,S=f||v,b=o.React.useMemo((()=>((e,t,i,a)=>{const s=[];if(e[0].maps.length>0){s.push(T);const n={header:!0,label:i===o.ContainerType.Dialog?a("currentWindow"):a("currentPage")};s.push(n),M(e[0].maps,t,R.Widget).forEach((e=>{const n={id:e,label:t.widgets[e].label,headerLabel:i===o.ContainerType.Dialog?a("currentWindow"):a("currentPage")};s.push(n)}))}const n=P(1,e);let r=!1;const l=M(n.pageList,t,R.Page);for(let e=0;e<n.pageList.length;e++)if(n.pageList[e].maps.length>0){r||(s.push(T),r=!0);const i={header:!0,label:t.pages[l[e].id].label};s.push(i),M(l[e].maps,t,R.Widget).forEach((i=>{const o={id:i,label:t.widgets[i].label,headerLabel:t.pages[l[e].id].label};s.push(o)}))}if(n.dialogList){let e=!1;const i=M(n.dialogList,t,R.Dialog);for(let o=0;o<n.dialogList.length;o++)if(n.dialogList[o].maps.length>0){e||(s.push(T),e=!0);const a={header:!0,label:t.dialogs[i[o].id].label};s.push(a),M(i[o].maps,t,R.Widget).forEach((e=>{const a={id:e,label:t.widgets[e].label,headerLabel:t.dialogs[i[o].id].label};s.push(a)}))}}return s})(O.searchUtils.getMapWidgets(g,h,y,S),g,y,l)),[g,h,y,S,l]),[w,x]=N((null===(t=e.useMapWidgetIds)||void 0===t?void 0:t[0])||null),C=o.React.useRef(w);o.hooks.useUpdateEffect((()=>{var t,i;x((null===(t=e.useMapWidgetIds)||void 0===t?void 0:t[0])||null),C.current=(null===(i=e.useMapWidgetIds)||void 0===i?void 0:i[0])||null}),[e.useMapWidgetIds]),o.React.useEffect((()=>{if(i&&!e.useMapWidgetIds){const e=O.searchUtils.getMapWidgets(g,h,y,S),t=1===e[0].maps.length?e[0].maps[0]:null;t&&(null==a||a([t]))}}),[]);const I=e=>{const t=e.target.value;if(t===w)return;const i=t===m.id?[]:[t];r?null===C.current?(null==a||a(i),x(t)):d(!0):(null==a||a(i),x(t)),u(t)},k=(()=>{var t;if(!e.useMapWidgetIds||0===(null===(t=e.useMapWidgetIds)||void 0===t?void 0:t.length))return null;const i=e.useMapWidgetIds[0];return b.find((e=>e.id===i))||null})();return o.React.createElement("div",{className:"w-100 component-map-selector"},s&&o.React.createElement(j.Label,{title:l("selectMapWidget"),className:"jimu-widget-setting--row-label justify-content-start flex-grow-1 text-break title3 hint-default w-100 mr-0"},l("selectMapWidget")),o.React.createElement(j.Select,{size:"sm",value:k?k.id:m.id,"aria-label":e["aria-label"]||l("selectMapWidget"),"aria-describedby":e["aria-describedby"],"ally-description":e["ally-description"]},[m].concat(b).map(((e,t)=>o.React.createElement(j.Option,{header:e.header,divider:e.divider,value:e.id,key:t,onClick:I},!e.header&&o.React.createElement("div",{className:"sr-only"},e.headerLabel),e.label)))),n&&o.React.createElement(j.Alert,{tabIndex:0,className:"w-100 mt-2",open:!0,text:n,type:"warning"}),c&&o.React.createElement(j.ConfirmDialog,{level:"info",title:l("confirmTitle"),hasNotShowAgainOption:!1,content:e.confirmMessage,onConfirm:()=>{d(!1);const e=p,t=e===m.id?[]:[e];null==a||a(t),x(p)},onClose:()=>{d(!1)}}))},D=L;class A extends o.React.PureComponent{constructor(e){super(e),this.getIsLoading=()=>!!this.props.fromRootDsIds&&this.props.fromRootDsIds.some((e=>this.getIsSingleDsLoading(e))),this.getIsSingleDsLoading=e=>{const t=o.DataSourceManager.getInstance().getDataSource(e),i=null==t?void 0:t.getInfo();return!!i&&(i.instanceStatus!==o.DataSourceStatus.CreateError&&(i.instanceStatus!==o.DataSourceStatus.Created||!!t.isDataSourceSet()&&!t.areChildDataSourcesCreated()))},this.formatMessage=(e,t)=>{const i=Object.assign({},j.defaultMessages);return this.props.intl.formatMessage({id:e,defaultMessage:i[e]},t)},this.state={isLoading:this.getIsLoading()}}componentDidMount(){this.state.isLoading&&this.waitChildDssReady().finally((()=>{this.setState({isLoading:!1})}))}componentDidUpdate(e){e.fromRootDsIds!==this.props.fromRootDsIds&&this.setState({isLoading:this.getIsLoading()}),this.state.isLoading&&this.waitChildDssReady().finally((()=>{this.setState({isLoading:!1})}))}waitChildDssReady(){return this.props.fromRootDsIds?Promise.all(this.props.fromRootDsIds.map((e=>this.waitChildDssReadyForSingleDs(e)))).catch((e=>[])):Promise.resolve([])}waitChildDssReadyForSingleDs(e){const t=o.DataSourceManager.getInstance().getDataSource(e);return(null==t?void 0:t.isDataSourceSet())&&!t.areChildDataSourcesCreated()?t.childDataSourcesReady().then((()=>t)):Promise.resolve(t)}getContent(){var e,t,i,a;const s=[];for(let e=0;e<this.props.fromRootDsIds.length;e++)s.push(this.props.fromRootDsIds[e]);const n=(null===(e=null===window||void 0===window?void 0:window.jimuConfig)||void 0===e?void 0:e.isBuilder)?null===(i=null===(t=(0,o.getAppStore)().getState())||void 0===t?void 0:t.appStateInBuilder)||void 0===i?void 0:i.appConfig:null===(a=(0,o.getAppStore)().getState())||void 0===a?void 0:a.appConfig;return o.React.createElement("div",{className:"w-100"},s.map(((e,t)=>{var i;const a=o.DataSourceManager.getInstance().getDataSource(e),s=null===(i=n.dataSources[e])||void 0===i?void 0:i.sourceLabel,r=(e=>{var t,i,a;return(null===(a=null===(i=null===(t=(0,o.getAppStore)().getState().appStateInBuilder)||void 0===t?void 0:t.dataSourcesInfo)||void 0===i?void 0:i[e])||void 0===a?void 0:a.instanceStatus)===o.DataSourceStatus.CreateError})(e),l=(null==a?void 0:a.isDataSourceSet())&&(null==a?void 0:a.getChildDataSources());return o.React.createElement("div",{key:t},o.React.createElement("div",{className:"hint-paper pl-2 pr-2 d-flex align-items-center justify-content-between",style:{fontSize:"14px"}},s,r&&o.React.createElement(j.Alert,{variant:"text",form:"tooltip",size:"small",type:"error",text:this.formatMessage("dataSourceCreateError")})),null==l?void 0:l.map(((t,i)=>o.React.createElement("div",{key:i,className:"mt-1 mb-1"},o.React.createElement("div",{className:(0,o.classNames)("layerviewselector-ds-item pl-2 pr-2",{"layerviewselector-ds-item-selected":this.props.selectedDsIds&&this.props.selectedDsIds.includes(t.id)}),title:t.getLabel(),onClick:()=>{this.props.onSelect&&this.props.onSelect({rootDataSourceId:e,dataSourceId:t.id})}},null==t?void 0:t.getLabel())))))})))}render(){return this.props.fromRootDsIds&&0!==this.props.fromRootDsIds.length?o.React.createElement("div",{className:"w-100"},this.state.isLoading?o.React.createElement(j.Loading,{type:j.LoadingType.Secondary,width:24,height:16}):this.getContent()):null}}const E=(0,o.injectIntl)(A),F=o.css`
& {
  .ds-selector > span {
    display: none;
  }
}
`;class B extends o.React.PureComponent{constructor(e){super(e),this.selectorConRef=o.React.createRef(),this.toggleList=e=>{this.setState({listOpen:!this.state.listOpen})},this.onResize=({width:e,height:t})=>{this.setState({width:e})},this.handleChooseLayer=e=>{if(this.props.onSelect)if(e){const t=o.DataSourceManager.getInstance().getDataSource(e.rootDataSourceId),i=o.DataSourceManager.getInstance().getDataSource(e.dataSourceId).id,a=t.isDataSourceSet()&&t.getJimuChildId(i)[0];this.props.onSelect((0,o.Immutable)({jimuMapViewId:`${this.props.useMapWidgetIds[0]}-${e.rootDataSourceId}`,jimuLayerId:a,dataSourceId:e&&e.dataSourceId,rootDataSourceId:e&&e.rootDataSourceId}))}else this.props.onSelect((0,o.Immutable)({}));this.setState({listOpen:!1})},this.handleClickNone=()=>{this.props.onSelect&&this.props.onSelect((0,o.Immutable)({})),this.setState({listOpen:!1})},this.getTitle=()=>this.props.jimuLayerViewInfo&&this.props.useMapWidgetIds&&this.props.useMapWidgetIds[0]&&this.props.jimuLayerViewInfo.dataSourceId?(0,o.jsx)(o.DataSourceComponent,{useDataSource:(0,o.Immutable)({dataSourceId:this.props.jimuLayerViewInfo.dataSourceId,mainDataSourceId:this.props.jimuLayerViewInfo.dataSourceId,rootDataSourceId:this.props.jimuLayerViewInfo.rootDataSourceId})},((e,t,i)=>null==e?void 0:e.getLabel())):this.getNoneString(),this.getContent=()=>{const e=this.props.useMapWidgetIds&&this.props.useMapWidgetIds[0],t=(0,o.getAppStore)().getState().appStateInBuilder.appConfig.widgets[e];return t&&t.useDataSources&&t.useDataSources[0]?(0,o.jsx)("div",{className:"w-100 mt-1 mb-2"},(0,o.jsx)("div",{onClick:()=>{this.handleClickNone()}},(0,o.jsx)("div",{className:"layerviewselector-ds-item pl-2 pr-2"},this.getNoneString())),(0,o.jsx)("div",{className:"w-100 mt-1 mb-1"},(0,o.jsx)("div",{className:"w-100 border border-bottom-0 border-right-0 border-left-0"})),(0,o.jsx)("div",{className:"ds-selector"},(0,o.jsx)(o.MultipleDataSourceComponent,{useDataSources:t.useDataSources},((e,t)=>{const i=(0,o.Immutable)(Object.keys(e)),a=[];return this.props.jimuLayerViewInfo&&this.props.jimuLayerViewInfo.dataSourceId&&a.push(this.props.jimuLayerViewInfo.dataSourceId),(0,o.jsx)(E,{fromRootDsIds:i,onSelect:e=>{this.handleChooseLayer(e)},selectedDsIds:(0,o.Immutable)(a)})})))):this.getEmptyContent()},this.getNoneString=()=>this.props.intl.formatMessage({id:"none",defaultMessage:"None"}),this.getEmptyContent=()=>(0,o.jsx)("div",{className:"w-100 mt-1 mb-2"},(0,o.jsx)("div",{className:"layerviewselector-ds-item pl-2 pr-2",onClick:()=>{this.handleClickNone()}},this.getNoneString())),this.state={listOpen:!1,width:0}}render(){return(0,o.jsx)("div",{ref:this.selectorConRef,className:(0,o.classNames)("w-100",{[this.props.className]:!!this.props.className})},(0,o.jsx)(j.Dropdown,{size:"sm",toggle:e=>{this.toggleList(e)},isOpen:this.state.listOpen,className:"w-100"},(0,o.jsx)(j.DropdownButton,{size:"sm",type:"tertiary",className:(0,o.classNames)("w-100 d-flex flex-column align-items-center toollist-item","justify-content-between toollist-item-click layerviewselector-input")},(0,o.jsx)("div",{className:"w-100 d-flex justify-content-between align-items-center"},(0,o.jsx)("div",{className:"layerviewselector-input-text ml-2"},this.getTitle()))),(0,o.jsx)(j.DropdownMenu,{className:(0,o.classNames)("ml-0 mr-0 mb-0 mt-1 p-0",{[this.props.className]:!!this.props.className}),css:F},(0,o.jsx)("div",{className:"w-100 h-100 layerviewselector-bg"},(0,o.jsx)("div",{style:{width:`${this.state.width}px`}},this.getContent())))),(0,o.jsx)(o.ReactResizeDetector,{targetRef:this.selectorConRef,handleWidth:!0,onResize:this.onResize}))}}const U=(0,o.injectIntl)((0,g.withStyles)(B,"JimuLayerViewSelectorDeprecated"));var z=v(50170),$=v.n(z),V=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const W=e=>{const t=window.SVG,{className:i}=e,a=V(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:$()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var G=v(98640),H=v(62686),_=v(13424),J=v.n(_),K=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const q=e=>{const t=window.SVG,{className:i}=e,a=K(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:J()},a)):o.React.createElement("svg",Object.assign({className:s},a))},X=(e,t)=>e.itemChildren&&0!==e.itemChildren.length?(e.itemChildren=e.itemChildren.sort(((e,i)=>t[e.itemKey].index-t[i.itemKey].index)),e.itemChildren.forEach((e=>X(e,t))),e):e,Y=(e,t)=>{if(!e.itemChildren||0===e.itemChildren.length)return e.itemStateTitle.toLowerCase().includes(t.toLowerCase())?e:null;const i=e.itemChildren.map((e=>Y(e,t))).filter(Boolean);return i.length>0&&(e.itemStateExpanded=!0),0===i.length?e.itemStateTitle.toLowerCase().includes(t.toLowerCase())?e:null:(e.itemChildren=i,e)},Q=e=>{const t={};return e.forEach((e=>{t[e.id]=e})),t},Z=e=>{const{jimuMapViewId:t,hideLayers:i,disableLayers:a,isMultiSelection:s=!1,selectedValues:n,isShowTables:r=!1}=e,l=o.hooks.useTranslation(j.defaultMessages),{useState:c,useEffect:d,useMemo:p,useRef:u}=o.React,[m,g]=c(""),[h,f]=c(!1),[y,S]=c(null),[b,w]=c(null),[x,C]=c(null),[I,k]=c(!0),[O,T]=c(!1),P=u(null);d((()=>{const e=H.MapViewManager.getInstance().getJimuMapViewById(t);if(!e)return;k(!0),e.whenJimuMapViewLoaded().then((()=>{k(!1),r&&C(e.jimuTables)}));const i=e.getAllJimuLayerViews();w(Q(i));const o=()=>{const t=e.getAllJimuLayerViews();w(Q(t))};return e.addJimuLayerViewCreatedListener(o),()=>{null==e||e.removeJimuLayerViewCreatedListener(o)}}),[r,t]);const[R,M]=c([]);d((()=>{if(!b)return;const e=((e,t,i,o,a,s,n)=>{const r={itemKey:"root item",itemStateTitle:"root item",itemChildren:[]},l={};for(const i of Object.keys(e)){const s=!!t&&t(e[i],e),n=(null==o?void 0:o.length)>0&&o.includes(i);l[i]={itemKey:i,itemStateTitle:e[i].layer.title,itemChildren:[],isItemSelectable:!s,itemStateChecked:!s&&n,itemStateExpanded:a.includes(i)}}for(const[t,o]of Object.entries(e)){const{parentJimuLayerViewId:a}=o;if(!e[t].fromRuntime){const o=l[t];i&&i(e[t],e)||(null===a?r.itemChildren.push(o):l[a].itemChildren.push(o))}}const c=X(r,e);if(s){const e={};for(const t of Object.keys(null!=n?n:{})){const i=(null==o?void 0:o.length)>0&&o.includes(t);e[t]={itemKey:t,itemStateTitle:n[t].title,itemChildren:[],isItemSelectable:!0,itemStateChecked:i,itemStateIcon:{icon:v(18249)}},c.itemChildren.push(e[t])}}return c})(b,a,i,n,R,r,x);S(e)}),[b,a,i,n,R,r,x]),d((()=>{h&&P.current&&((0,o.focusElementInKeyboardMode)(P.current,!0),P.current.select())}),[h]);const N=p((()=>{if(m){const e=JSON.parse(JSON.stringify(y)),t=Y(e,m);if(t)return t;return{itemKey:"root item",itemStateTitle:"root item",itemChildren:[]}}return y}),[y,m]),L=(t,i,o)=>{const a=JSON.parse(JSON.stringify(t)),s=[],n=[];a.itemChildren.forEach((function e(t){const a=t.itemStateChecked,r=t.isItemSelectable;"itemStateChecked"===i&&o&&t.isItemSelectable||"toggleAll"===i&&!a&&r?n.push(t.itemKey):"itemStateExpanded"===i&&s.push(t.itemKey),t.itemChildren&&t.itemChildren.length>0&&t.itemChildren.forEach(e)})),"itemStateChecked"===i?o?e.onChange(n):e.onChange([]):"toggleAll"===i?e.onChange(n):"itemStateExpanded"===i&&M(o?s:[])};return(0,o.jsx)("div",{className:(0,o.classNames)("component-layer-view-selector","w-100 h-100",e.className||""),role:"group","aria-label":l("layers")},(0,o.jsx)("div",{className:"button-container"},(0,o.jsx)(j.TextInput,{allowClear:!0,size:"sm",type:"text",className:(0,o.classNames)("search-input",{"d-none":!h}),value:m,placeholder:l("SearchLabel"),onChange:e=>{const t=e.target.value;g(t)},"aria-label":l("SearchLabel"),ref:P}),(0,o.jsx)(j.Label,{className:(0,o.classNames)("layer-label",{"d-none":h}),title:l("layers"),check:!0},l("layers")),(0,o.jsx)("div",{className:"right-buttons"},(0,o.jsx)(j.Dropdown,{className:(0,o.classNames)({"d-none":h}),isOpen:O,toggle:()=>{T(!O)},"aria-label":l("batchOptions")},(0,o.jsx)(j.DropdownButton,{className:"batch-option-btn",onClick:()=>{T(!O)},arrow:!1,icon:!0,type:"tertiary",variant:"text",size:"sm",title:l("batchOptions")},(0,o.jsx)(q,{autoFlip:!0})),(0,o.jsx)(j.DropdownMenu,null,(s?[{value:"selectAll",label:l("selectAllAvailableLayers")},{value:"unselectAll",label:l("unselectAllAvailableLayers")},{value:"toggleAll",label:l("toggleAll")},{value:"divider",divider:!0},{value:"expandAll",label:l("expandAllLayers")},{value:"collapseAll",label:l("collapseAllLayers")}]:[{value:"expandAll",label:l("expandAllLayers")},{value:"collapseAll",label:l("collapseAllLayers")}]).map((e=>(0,o.jsx)(j.DropdownItem,{divider:e.divider,key:e.value,onClick:()=>{(e=>{switch(e){case"selectAll":L(y,"itemStateChecked",!0);break;case"unselectAll":L(y,"itemStateChecked",!1);break;case"expandAll":L(y,"itemStateExpanded",!0);break;case"collapseAll":L(y,"itemStateExpanded",!1);break;case"toggleAll":L(y,"toggleAll")}})(e.value)},title:e.label},e.label))))),(0,o.jsx)(j.Button,{type:"tertiary",size:"sm",icon:!0,title:l("SearchLabel"),onClick:()=>{f(!h),g("")}},(0,o.jsx)(W,null)))),(0,o.jsx)("div",{className:"tree-container"},I?(0,o.jsx)(j.Loading,{className:"w-100 h-100",type:j.LoadingType.Secondary}):(0,o.jsx)(G.Tree,{className:"w-100",collapseStyle:G.TreeCollapseStyle.Arrow,dndEnabled:!1,onUpdateItem:(t,i)=>{var o,a;if(t.updateType===G.TreeItemActionType.HandleExpandItem){const e=null===(o=t.currentItemJson)||void 0===o?void 0:o.itemKey,i=null===(a=t.changeItemJson)||void 0===a?void 0:a.itemStateExpanded;e&&M((t=>i?[...t,e]:t.filter((t=>t!==e))))}if(t.updateType===G.TreeItemActionType.HandleCheckboxChanged){const[i]=t.itemJsons;if(s){const t=n?[...n]:[];i.isItemSelectable&&i.itemStateChecked?t.push(i.itemKey):i.isItemSelectable&&!1===i.itemStateChecked&&t.splice(t.indexOf(i.itemKey),1),e.onChange(t)}else i.isItemSelectable&&i.itemStateChecked?e.onChange([i.itemKey]):i.isItemSelectable&&!1===i.itemStateChecked&&e.onChange([])}},rootItemJson:N||y,isMultiSelection:s,checkboxLinkage:!1,size:"sm",treeAlignmentType:G.TreeAlignmentType.Intact,disableDoubleClickTitle:!0,treeStyle:G.TreeStyle.Basic,singleLineText:!0,searchedText:m})))},ee=(0,g.withStyles)(Z,"JimuLayerViewSelector"),te=e=>{const t=o.hooks.useTranslation(j.defaultMessages),{useRef:i,useState:a}=o.React,s=i(null),[n,r]=a(!1);return(0,o.jsx)("div",{className:(0,o.classNames)("component-layer-view-selector-dropdown","w-100",e.className||"")},(0,o.jsx)(j.Dropdown,{className:"w-100",direction:"down",toggle:()=>{r(!n)},isOpen:n,autoWidth:!0},(0,o.jsx)(j.DropdownButton,{ref:e=>{s.current=e},role:"combobox"},(()=>{var i;const{selectedValues:o,isMultiSelection:a,jimuMapViewId:s}=e,n=(null==o?void 0:o.length)||0;if(0===n)return t("numSelected",{number:n});if(a)return t("numSelected",{number:n});{const e=H.MapViewManager.getInstance().getJimuMapViewById(s);return null===(i=null==e?void 0:e.jimuLayerViews[o[0]])||void 0===i?void 0:i.layer.title}})()),(0,o.jsx)(j.DropdownMenu,{className:"shadow-3",css:o.css`
      ${s?`\n          width: ${o.polished.rem(1.5*(null===(l=s.current)||void 0===l?void 0:l.clientWidth))} !important;\n        `:""}
      padding: 16px;
    `,alignment:"end"},(0,o.jsx)(ee,Object.assign({},e,{isInDropdown:!0})))));var l},ie=(0,g.withStyles)(te,"JimuLayerViewSelectorDropdown"),oe=e=>{var t,i,a,s,n,r;if(!e)return"";const l=(null===(t=null===window||void 0===window?void 0:window.jimuConfig)||void 0===t?void 0:t.isBuilder)?null===(a=null===(i=(0,o.getAppStore)().getState())||void 0===i?void 0:i.appStateInBuilder)||void 0===a?void 0:a.appConfig:null===(s=(0,o.getAppStore)().getState())||void 0===s?void 0:s.appConfig;return(null===(n=l.dataSources[e])||void 0===n?void 0:n.label)||(null===(r=l.dataSources[e])||void 0===r?void 0:r.sourceLabel)},ae=e=>{const t=o.hooks.useTranslation(j.defaultMessages),i={id:"none",label:t("none")},a=o.ReactRedux.useSelector((e=>{var t,i;return(null===(t=null===window||void 0===window?void 0:window.jimuConfig)||void 0===t?void 0:t.isBuilder)?null===(i=e.appStateInBuilder)||void 0===i?void 0:i.appConfig:e.appConfig})),s=o.ReactRedux.useSelector((e=>{var t;return null===(t=e.appStateInBuilder)||void 0===t?void 0:t.browserSizeMode})),n=o.ReactRedux.useSelector((e=>{var t;return null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appRuntimeInfo.currentPageId})),r=o.ReactRedux.useSelector((e=>{var t;return null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appRuntimeInfo.currentDialogId})),l=r?o.ContainerType.Dialog:o.ContainerType.Page,c=r||n,d=o.React.useMemo((()=>{const e=O.searchUtils.getMapWidgets(a,s,l,c);return(()=>{const i=[],s=e[0].maps.length>0;let n=!1;if(s){M(e[0].maps,a,R.Widget).forEach(((e,s)=>{if(a.widgets[e].useDataSources&&a.widgets[e].useDataSources.length>0){n||(i.push(T),n=!0);const s={header:!0,label:`${l===o.ContainerType.Dialog?t("currentWindow"):t("currentPage")} | ${a.widgets[e].label}`};i.push(s),a.widgets[e].useDataSources.forEach((s=>{const n={id:`${e}-${s.dataSourceId}`,label:oe(s.dataSourceId),headerLabel:`${l===o.ContainerType.Dialog?t("currentWindow"):t("currentPage")} ${a.widgets[e].label}`};i.push(n)}))}}))}const r=P(1,e);let c=!1;const d=M(r.pageList,a,R.Page);for(let e=0;e<r.pageList.length;e++){const t=M(d[e].maps,a,R.Widget);for(let o=0;o<t.length;o++)if(a.widgets[t[o]].useDataSources&&a.widgets[t[o]].useDataSources.length>0){c||(i.push(T),c=!0);const s={header:!0,label:`${a.pages[d[e].id].label} | ${a.widgets[t[o]].label}`};i.push(s),a.widgets[t[o]].useDataSources.forEach((s=>{const n={id:`${t[o]}-${s.dataSourceId}`,label:oe(s.dataSourceId),headerLabel:`${a.pages[d[e].id].label} ${a.widgets[t[o]].label}`};i.push(n)}))}}if(r.dialogList){let e=!1;const t=M(r.dialogList,a,R.Dialog);for(let o=0;o<r.dialogList.length;o++){const s=M(t[o].maps,a,R.Widget);for(let n=0;n<s.length;n++)if(a.widgets[s[n]].useDataSources&&a.widgets[s[n]].useDataSources.length>0){e||(i.push(T),e=!0);const r={header:!0,label:`${a.dialogs[t[o].id].label} | ${a.widgets[s[n]].label}`};i.push(r),a.widgets[s[n]].useDataSources.forEach((e=>{const r={id:`${s[n]}-${e.dataSourceId}`,label:oe(e.dataSourceId),headerLabel:`${a.dialogs[t[o].id].label} ${a.widgets[s[n]].label}`};i.push(r)}))}}}return i})()}),[a,s,l,c,t]),p=(()=>{var t;if(!e.useMapViewIds||0===(null===(t=e.useMapViewIds)||void 0===t?void 0:t.length))return null;const i=e.useMapViewIds[0];return d.find((e=>e.id===i))||null})();return o.React.createElement("div",{className:"w-100"},o.React.createElement("div",{className:"component-map-view-selector"},o.React.createElement(j.Select,{size:"sm",onChange:t=>{var o;const a=t.target.value,s=a===i.id?[]:[a];null===(o=e.onChange)||void 0===o||o.call(e,s)},value:p?p.id:i.id,"aria-label":e["aria-label"]},[i].concat(d).map(((e,i)=>{var a;return(e=>{var t,i,a;return(null===(a=null===(i=null===(t=(0,o.getAppStore)().getState().appStateInBuilder)||void 0===t?void 0:t.dataSourcesInfo)||void 0===i?void 0:i[e])||void 0===a?void 0:a.instanceStatus)===o.DataSourceStatus.CreateError})(null===(a=e.id)||void 0===a?void 0:a.split("-")[1])?o.React.createElement(j.Option,{disabled:!0,className:"d-flex align-items-center justify-content-start"},o.React.createElement("span",null,e.label),o.React.createElement(j.Alert,{buttonType:"tertiary",form:"tooltip",size:"small",type:"error",text:t("dataSourceCreateError"),style:{marginLeft:"auto"}})):o.React.createElement(j.Option,{header:e.header,divider:e.divider,value:e.id,key:i},!e.header&&o.React.createElement("div",{className:"sr-only"},e.headerLabel),e.label)})))))},se=ae;class ne extends o.React.PureComponent{constructor(e){super(e),this.onStyleClick=e=>{this.state.selectedValue!==e&&(this.setState({selectedValue:e}),this.props.onChange&&this.props.onChange(e))},this.state={selectedValue:this.props.value}}componentDidUpdate(e,t){e.value!==this.props.value&&this.setState({selectedValue:this.props.value})}render(){const e=this.props.styles;return o.React.createElement("div",{className:(0,o.classNames)("widget-setting--stylepicker w-100",{small:"small"===this.props.size})},Object.keys(e).map(((t,i)=>o.React.createElement("div",{key:t,role:"button",className:(0,o.classNames)("widget-setting--stylepicker-item",{active:t===this.state.selectedValue,"full-width":"full"===e[t].size}),style:{backgroundImage:`url(${e[t].thumbnail})`},onClick:()=>{this.onStyleClick(t)}}))))}}const re=(0,g.withStyles)(ne,"StylePicker");var le=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};class ce extends o.React.PureComponent{constructor(e){super(e),this.state={value:this.props.value},this.onRadioButtonChange=e=>{const t=e.target.value;this.state.value!==t&&(this.setState({value:t}),this.props.onChange&&this.props.onChange(t))},ce.count++,this.inputName=`setting-radiogroup-${ce.count}`}render(){const e=this.props,{options:t,className:i}=e,a=le(e,["options","className"]);return o.React.createElement(j.FormGroup,Object.assign({},a,{onChange:this.onRadioButtonChange,className:`setting--button-group ${i}`}),t.map((e=>o.React.createElement(j.Label,{key:e.value},o.React.createElement(j.Radio,{value:e.value,name:this.inputName,checked:this.state.value===e.value}),e.content))))}}ce.count=0;const de=(0,g.withStyles)(ce,"RadioGroup"),pe=j.CollapsablePanel,ue=j.CollapsablePanel,me=j.CollapsableToggle,ge=j.CollapsableRadio,he=j.CollapsableCheckbox;class ve extends o.React.PureComponent{constructor(){super(...arguments),this.itemOnClick=e=>{this.props.onClick(e),this.setState({selectedItemName:e.name})}}render(){const e=this.props.datas.find((e=>this.props.linkParam.value===e.id)),t=e&&e.id;return o.React.createElement("div",{className:"link-selector-list w-100"},o.React.createElement(j.Select,{value:t||"",className:"w-100",onChange:e=>{this.itemOnClick(this.props.datas.find((t=>t.id===e.target.value)))},"aria-label":this.props["aria-label"],size:"sm"},this.props.datas.map(((e,t)=>o.React.createElement("option",{key:t,value:e.id},e.name)))))}}function fe(e,t){var i,a;const s=null===(i=null==t?void 0:t.pages)||void 0===i?void 0:i[e];if((null==s?void 0:s.type)===o.PageType.Normal){const i=O.searchUtils.getContentsInContainer(t,{type:o.ContainerType.Page,id:e},o.LayoutItemType.Section,O.utils.getCurrentSizeMode());let n=[],r=[];return s.header&&(n=O.searchUtils.getContentsInContainer(t,{type:o.ContainerType.Header,id:"header"},o.LayoutItemType.Section,O.utils.getCurrentSizeMode())),s.footer&&(r=O.searchUtils.getContentsInContainer(t,{type:o.ContainerType.Footer,id:"footer"},o.LayoutItemType.Section,O.utils.getCurrentSizeMode())),null===(a=n.concat(i,r))||void 0===a?void 0:a.sort(((e,i)=>{var o,a,s,n,r;return null===(s=null===(a=null===(o=null==t?void 0:t.sections)||void 0===o?void 0:o[e])||void 0===a?void 0:a.label)||void 0===s?void 0:s.localeCompare(null===(r=null===(n=null==t?void 0:t.sections)||void 0===n?void 0:n[i])||void 0===r?void 0:r.label,null===window||void 0===window?void 0:window.locale,{numeric:!0,sensitivity:"base"})}))}return[]}function ye(e,t){var i;return(null===(i=null==t?void 0:t.dialogs)||void 0===i?void 0:i[e])?O.searchUtils.getContentsInContainer(t,{type:o.ContainerType.Dialog,id:e},o.LayoutItemType.Section,O.utils.getCurrentSizeMode()):[]}function Se(e,t){if(!e)return[];const i=be(e,t);if(i&&i.length>0){let e=[],o=[];return i.forEach((i=>{e=e.concat(we(i,t).map((e=>e.id)))})),e.length>0&&e.forEach((e=>{o=o.concat(Se(e,t))})),e.concat(o)}return[]}function be(e,t){return O.searchUtils.getContentsInContainer(t,{type:o.ContainerType.View,id:e},o.LayoutItemType.Section,O.utils.getCurrentSizeMode())||[]}function we(e,t){const i=t.sections[e].views,o=[];for(let e=0;e<i.length;e++)o.push({id:i[e],label:t.views[i[e]].label});return o.sort(((e,t)=>{var i;return null===(i=e.label)||void 0===i?void 0:i.localeCompare(t.label,null===window||void 0===window?void 0:window.locale,{numeric:!0,sensitivity:"base"})}))}function xe(e,t){const i=null==e?void 0:e.pages,a={id:o.CONSTANTS.CURRENT_PAGE,name:t.formatMessage({id:"currentPage",defaultMessage:j.defaultMessages.currentPage})},s=i&&Object.keys(i).filter((e=>i[e].type===o.PageType.Normal)).sort(((e,t)=>{var o;return null===(o=i[e].label)||void 0===o?void 0:o.localeCompare(i[t].label,null===window||void 0===window?void 0:window.locale,{numeric:!0,sensitivity:"base"})}));let n=[a];return s&&(n=n.concat(s.map((e=>({id:e,name:i[e].label}))))),n}function Ce(e){const t=null==e?void 0:e.dialogs,i=t&&Object.values(t).filter((e=>(null==e?void 0:e.mode)===o.DialogMode.Fixed))||[],a=t&&Object.values(t).filter((e=>(null==e?void 0:e.mode)===o.DialogMode.Anchored))||[],s=i.concat(a).sort(((e,t)=>{var i;return null===(i=e.label)||void 0===i?void 0:i.localeCompare(t.label,null===window||void 0===window?void 0:window.locale,{numeric:!0,sensitivity:"base"})})).map((e=>e.id));return s&&s.filter((e=>!t[e].isSplash)).map((e=>({id:e,name:t[e].label})))}function Ie(e){var t;return ke(e.linkType===o.LinkType.View?null===(t=e.value)||void 0===t?void 0:t.split(",")[0]:null)}function ke(e){return"string"==typeof e&&e.includes("dialog_")}const je=["https","mailto","tel","sms","ftp"];class Oe extends o.React.PureComponent{constructor(){super(...arguments),this.getInitLinkParam=()=>{const e=this.props.appConfig.pageStructure;if(!e||e.length<1)return(0,o.Immutable)({value:""});if(this.props.originLinkParam.linkType!==o.LinkType.Page){const e=xe(this.props.appConfig,this.props.intl);return(0,o.Immutable)({linkType:o.LinkType.Page,value:e&&e.some((e=>"default"===e.id))?"default":e&&e[0]&&e[0].id,openType:!this.props.openTypes||this.props.openTypes.includes(o.OpenTypes.CurrentWindow)?o.OpenTypes.CurrentWindow:this.props.openTypes[0]})}return this.props.originLinkParam},this.setLinkParam=e=>{let t=this.props.linkParam;t=t.set("value",e.id),this.props.onLinkParamChange(t)}}componentDidMount(){const e=this.getInitLinkParam();this.props.onLinkParamChange(e)}render(){const e=xe(this.props.appConfig,this.props.intl);return o.React.createElement("div",{className:"w-100"},o.React.createElement("div",{className:"mb-3 option-name"},this.props.intl.formatMessage({id:"chooseAPage",defaultMessage:j.defaultMessages.chooseAPage})),o.React.createElement("div",null,o.React.createElement(ve,{linkParam:this.props.linkParam,datas:e,onClick:this.setLinkParam,"aria-label":this.props.intl.formatMessage({id:"chooseAPage",defaultMessage:j.defaultMessages.chooseAPage})})))}}class Te extends o.React.PureComponent{constructor(){super(...arguments),this.getInitLinkParam=()=>{const e=this.props.appConfig.dialogs;if(!e||Object.keys(e).length<1)return(0,o.Immutable)({linkType:o.LinkType.Dialog,value:""});if(this.props.originLinkParam.linkType!==o.LinkType.Dialog){const e=Ce(this.props.appConfig);return(0,o.Immutable)({linkType:o.LinkType.Dialog,value:e&&e[0]&&e[0].id})}return this.props.originLinkParam},this.setLinkParam=e=>{let t=this.props.linkParam;t=t.set("value",e.id),this.props.onLinkParamChange(t)}}componentDidMount(){const e=this.getInitLinkParam();this.props.onLinkParamChange(e)}componentDidUpdate(e){if(e.appConfig!==this.props.appConfig){const e=this.getInitLinkParam();this.props.onLinkParamChange(e)}}render(){const e=Ce(this.props.appConfig);return o.React.createElement("div",{className:"w-100"},o.React.createElement("div",{className:"mb-3 option-name"},this.props.intl.formatMessage({id:"chooseADialog",defaultMessage:j.defaultMessages.chooseADialog})),o.React.createElement("div",null,e&&e.length>0&&o.React.createElement(ve,{linkParam:this.props.linkParam,datas:e,onClick:this.setLinkParam,"aria-label":this.props.intl.formatMessage({id:"chooseADialog",defaultMessage:j.defaultMessages.chooseADialog})})))}}class Pe extends o.React.PureComponent{constructor(){super(...arguments),this.getInitLinkParam=()=>{const e=O.searchUtils.getBlockAnchorPointsInPage(O.utils.getAppConfig(),O.utils.getCurrentPageId(),O.utils.getCurrentSizeMode());if(!e||e.length<1)return(0,o.Immutable)({linkType:o.LinkType.Block,value:""});if(this.props.originLinkParam.linkType!==o.LinkType.Block){const e=this.getBlockData();return(0,o.Immutable)({linkType:o.LinkType.Block,value:e&&e.some((e=>"default"===e.id))?"default":e&&e[0]&&e[0].id})}return this.props.originLinkParam},this.getBlockData=()=>{var e;return(null===(e=O.searchUtils.getBlockAnchorPointsInPage(O.utils.getAppConfig(),O.utils.getCurrentPageId(),O.utils.getCurrentSizeMode()))||void 0===e?void 0:e.sort(((e,t)=>{var i;return null===(i=e.label)||void 0===i?void 0:i.localeCompare(t.label,null===window||void 0===window?void 0:window.locale,{numeric:!0,sensitivity:"base"})}))).map((e=>({id:e.id,name:e.label})))},this.setLinkParam=e=>{let t=this.props.linkParam;t=t.set("value",e.id),this.props.onLinkParamChange(t)}}componentDidMount(){const e=this.getInitLinkParam();this.props.onLinkParamChange(e)}render(){const e=this.getBlockData();return o.React.createElement("div",{className:"w-100"},o.React.createElement("div",{className:"mb-3 option-name"},this.props.intl.formatMessage({id:"jumpTo",defaultMessage:j.defaultMessages.jumpTo})),o.React.createElement("div",null,e&&e.length>0&&o.React.createElement(ve,{linkParam:this.props.linkParam,datas:e,onClick:this.setLinkParam,"aria-label":this.props.intl.formatMessage({id:"jumpTo",defaultMessage:j.defaultMessages.jumpTo})})))}}class Re extends o.React.PureComponent{constructor(){super(...arguments),this.screenGroupLabelStyle={marginLeft:"-20px"},this.getInitLinkParam=()=>{const e=this.getScreenData();return!e||e.length<1?(0,o.Immutable)({linkType:o.LinkType.Screen,value:""}):this.props.originLinkParam.linkType!==o.LinkType.Screen?(0,o.Immutable)({linkType:o.LinkType.Screen,value:e[0].screens[0].id}):this.props.originLinkParam},this.getScreenData=()=>{var e;return null===(e=O.searchUtils.getScreenAnchorPointsInPage(O.utils.getAppConfig(),O.utils.getCurrentPageId(),O.utils.getCurrentSizeMode()))||void 0===e?void 0:e.sort(((e,t)=>{var i;return null===(i=e.label)||void 0===i?void 0:i.localeCompare(t.label,null===window||void 0===window?void 0:window.locale,{numeric:!0,sensitivity:"base"})}))},this.setLinkParam=e=>{let t=this.props.linkParam;t=t.set("value",e.target.value),this.props.onLinkParamChange(t)}}componentDidMount(){const e=this.getInitLinkParam();this.props.onLinkParamChange(e)}render(){var e;const t=this.getScreenData(),i=[];return t.forEach((e=>{i.push(o.React.createElement("option",{value:e.id,key:e.id,disabled:!0,style:this.screenGroupLabelStyle},e.label)),e.screens.forEach(((t,a)=>i.push(o.React.createElement("option",{value:t.id,key:`${e.id}-${a}`},t.label))))})),o.React.createElement("div",{className:"w-100"},o.React.createElement("div",{className:"mb-3 option-name"},this.props.intl.formatMessage({id:"jumpTo",defaultMessage:j.defaultMessages.jumpTo})),o.React.createElement("div",null,t.length>0&&o.React.createElement(j.Select,{value:null===(e=this.props.linkParam)||void 0===e?void 0:e.value,className:"w-100",onChange:this.setLinkParam,size:"sm","aria-label":this.props.intl.formatMessage({id:"jumpTo",defaultMessage:j.defaultMessages.jumpTo})},i)))}}var Me=v(30655),Ne=v.n(Me),Le=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const De=e=>{const t=window.SVG,{className:i}=e,a=Le(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:Ne()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var Ae=v(94064),Ee=v.n(Ae),Fe=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const Be=e=>{const t=window.SVG,{className:i}=e,a=Fe(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:Ee()},a)):o.React.createElement("svg",Object.assign({className:s},a))};class Ue extends o.React.PureComponent{constructor(){super(...arguments),this.onCollapseClick=e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.setState({collapse:!this.state.collapse})}}componentWillMount(){this.setState({collapse:this.props.isOpen})}render(){return o.React.createElement("div",{className:(0,o.classNames)("w-100",this.props.className)},o.React.createElement("div",{title:this.props.title,style:{overflow:"hidden"},className:"w-100 btn pb-2 pr-2 d-flex justify-content-between"},o.React.createElement("div",null,this.props.title),o.React.createElement(j.Button,{type:"tertiary",size:"sm",className:"collapse-btn py-0 jimu-outline-inside pr-0",onClick:this.onCollapseClick,"aria-label":this.props.title,"aria-expanded":this.state.collapse},this.state.collapse?o.React.createElement(De,{size:"s"}):o.React.createElement(Be,{size:"s"}))),o.React.createElement(j.Collapse,{isOpen:this.state.collapse,"aria-label":this.props.title},this.props.children))}}class ze extends o.React.PureComponent{constructor(e){super(e),this.noScroll="Do not scroll",this.getInitLinkParam=()=>{if(this.props.originLinkParam.linkType===o.LinkType.View)return this.props.originLinkParam;{let e=(0,o.Immutable)({linkType:o.LinkType.View,value:""});return ke(this.getDefaultPageOrDialogId())||(e=e.set("openType",this.getInitOpenType())),e}},this.getInitOpenType=()=>!this.props.openTypes||this.props.openTypes.includes(o.OpenTypes.CurrentWindow)?o.OpenTypes.CurrentWindow:this.props.openTypes[0],this.pageOrDialogChange=e=>{let t=this.props.linkParam;t=t.set("value",e.target.value),t=Ie(t)?t.without("openType"):t.set("openType",this.getInitOpenType()),this.props.onLinkParamChange(t)},this.viewChange=(e,t)=>{let i=[];i=Object.assign(i,this.state.viewLinkParamArr),i[0]||(i[0]=this.getDefaultPageOrDialogId());const o=this.props.appConfig.sections[t].views;let a=i.filter((t=>o.some((e=>e===t))&&t!==e)),s=[];const n=i.indexOf(e);if(n>-1?a=a.concat(i[n]):s=s.concat(e),a&&a.length>0){let e=[];a.forEach((t=>{e=e.concat(Se(t,this.props.appConfig))})),a=a.concat(e)}i=i.filter((e=>!a.some((t=>t===e)))),i=i.concat(s);let r=this.props.linkParam;r=r.set("value",i.join(",")),this.props.onLinkParamChange(r)},this.viewRemove=e=>{let t=[];t=Object.assign(t,this.state.viewLinkParamArr),t[0]||(t[0]=this.getDefaultPageOrDialogId());const i=Se(e,this.props.appConfig).concat(e);t=t.slice(0,1).concat(t.slice(1).filter((e=>!i.some((t=>t===e)))));let o=this.props.linkParam;o=o.set("value",t.join(",")),this.props.onLinkParamChange(o,!0)},this.getDefaultPageOrDialogId=()=>{const e=this.props.appConfig&&this.props.appConfig.pages,t=e&&Object.keys(e).filter((e=>fe(e,this.props.appConfig).length>0)),i=t&&t.find((t=>e[t].isDefault))||(null==t?void 0:t[0]);if(i)return i;const o=this.props.appConfig&&this.props.appConfig.dialogs,a=o&&Object.keys(o).filter((e=>ye(e,this.props.appConfig).length>0));return null==a?void 0:a[0]},this.getSelectedViewIds=()=>this.state.viewLinkParamArr.slice(1),this.state={viewLinkParamArr:[],scrollToViewId:this.noScroll}}componentDidMount(){const e=this.getInitLinkParam(),{value:t,linkType:i}=e;t&&i===o.LinkType.View?this.setState({viewLinkParamArr:t.split(",")}):this.setState({viewLinkParamArr:[]}),this.props.onLinkParamChange(e)}static getDerivedStateFromProps(e,t){const{value:i,linkType:a}=e.linkParam;return i&&a===o.LinkType.View?Object.assign(Object.assign({},t),{viewLinkParamArr:i.split(",")}):Object.assign(Object.assign({},t),{viewLinkParamArr:[]})}render(){var e,t,i;if(!this.props.appConfig)return null;const a=xe(this.props.appConfig,this.props.intl),s=Ce(this.props.appConfig);let n=this.state.viewLinkParamArr[0];a.some((e=>e.id===n))||s.some((e=>e.id===n))||(n=this.getDefaultPageOrDialogId());const r=a.filter((e=>fe(e.id,this.props.appConfig).length>0)),l=s.filter((e=>ye(e.id,this.props.appConfig).length>0));return o.React.createElement("div",{className:"w-100"},o.React.createElement("div",{className:"mb-3 option-name"},this.props.intl.formatMessage({id:"chooseViews",defaultMessage:j.defaultMessages.chooseViews})),o.React.createElement("div",null,o.React.createElement(j.Select,{value:n,onChange:this.pageOrDialogChange,className:"w-100 mb-4",size:"sm","aria-label":this.props.intl.formatMessage({id:"chooseViews",defaultMessage:j.defaultMessages.chooseViews})},o.React.createElement(j.Option,{header:!0},this.props.intl.formatMessage({id:"page",defaultMessage:o.defaultMessages.page})),r.map(((e,t)=>o.React.createElement(j.Option,{key:t,value:e.id},e.name))),l.length>0&&o.React.createElement(j.Option,{header:!0},this.props.intl.formatMessage({id:"dialog",defaultMessage:o.defaultMessages.dialog})),l.map(((e,t)=>o.React.createElement(j.Option,{key:t,value:e.id},e.name)))),o.React.createElement("div",{className:(0,o.classNames)("choose-view",{"mb-4":(null===(e=fe(n,this.props.appConfig))||void 0===e?void 0:e.length)>0})},fe(n,this.props.appConfig).map((e=>o.React.createElement($e,{sections:this.props.appConfig.sections,sectionId:e,viewsInfo:we(e,this.props.appConfig),viewLinkParamArr:this.state.viewLinkParamArr,viewChange:this.viewChange,viewRemove:this.viewRemove,key:e})))),o.React.createElement("div",{className:(0,o.classNames)("choose-view",{"mb-4":(null===(t=ye(n,this.props.appConfig))||void 0===t?void 0:t.length)>0})},ye(n,this.props.appConfig).map((e=>o.React.createElement($e,{sections:this.props.appConfig.sections,sectionId:e,viewsInfo:we(e,this.props.appConfig),viewLinkParamArr:this.state.viewLinkParamArr,viewChange:this.viewChange,viewRemove:this.viewRemove,key:e})))),o.React.createElement("div",{className:(0,o.classNames)("choose-view",{"mb-4":(null===(i=this.getSelectedViewIds())||void 0===i?void 0:i.length)>0})},this.getSelectedViewIds().map((e=>be(e,this.props.appConfig).map((e=>o.React.createElement($e,{sections:this.props.appConfig.sections,sectionId:e,viewsInfo:we(e,this.props.appConfig),viewLinkParamArr:this.state.viewLinkParamArr,viewChange:this.viewChange,viewRemove:this.viewRemove,key:e}))))))))}}class $e extends o.React.PureComponent{constructor(e){super(e),this.onViewChange=e=>{this.setState({viewId:e}),this.props.viewChange(e,this.props.sectionId)},this.state={viewId:null}}componentWillUnmount(){this.props.viewRemove(this.state.viewId)}render(){return o.React.createElement(Ue,{className:"mb-4 choose-view",title:this.props.sections[this.props.sectionId]&&this.props.sections[this.props.sectionId].label,isOpen:!0,key:this.props.sectionId},o.React.createElement("div",{className:"link-selector-list w-100 view-border border-top-0 border-left-0 border-right-0 rounded-0",role:"listbox"},this.props.viewsInfo.map(((e,t)=>o.React.createElement(j.Button,{role:"option",onClick:()=>{this.onViewChange(e.id)},key:t,className:(0,o.classNames)("jimu-outline-inside link-selector-list-item btn w-100 view-border px-2 pt-1 text-left border-bottom-0 rounded-0 text-truncate",{"item-common":!this.props.viewLinkParamArr.includes(e.id)},{"item-selected":this.props.viewLinkParamArr.includes(e.id)}),title:e.label,"aria-selected":this.props.viewLinkParamArr.includes(e.id)},e.label)))))}}var Ve=v(84845);class We extends o.React.PureComponent{constructor(e){var t;super(e),this.getInitLinkParam=()=>this.props.originLinkParam.linkType===o.LinkType.WebAddress?this.props.originLinkParam:(0,o.Immutable)({linkType:o.LinkType.WebAddress,openType:!this.props.openTypes||this.props.openTypes.includes(o.OpenTypes.NewWindow)?o.OpenTypes.NewWindow:this.props.openTypes[0],value:""}),this.webAddressInputChange=e=>{const t=e.value;let i=this.props.linkParam;i=i.set("value",t).set("expression",null),this.props.onLinkParamChange(i)},this.webAddressExpressionChange=e=>{let t=this.props.linkParam;t=t.set("expression",e).set("value",""),this.props.onLinkParamChange(t),this.closeExpPopup()},this.openExpPopup=()=>{this.setState({isExpPopupOpen:!0})},this.closeExpPopup=()=>{this.setState({isExpPopupOpen:!1})},this.getDefaultExp=()=>({name:"Expression",parts:[{type:o.ExpressionPartType.String,exp:'"https://"'}]}),this.onUrlChange=e=>{this.setState({url:e.value})},this.state={isExpPopupOpen:!1,url:(null===(t=this.props.linkParam)||void 0===t?void 0:t.linkType)===o.LinkType.WebAddress?this.props.linkParam.value:""}}componentDidMount(){const e=this.getInitLinkParam();this.props.onLinkParamChange(e)}componentDidUpdate(e){var t,i,a;(null===(t=e.linkParam)||void 0===t?void 0:t.value)!==(null===(i=this.props.linkParam)||void 0===i?void 0:i.value)&&this.setState({url:(null===(a=this.props.linkParam)||void 0===a?void 0:a.linkType)===o.LinkType.WebAddress?this.props.linkParam.value:this.state.url})}render(){const e=this.props.expressionInputTypes||(0,o.Immutable)([Ve.ExpressionInputType.Static,Ve.ExpressionInputType.Attribute,Ve.ExpressionInputType.Expression,Ve.ExpressionInputType.Arcade]);return o.React.createElement("div",{className:"w-100"},o.React.createElement("div",{className:"mb-3 option-name"},this.props.intl.formatMessage({id:"url",defaultMessage:j.defaultMessages.url})),o.React.createElement("div",null,this.props.useDataSources&&this.props.useDataSources.length>0?o.React.createElement(Ve.ExpressionInput,{useDataSources:this.props.useDataSources,onChange:this.webAddressExpressionChange,expression:this.props.linkParam&&this.props.linkParam.expression||this.getDefaultExp(),closeExpPopup:this.closeExpPopup,openExpPopup:this.openExpPopup,isExpPopupOpen:this.state.isExpPopupOpen,types:e,widgetId:this.props.widgetId,"aria-label":this.props.intl.formatMessage({id:"url",defaultMessage:j.defaultMessages.url})}):o.React.createElement(j.UrlInput,{value:this.state.url,schemes:je,onChange:this.onUrlChange,className:"w-100",onAcceptValue:this.webAddressInputChange,"aria-label":this.props.intl.formatMessage({id:"url",defaultMessage:j.defaultMessages.url})})))}}class Ge extends o.React.PureComponent{constructor(e){if(super(e),this.getLinkTypeContent=()=>{const e=this.getHiddenLinks();return this.props.isLinkPageSetting||window.isExpressBuilder?(0,o.jsx)(j.Select,{value:this.state.linkParam.linkType,size:"sm",onChange:this.linkTypeChange,className:"w-100","aria-label":this.props.intl.formatMessage({id:"linkTo",defaultMessage:j.defaultMessages.linkTo})},!e.some((e=>e===o.LinkType.WebAddress))&&(0,o.jsx)("option",{value:o.LinkType.WebAddress},this.props.intl.formatMessage({id:"url",defaultMessage:j.defaultMessages.url})),!e.some((e=>e===o.LinkType.None))&&(0,o.jsx)("option",{value:o.LinkType.None},this.props.intl.formatMessage({id:"none",defaultMessage:j.defaultMessages.none}))):(0,o.jsx)(j.Select,{value:this.state.linkParam.linkType,size:"sm",onChange:this.linkTypeChange,className:"w-100","aria-label":this.props.intl.formatMessage({id:"linkTo",defaultMessage:j.defaultMessages.linkTo})},!e.some((e=>e===o.LinkType.None))&&(0,o.jsx)("option",{value:o.LinkType.None},this.props.intl.formatMessage({id:"none",defaultMessage:j.defaultMessages.none})),!e.some((e=>e===o.LinkType.Page))&&(0,o.jsx)("option",{value:o.LinkType.Page},this.props.intl.formatMessage({id:"page",defaultMessage:o.defaultMessages.page})),!e.some((e=>e===o.LinkType.View))&&(0,o.jsx)("option",{value:o.LinkType.View},this.props.intl.formatMessage({id:"view",defaultMessage:o.defaultMessages.view})),!e.some((e=>e===o.LinkType.Dialog))&&(0,o.jsx)("option",{value:o.LinkType.Dialog},this.props.intl.formatMessage({id:"dialog",defaultMessage:o.defaultMessages.dialog})),!e.some((e=>e===o.LinkType.WebAddress))&&(0,o.jsx)("option",{value:o.LinkType.WebAddress},this.props.intl.formatMessage({id:"url",defaultMessage:j.defaultMessages.url})),!e.some((e=>e===o.LinkType.Block))&&(0,o.jsx)("option",{value:o.LinkType.Block},this.props.intl.formatMessage({id:"block",defaultMessage:o.defaultMessages.block})),!e.some((e=>e===o.LinkType.PageTop))&&(0,o.jsx)("option",{value:o.LinkType.PageTop},this.props.intl.formatMessage({id:"pageTop",defaultMessage:j.defaultMessages.pageTop})),!e.some((e=>e===o.LinkType.PrintPreview))&&(0,o.jsx)("option",{value:o.LinkType.PrintPreview},this.props.intl.formatMessage({id:"printPreview",defaultMessage:j.defaultMessages.printPreview})),!e.some((e=>e===o.LinkType.CookieBanner))&&(0,o.jsx)("option",{value:o.LinkType.CookieBanner},this.props.intl.formatMessage({id:"cookieBanner",defaultMessage:j.defaultMessages.cookieBanner})))},this.getHiddenLinks=()=>{var e,t,i,a,s,n;let r=this.props.hiddenLinks||(0,o.Immutable)([]);const l=O.utils.getCurrentPageId(),c=O.utils.getAppConfig(),d=null===(e=c.pages)||void 0===e?void 0:e[l],p=O.searchUtils.findLayoutId(null==d?void 0:d.layout,O.utils.getCurrentSizeMode(),c.mainSizeMode),u=c.layouts[p],m=(null===(t=null===window||void 0===window?void 0:window.jimuConfig)||void 0===t?void 0:t.isBuilder)?null===(a=null===(i=(0,o.getAppStore)().getState().appStateInBuilder)||void 0===i?void 0:i.appRuntimeInfo)||void 0===a?void 0:a.currentDialogId:null===(s=(0,o.getAppStore)().getState().appRuntimeInfo)||void 0===s?void 0:s.currentDialogId;return((null==u?void 0:u.type)===o.LayoutType.FixedLayout||m)&&(r=r.concat([o.LinkType.Block,o.LinkType.Screen,o.LinkType.PageTop])),(null===(n=null==c?void 0:c.cookieBanner)||void 0===n?void 0:n.enable)||(r=r.concat([o.LinkType.CookieBanner])),r},this.getLinkContent=e=>{switch(e){case o.LinkType.None:return null;case o.LinkType.Page:return(0,o.jsx)(Oe,{originLinkParam:this.state.originLinkParam,linkParam:this.state.linkParam,appConfig:this.props.appConfig,onLinkParamChange:this.linkParamChange,intl:this.props.intl,openTypes:this.props.openTypes});case o.LinkType.Dialog:return(0,o.jsx)(Te,{originLinkParam:this.state.originLinkParam,linkParam:this.state.linkParam,appConfig:this.props.appConfig,onLinkParamChange:this.linkParamChange,intl:this.props.intl});case o.LinkType.Block:return(0,o.jsx)(Pe,{originLinkParam:this.state.originLinkParam,linkParam:this.state.linkParam,onLinkParamChange:this.linkParamChange,intl:this.props.intl});case o.LinkType.Screen:return(0,o.jsx)(Re,{originLinkParam:this.state.originLinkParam,linkParam:this.state.linkParam,onLinkParamChange:this.linkParamChange,intl:this.props.intl});case o.LinkType.View:return(0,o.jsx)(ze,{originLinkParam:this.state.originLinkParam,linkParam:this.state.linkParam,intl:this.props.intl,openTypes:this.props.openTypes,appConfig:this.props.appConfig,onLinkParamChange:this.linkParamChange,browserSizeMode:this.props.browserSizeMode});case o.LinkType.WebAddress:return(0,o.jsx)(We,{originLinkParam:this.state.originLinkParam,linkParam:this.state.linkParam,intl:this.props.intl,onLinkParamChange:this.linkParamChange,useDataSources:this.props.useDataSources,openTypes:this.props.openTypes,widgetId:this.props.widgetId,expressionInputTypes:this.props.expressionInputTypes});default:return null}},this.linkTypeChange=e=>{const t=e.target.value;let i=(0,o.Immutable)(this.state.linkParam);[o.LinkType.None,o.LinkType.PageTop,o.LinkType.CookieBanner,o.LinkType.PrintPreview].includes(t)&&(i=(0,o.Immutable)({})),i=i.set("linkType",t),this.needOpenIn(i)||(i=i.without("openType")),this.setState({linkParam:i})},this.radioOpenTypeChange=e=>{let t=(0,o.Immutable)(this.state.linkParam);t=t.set("openType",e),this.setState({linkParam:t})},this.linkParamChange=(e,t)=>{t?e&&this.state.linkParam&&e.linkType===this.state.linkParam.linkType&&this.setState({linkParam:this.fixLinkParam(e)}):this.setState({linkParam:this.fixLinkParam(e)})},this.fixLinkParam=e=>{var t;let i=e;if((null==e?void 0:e.linkType)===o.LinkType.View&&(null==e?void 0:e.value)){const o=null===(t=this.props.appConfig)||void 0===t?void 0:t.views,a=e.value.split(","),s=a.slice(1).filter((e=>null==o?void 0:o[e])),n=[a[0]].concat(s).join(",");i=i.set("value",n)}return i},this.settingConfirm=()=>{const e=(0,o.Immutable)(this.state.linkParam);this.setState({originLinkParam:e}),this.props.onSettingConfirm(e)},this.isLinkParamOk=e=>{if(!e||!e.linkType)return!1;if(e.linkType===o.LinkType.View){const t=e.value&&e.value.split(",")[0]||null,i=e.value&&e.value.split(",").slice(1)||[];return!!(t&&"string"==typeof t&&i.length>0)}if(e.linkType===o.LinkType.WebAddress){if(this.props.useDataSources&&this.props.useDataSources.length>0){const t=e.expression&&e.expression.parts;let i=!1;return t&&t.length>0&&(i=1!==t.length||!!t[0].exp&&'""'!==t[0].exp),i}{const t="valid"!==o.urlUtils.checkAbsoluteUrl(e.value,je);return e.value&&!t}}return e.linkType===o.LinkType.PageTop||e.linkType===o.LinkType.PrintPreview||e.linkType===o.LinkType.None||e.linkType===o.LinkType.CookieBanner||!(!e.value||"string"!=typeof e.value)},this.props.linkParam&&this.props.linkParam.linkType)this.state={linkParam:(0,o.Immutable)(this.props.linkParam),originLinkParam:(0,o.Immutable)(this.props.linkParam)};else{const e={linkType:o.LinkType.None,openType:!this.props.openTypes||this.props.openTypes.includes(o.OpenTypes.CurrentWindow)?o.OpenTypes.CurrentWindow:this.props.openTypes[0]};this.state={linkParam:(0,o.Immutable)(e),originLinkParam:(0,o.Immutable)(e)}}}needOpenIn(e){if(!e)return!0;return![o.LinkType.Dialog,o.LinkType.Block,o.LinkType.Screen,o.LinkType.PageTop,o.LinkType.PrintPreview,o.LinkType.CookieBanner].some((t=>t===e.linkType))&&!Ie(e)}render(){if(this.props.appConfig){const e=this.getLinkTypeContent(),t=this.getLinkContent(this.state.linkParam.linkType);return(0,o.jsx)("div",{className:(0,o.classNames)(this.props.className,"w-100 h-100",{[g.Theme2GlobalStyleClassName]:this.context,[g.ThemeGlobalStyleClassName]:!this.context})},(0,o.jsx)("div",{className:"widget-builder-link-selector w-100 h-100"},(0,o.jsx)("div",{style:{position:"relative"},className:"w-100 h-100"},(0,o.jsx)(j.Container,null,(0,o.jsx)(j.Row,{className:"mb-3 option-name"},this.props.intl.formatMessage({id:"linkTo",defaultMessage:j.defaultMessages.linkTo})),(0,o.jsx)(j.Row,{className:"mb-4"},e),this.state.linkParam.linkType!==o.LinkType.None?(0,o.jsx)("div",null,(0,o.jsx)(j.Row,{className:"mb-4"},t),this.needOpenIn(this.state.linkParam)&&(0,o.jsx)("div",null,(0,o.jsx)(j.Row,{className:"mb-3 option-name"},this.props.intl.formatMessage({id:"openIn",defaultMessage:j.defaultMessages.openIn})),(0,o.jsx)(j.Row,{role:"radiogroup",className:"p-0","aria-label":this.props.intl.formatMessage({id:"openIn",defaultMessage:j.defaultMessages.openIn})},(!this.props.openTypes||this.props.openTypes.some((e=>e===o.OpenTypes.CurrentWindow)))&&(0,o.jsx)(j.Label,{className:"link-setting-cursor-pointer open-type-label mb-6 d-flex align-items-center"},(0,o.jsx)(j.Radio,{name:"openIn",className:"mr-2",onChange:()=>{this.radioOpenTypeChange(o.OpenTypes.CurrentWindow)},checked:this.state.linkParam.openType===o.OpenTypes.CurrentWindow}),this.props.intl.formatMessage({id:"appWindow",defaultMessage:j.defaultMessages.appWindow})),(!this.props.openTypes||this.props.openTypes.some((e=>e===o.OpenTypes.TopWindow)))&&(0,o.jsx)(j.Label,{className:"link-setting-cursor-pointer open-type-label mb-6 d-flex align-items-center"},(0,o.jsx)(j.Radio,{name:"openIn",className:"mr-2",onChange:()=>{this.radioOpenTypeChange(o.OpenTypes.TopWindow)},checked:this.state.linkParam.openType===o.OpenTypes.TopWindow}),this.props.intl.formatMessage({id:"topWindow",defaultMessage:j.defaultMessages.topWindow})),(!this.props.openTypes||this.props.openTypes.some((e=>e===o.OpenTypes.NewWindow)))&&(0,o.jsx)(j.Label,{className:"link-setting-cursor-pointer open-type-label mb-6 d-flex align-items-center"},(0,o.jsx)(j.Radio,{name:"openIn",className:"mr-2",onChange:()=>{this.radioOpenTypeChange(o.OpenTypes.NewWindow)},checked:this.state.linkParam.openType===o.OpenTypes.NewWindow}),this.props.intl.formatMessage({id:"newWindow",defaultMessage:j.defaultMessages.newWindow}))))):null),(0,o.jsx)("div",{className:"w-100 link-setting-ok-btn-container",style:{position:"absolute"}},(0,o.jsx)(j.Button,{className:"w-100 link-setting-ok-btn",type:"primary",onClick:this.settingConfirm,disabled:!this.isLinkParamOk(this.state.linkParam),title:this.props.intl.formatMessage({id:"ok",defaultMessage:o.defaultMessages.ok})},(0,o.jsx)("div",{className:"text-truncate"},this.props.intl.formatMessage({id:"ok",defaultMessage:o.defaultMessages.ok})))))))}return null}componentDidMount(){this.props.isLinkPageSetting&&this.linkTypeChange({target:{value:o.LinkType.WebAddress}})}}Ge.contextType=g.UseTheme2Context;const He=o.ReactRedux.connect((e=>{var t,i;return{appConfig:window&&window.jimuConfig&&window.jimuConfig.isBuilder?null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig:e.appConfig,browserSizeMode:window&&window.jimuConfig&&window.jimuConfig.isBuilder?null===(i=e.appStateInBuilder)||void 0===i?void 0:i.browserSizeMode:e.browserSizeMode}}))((0,o.injectIntl)((0,g.withStyles)(Ge,"LinkSelectorContent"))),_e=He;var Je=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const Ke={rootBoundary:"viewport"};class qe extends o.React.PureComponent{constructor(){super(...arguments),this.closeBtnRef=o.React.createRef(),this.popperRef=o.React.createRef(),this.handleDocumentMousedown=e=>{if(this.props.isOpen){const t=e.target;(!this.props.trigger||(Array.isArray(this.props.trigger)?!this.props.trigger.some((e=>!(0,j.isOutBoundary)(t,e))):(0,j.isOutBoundary)(t,this.props.trigger)))&&this.toggle()}},this.toggle=()=>{this.props.toggle()},this.keepFocusAfterClose=()=>{setTimeout((()=>{this.props.backToFocusNode?(0,o.focusElementInKeyboardMode)(this.props.backToFocusNode):Array.isArray(this.props.trigger)?(0,o.focusElementInKeyboardMode)(this.props.trigger[0]):(0,o.focusElementInKeyboardMode)(this.props.trigger)}),200)},this.onKeyDown=e=>{var t;if("Esc"===e.key||"Escape"===e.key){if(!(null===(t=this.popperRef.current)||void 0===t?void 0:t.contains(e.target)))return;e.target===this.closeBtnRef.current?this.toggle():(0,o.focusElementInKeyboardMode)(this.closeBtnRef.current)}}}componentDidMount(){var e;null===(e=this.getReference(this.props.position))||void 0===e||e.addEventListener("mousedown",this.handleDocumentMousedown,!1)}componentDidUpdate(e){var t;const i="left"===this.props.position&&e.leftSidebarCollapse&&!this.props.leftSidebarCollapse||"right"===this.props.position&&e.rightSidebarCollapse&&!this.props.rightSidebarCollapse,o=this.props.widgetId&&this.props.layoutSelection!==e.layoutSelection&&(null===(t=O.searchUtils.findLayoutItem(O.utils.getAppConfig(),this.props.layoutSelection))||void 0===t?void 0:t.widgetId)!==this.props.widgetId,a=!e.isTemplatePage&&this.props.isTemplatePage;(i||o||a)&&this.props.isOpen&&this.toggle(),e.isOpen&&!this.props.isOpen&&this.keepFocusAfterClose()}componentWillUnmount(){var e;null===(e=this.getReference(this.props.position))||void 0===e||e.removeEventListener("mousedown",this.handleDocumentMousedown,!1)}getReference(e){return"left"===e?document&&document.querySelector('[data-layoutid="left-sidebar-left-layout"]'):document&&document.querySelector('[data-layoutid="right-sidebar-right-layout"]')}getPlacement(e){return"left"===e?"right-start":"left-start"}render(){const e=this.props,{isOpen:t,position:i,className:a,dispatch:s,leftSidebarCollapse:n,rightSidebarCollapse:r,trigger:l,backToFocusNode:c,widgetId:d,layoutSelection:p,title:u,isTemplatePage:m,addFocusableContainerClass:g}=e,h=Je(e,["isOpen","position","className","dispatch","leftSidebarCollapse","rightSidebarCollapse","trigger","backToFocusNode","widgetId","layoutSelection","title","isTemplatePage","addFocusableContainerClass"]);return(0,o.jsx)(j.Popper,Object.assign({reference:this.getReference(i),placement:this.getPlacement(i),open:t,forceLatestFocusElements:!0,autoUpdate:!0,className:(0,o.classNames)("bg-light-300",a),shiftOptions:Ke},h,{toggle:null,onKeyDown:this.onKeyDown,"aria-label":"string"==typeof this.props["aria-label"]?this.props["aria-label"]:"string"==typeof u?u:void 0}),(0,o.jsx)("div",{className:"w-100 h-100",ref:this.popperRef},void 0!==u&&(0,o.jsx)(j.PanelHeader,{title:u,showClose:!0,onClose:this.toggle,level:1,className:(0,o.classNames)("p-4",{[j.FOCUSABLE_CONTAINER_CLASS]:g}),closeButtonRef:this.closeBtnRef}),void 0!==u?(0,o.jsx)("div",{css:o.css`height: calc(100% - 56px); overflow: auto;`},this.props.children):this.props.children))}}const Xe=o.ReactRedux.connect(((e,t)=>{var i,o,a,s,n,r,l,c,d,p;return{leftSidebarCollapse:null===(o=null===(i=e.widgetsState)||void 0===i?void 0:i["left-sidebar"])||void 0===o?void 0:o.collapse,rightSidebarCollapse:null===(s=null===(a=e.widgetsState)||void 0===a?void 0:a["right-sidebar"])||void 0===s?void 0:s.collapse,layoutSelection:t.widgetId?(null===(n=null===window||void 0===window?void 0:window.jimuConfig)||void 0===n?void 0:n.isBuilder)?null===(l=null===(r=e.appStateInBuilder)||void 0===r?void 0:r.appRuntimeInfo)||void 0===l?void 0:l.selection:null===(c=e.appRuntimeInfo)||void 0===c?void 0:c.selection:null,isTemplatePage:(null===(d=null===window||void 0===window?void 0:window.jimuConfig)||void 0===d?void 0:d.isBuilder)&&"template"===(null===(p=e.appRuntimeInfo)||void 0===p?void 0:p.currentPageId)}}))((0,g.withStyles)(qe,"SidePopper"));class Ye extends o.React.PureComponent{constructor(){super(...arguments),this.close=()=>{this.props.onSettingCancel()},this.getIsOpen=()=>this.props.isOpen||this.props.showDialog}render(){const e=this.props.position||"right",{title:t}=this.props;return o.React.createElement(Xe,{isOpen:this.getIsOpen(),position:e,toggle:this.close,trigger:this.props.trigger,backToFocusNode:this.props.backToFocusNode,widgetId:this.props.widgetId,title:this.props.intl.formatMessage({id:t?"setLinkForTitle":"setLink",defaultMessage:t?j.defaultMessages.setLinkForTitle:j.defaultMessages.setLink},{title:t})},o.React.createElement("div",{className:"bg-default w-100 h-100 px-4"},o.React.createElement(He,{isLinkPageSetting:this.props.isLinkPageSetting,linkParam:this.props.linkParam,onSettingConfirm:this.props.onSettingConfirm,useDataSources:this.props.useDataSources,widgetId:this.props.widgetId,hiddenLinks:this.props.hiddenLinks,openTypes:this.props.openTypes,expressionInputTypes:this.props.expressionInputTypes})))}}const Qe=(0,o.injectIntl)((0,g.withTheme)(Ye)),Ze=Qe;var et=v(76490),tt=v.n(et),it=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const ot=e=>{const t=window.SVG,{className:i}=e,a=it(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:tt()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var at=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};class st extends o.React.PureComponent{constructor(e){super(e),this.linkSelectorTrigger=o.React.createRef(),this.toggle=()=>{const e=!this.state.isOpen;this.setState({isOpen:e},(()=>{this.setState({renderPopper:e})}))},this.onCancel=()=>{var e,t;null===(t=(e=this.props).onSettingCancel)||void 0===t||t.call(e),this.toggle()},this.onConfirm=e=>{var t,i;null===(i=(t=this.props).onSettingConfirm)||void 0===i||i.call(t,e),this.toggle()},this.getIsOpen=()=>this.state.isOpen&&!o.urlUtils.getAppIdPageIdFromUrl().pageId,this.state={isOpen:!1,renderPopper:!1}}render(){const e=this.props,{theme:t,intl:i,buttonLabel:a}=e,s=at(e,["theme","intl","buttonLabel"]),n=a||this.props.intl.formatMessage({id:"setLink",defaultMessage:j.defaultMessages.setLink});return o.React.createElement(o.React.Fragment,null,o.React.createElement(j.Button,{className:"w-100 text-overlay",type:"primary",onClick:this.toggle,ref:this.linkSelectorTrigger,title:n},o.React.createElement("div",{className:"w-100 px-2 text-truncate"},o.React.createElement(ot,{className:"text-overlay mr-1"}),n)),this.state.renderPopper&&o.React.createElement(Qe,Object.assign({},s,{isOpen:this.getIsOpen(),position:"right",onSettingCancel:this.onCancel,onSettingConfirm:this.onConfirm,trigger:this.linkSelectorTrigger.current,widgetId:this.props.widgetId})))}}const nt=(0,g.withTheme)((0,o.injectIntl)(st));var rt=v(13089),lt=function(e,t,i,o){return new(i||(i=Promise))((function(a,s){function n(e){try{l(o.next(e))}catch(e){s(e)}}function r(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,r)}l((o=o.apply(e,t||[])).next())}))};function ct(){return lt(this,void 0,void 0,(function*(){const e=yield dt(),t=yield pt(),i={};return Object.keys(e).forEach((t=>{i[t]||(i[t]={items:[],isPremium:e[t].isPremium,isSubscriber:e[t].isSubscriber}),i[t].items=i[t].items.concat(e[t].dataSources.map((e=>({label:o.dataSourceUtils.getLabelFromArcGISServiceUrl(t),id:e.id}))))})),Object.keys(t).forEach((e=>{i[e]||(i[e]={items:[],isPremium:t[e].isPremium,isSubscriber:t[e].isSubscriber}),i[e].items=i[e].items.concat(t[e].utilities.map((e=>{const t=o.UtilityManager.getInstance().getUtilityJson(e.utilityId);return{label:(null==t?void 0:t.label)||(null==t?void 0:t.name)||(null==t?void 0:t.sourceLabel),id:e.utilityId}})))})),i}))}function dt(){return lt(this,void 0,void 0,(function*(){var e,t,i,a,s;const n=window.jimuConfig.isBuilder?null===(i=null===(t=null===(e=(0,o.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===i?void 0:i.dataSources:null===(s=null===(a=(0,o.getAppStore)().getState())||void 0===a?void 0:a.appConfig)||void 0===s?void 0:s.dataSources,r=[];return n&&Object.keys(n).forEach((e=>{const t=o.DataSourceManager.getInstance().getDataSource(e);r.push(ut(t))})),Promise.allSettled(r).then((e=>{let t={};return e.filter((e=>"fulfilled"===e.status)).map((e=>e.value)).forEach((e=>{e&&Object.keys(e).forEach((i=>{t[i]?t[i].dataSources=t[i].dataSources.concat(e[i].dataSources):t=Object.assign(Object.assign({},t),e)}))})),t}))}))}function pt(){return lt(this,void 0,void 0,(function*(){var e,t,i,a;const s=null===(a=null===(i=null===(t=null===(e=(0,o.getAppStore)())||void 0===e?void 0:e.getState())||void 0===t?void 0:t.appStateInBuilder)||void 0===i?void 0:i.appConfig)||void 0===a?void 0:a.utilities,n=[];return s&&Object.keys(s).forEach((e=>{n.push(function(e){return lt(this,void 0,void 0,(function*(){var t,i,a,s;const n={};if(!e)return n;const r=null===(s=null===(a=null===(i=null===(t=(0,o.getAppStore)())||void 0===t?void 0:t.getState())||void 0===i?void 0:i.appStateInBuilder)||void 0===a?void 0:a.appConfig)||void 0===s?void 0:s.widgets,l=r&&Object.values(r).some((t=>{var i;return null===(i=t.useUtilities)||void 0===i?void 0:i.some((t=>t.utilityId===e.id))})),c=e.url;if(c&&l){const t=yield o.proxyUtils.isUtilityPremium(e),i=yield o.proxyUtils.isUtilitySubscriber(e);if(t||i){const a=yield o.UtilityManager.getInstance().getUtility(e.id);n[c]={utilities:[a],isPremium:t,isSubscriber:i}}}return n}))}(s[e]))})),Promise.allSettled(n).then((e=>{let t={};return e.filter((e=>"fulfilled"===e.status)).map((e=>e.value)).forEach((e=>{e&&Object.keys(e).forEach((i=>{t[i]?t[i].utilities=t[i].utilities.concat(e[i].utilities):t=Object.assign(Object.assign({},t),e)}))})),t}))}))}function ut(e){return lt(this,arguments,void 0,(function*(e,t=!1){var i,a,s,n,r,l,c;const d={};if(!e)return d;e.isDataSourceSet()&&!e.areChildDataSourcesCreated()&&(yield e.childDataSourcesReady());const p=window.jimuConfig.isBuilder?null===(s=null===(a=null===(i=(0,o.getAppStore)().getState())||void 0===i?void 0:i.appStateInBuilder)||void 0===a?void 0:a.appConfig)||void 0===s?void 0:s.widgets:null===(r=null===(n=(0,o.getAppStore)().getState())||void 0===n?void 0:n.appConfig)||void 0===r?void 0:r.widgets,u=(null===(l=e.getMainDataSource())||void 0===l?void 0:l.id)===e.id,m=rt.dataComponentsUtils.getWidgetsUsingDsOrItsViews(e.id,p,!1).length>0,g=o.dataSourceUtils.getFullArcGISServiceUrl(null===(c=e.getDataSourceJson())||void 0===c?void 0:c.url,!1);if(u&&g&&(t||m)){const t=yield o.proxyUtils.isDataSourcePremium(e.getDataSourceJson()),i=yield o.proxyUtils.isDataSourceSubscriber(e.getDataSourceJson());(t||i)&&(d[g]={dataSources:[e],isPremium:t,isSubscriber:i})}const h=[];if(u&&e.isDataSourceSet()){const i=(e.type===o.AllDataSourceTypes.WebMap||e.type===o.AllDataSourceTypes.WebScene)&&m||t;e.getChildDataSources().forEach((e=>{h.push(ut(e,i))}))}return Promise.allSettled(h).then((e=>{let t=d;return e.filter((e=>"fulfilled"===e.status)).map((e=>e.value)).forEach((e=>{e&&Object.keys(e).forEach((i=>{t[i]?t[i].dataSources=t[i].dataSources.concat(e[i].dataSources):t=Object.assign(Object.assign({},t),e)}))})),t}))}))}function mt(e,t){var i;if(!e||!t)return null;let o=null;for(const a in t)if((null===(i=t[a])||void 0===i?void 0:i.sourceUrl)===e){o=t[a];break}return o}function gt(e,t,i,o){if(!e||!t)return!1;if(!(e.sourceUrl===t))return!1;if(!(!e.hitsPerInterval&&!i||e.hitsPerInterval===i))return!1;return!((e.intervalSeconds||o)&&e.intervalSeconds!==o)}function ht(){var e,t;const i=null===(e=(0,o.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder.appInfo;return null===(t=null==i?void 0:i.typeKeywords)||void 0===t?void 0:t.includes("Registered App")}function vt(){return lt(this,void 0,void 0,(function*(){var e,t,i,a,s,n,r,l,c,d;if(!(!(null===(i=null===(t=null===(e=(0,o.getAppStore)().getState())||void 0===e?void 0:e.appContext)||void 0===t?void 0:t.jimuConfig)||void 0===i?void 0:i.isInPortal)&&!(null===(n=null===(s=null===(a=(0,o.getAppStore)().getState())||void 0===a?void 0:a.appContext)||void 0===s?void 0:s.jimuConfig)||void 0===n?void 0:n.isDevEdition)))return yield Promise.resolve(!1);const p=ht();let u=!1;if(!p){const e=null===(r=(0,o.getAppStore)().getState())||void 0===r?void 0:r.appStateInBuilder.appInfo,t=null===(d=null===(c=null===(l=(0,o.getAppStore)().getState())||void 0===l?void 0:l.appStateInBuilder)||void 0===c?void 0:c.user)||void 0===d?void 0:d.username;u=(null==e?void 0:e.owner)===t}if(!(p||u))return yield Promise.resolve(!1);const m=yield ct(),g=Object.keys(m).map((e=>lt(this,void 0,void 0,(function*(){return yield o.ServiceManager.getInstance().fetchServiceInfo(e).then((e=>e.isHostedInSamePortal))}))));return Promise.allSettled(g).then((e=>e.filter((e=>"fulfilled"===e.status)).map((e=>e.value)))).then((e=>(null==e?void 0:e.length)>0&&(null==e?void 0:e.some((e=>e)))))}))}function ft(e,t){return lt(this,void 0,void 0,(function*(){if(!e||0===e.length||!t)return void(yield Promise.resolve());const i=wt();yield o.esri.restRequest.request(i,{authentication:o.SessionManager.getInstance().getSessionByUrl((0,o.getAppStore)().getState().portalUrl),httpMethod:"POST",params:{proxies:e.join()}}).then((e=>lt(this,void 0,void 0,(function*(){var i;return e.results&&Object.values(e.results).forEach((e=>{e.success&&yt(e.proxyId,t)})),null==t||t.exec(),(null===(i=e.results)||void 0===i?void 0:i.every((e=>!0===e.success)))?Promise.resolve():Promise.reject(new Error(`Deleting existing proxy failed: ${JSON.stringify(e)}`))})))).catch((i=>lt(this,void 0,void 0,(function*(){return e.forEach((e=>{yt(e,t)})),null==t||t.exec(),Promise.reject(new Error(`Deleting existing proxy failed: ${JSON.stringify(i)}`))}))))}))}function yt(e,t){var i,a,s;const n=null===(s=null===(a=null===(i=(0,o.getAppStore)().getState())||void 0===i?void 0:i.appStateInBuilder)||void 0===a?void 0:a.appConfig)||void 0===s?void 0:s.appProxies,r=n&&Object.values(n).find((t=>t.proxyId===e));r&&(null==t||t.removeAppProxy(r.id))}function St(){var e,t,i,a,s,n,r;const l=null===(t=null===(e=(0,o.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.portalUrl,c=null===(a=null===(i=(0,o.getAppStore)().getState())||void 0===i?void 0:i.appStateInBuilder)||void 0===a?void 0:a.appId;return`${l}/sharing/rest/content/users/${null===(r=null===(n=null===(s=(0,o.getAppStore)().getState())||void 0===s?void 0:s.appStateInBuilder)||void 0===n?void 0:n.appInfo)||void 0===r?void 0:r.owner}/items/${c}`}function bt(){return`${St()}/createProxies`}function wt(){return`${St()}/deleteProxies`}var xt=v(56499),Ct=v.n(xt),It=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const kt=e=>{const t=window.SVG,{className:i}=e,a=It(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:Ct()},a)):o.React.createElement("svg",Object.assign({className:s},a))};class jt extends o.React.PureComponent{constructor(e){super(e),this.__unmount=!1,this.interval={none:this.props.intl.formatMessage({id:"intervalNone",defaultMessage:j.defaultMessages.intervalNone}),second:this.props.intl.formatMessage({id:"intervalSecond",defaultMessage:j.defaultMessages.intervalSecond}),minute:this.props.intl.formatMessage({id:"intervalMinute",defaultMessage:j.defaultMessages.intervalMinute}),hour:this.props.intl.formatMessage({id:"intervalHour",defaultMessage:j.defaultMessages.intervalHour}),day:this.props.intl.formatMessage({id:"intervalDay",defaultMessage:j.defaultMessages.intervalDay})},this.setIsHostedInSamePortal=()=>{this.props.sourceUrl&&o.ServiceManager.getInstance().fetchServiceInfo(this.props.sourceUrl).then((e=>{this.__unmount||this.setState({isHostedInSamePortal:e.isHostedInSamePortal})}))},this.onToggleProxy=()=>{let e;e=this.props.proxySettingConfig?null:(0,o.Immutable)({sourceUrl:this.props.sourceUrl}),this.props.onChange(this.props.sourceUrl,e)},this.onHitsPerIntervalChange=e=>{const t=e,i={sourceUrl:this.props.sourceUrl,hitsPerInterval:t},o=this.props.proxySettingConfig?Object.assign(Object.assign({},this.props.proxySettingConfig),i):i;this.props.onChange(this.props.sourceUrl,o)},this.onIntervalUnitChange=e=>{const t=e.target.value,i=this.getIntervalSeconds(t),o={sourceUrl:this.props.sourceUrl,intervalSeconds:i},a=this.props.proxySettingConfig?Object.assign(Object.assign({},this.props.proxySettingConfig),o):o;this.props.onChange(this.props.sourceUrl,a)},this.state={isHostedInSamePortal:!0}}componentDidMount(){this.__unmount=!1,this.setIsHostedInSamePortal()}componentDidUpdate(e){this.__unmount=!1,e.sourceUrl!==this.props.sourceUrl&&this.setIsHostedInSamePortal()}componentWillUnmount(){this.__unmount=!0}getIntervalUnit(e){if(!e)return"none";switch(e){case 1:return"second";case 60:return"minute";case 3600:return"hour";case 86400:return"day";default:return"none"}}getIntervalSeconds(e){if(!e)return null;switch(e){case"second":return 1;case"minute":return 60;case"hour":return 3600;case"day":return 86400;default:return null}}render(){var e,t;if(!this.props.sourceUrl)return null;const i=this.props.label,a=!!this.props.proxySettingConfig,s=this.getIntervalUnit(null===(e=this.props.proxySettingConfig)||void 0===e?void 0:e.intervalSeconds),n=o.SessionManager.getInstance().getMainSession(),r=`${this.props.sourceUrl}?token=${n.token}`;return o.React.createElement("tr",{className:"row m-0 content-table-tr"},o.React.createElement("td",{className:"col-2",title:this.state.isHostedInSamePortal?null:this.props.intl.formatMessage({id:"disabledProxyTooltip",defaultMessage:j.defaultMessages.disabledProxyTooltip})},o.React.createElement(j.Switch,{onChange:this.onToggleProxy,checked:a,className:"mr-2",disabled:!this.state.isHostedInSamePortal,"aria-label":this.props.intl.formatMessage({id:"authorized",defaultMessage:j.defaultMessages.authorized}),"aria-checked":a})),o.React.createElement("td",{className:"col-4",title:i},o.React.createElement(j.Link,{to:r,target:"_blank",className:"font-size-13 px-0 text-truncate d-block text-left","aria-label":this.props.intl.formatMessage({id:"subscriberContent",defaultMessage:j.defaultMessages.subscriberContent})},i)),o.React.createElement("td",{className:"col-2"},this.props.isPremium&&o.React.createElement(kt,{size:"m"})),o.React.createElement("td",{className:"col-2"},a&&o.React.createElement(j.NumericInput,{size:"sm",value:null===(t=this.props.proxySettingConfig)||void 0===t?void 0:t.hitsPerInterval,onChange:this.onHitsPerIntervalChange,precision:0,min:1,className:"request-limit","aria-label":this.props.intl.formatMessage({id:"requestLimit",defaultMessage:j.defaultMessages.requestLimit})})),o.React.createElement("td",{className:"col-2"},a&&o.React.createElement(j.Select,{value:s,onChange:this.onIntervalUnitChange,size:"sm",className:"request-interval","aria-label":this.props.intl.formatMessage({id:"requestInterval",defaultMessage:j.defaultMessages.requestInterval})},Object.keys(this.interval).map(((e,t)=>o.React.createElement("option",{value:e,key:t,selected:e===s},this.interval[e]))))))}}const Ot=o.dataSourceUtils.dataSourceJsonCreator;class Tt extends o.React.PureComponent{constructor(){super(...arguments),this.columnName={authorized:this.props.intl.formatMessage({id:"authorized",defaultMessage:j.defaultMessages.authorized}),subscriberContent:this.props.intl.formatMessage({id:"subscriberContent",defaultMessage:j.defaultMessages.subscriberContent}),credits:this.props.intl.formatMessage({id:"credits",defaultMessage:j.defaultMessages.credits}),requestLimit:this.props.intl.formatMessage({id:"requestLimit",defaultMessage:j.defaultMessages.requestLimit}),requestInterval:this.props.intl.formatMessage({id:"requestInterval",defaultMessage:j.defaultMessages.requestInterval})},this.onProxyChange=(e,t)=>{const i=this.props.proxySettingConfigs||{},a=Object.assign({},i),s=Ot.getDataSourceTypeFromArcGISWholeServiceUrl(e)===o.DataSourceTypes.SceneService;if(t){if(a[e]=t,s){const i=e.replace("/SceneServer","/FeatureServer"),o=Object.assign(Object.assign({},t),{sourceUrl:i});a[i]=o}}else if(delete a[e],s){delete a[e.replace("/SceneServer","/FeatureServer")]}this.props.onChange(a)}}render(){const e=this.props.needProxyItems,t=this.props.proxySettingConfigs;return o.React.createElement("div",{className:(0,o.classNames)("h-100 w-100 bg-light-300",{[this.props.className]:!!this.props.className})},o.React.createElement("div",{className:"subscriber-warning"},!this.props.appHasBeenSaved&&o.React.createElement("div",null,this.props.intl.formatMessage({id:"unsavedChangedRemind",defaultMessage:j.defaultMessages.unsavedChangedRemind})),this.props.intl.formatMessage({id:"subscriberWarning",defaultMessage:j.defaultMessages.subscriberWarning})),o.React.createElement("div",{className:"secondary-title mt-5 mb-4"},this.props.intl.formatMessage({id:"data",defaultMessage:j.defaultMessages.data})),o.React.createElement("table",{className:"content-table w-100"},o.React.createElement("thead",{className:"content-table-header container"},o.React.createElement("tr",{className:"row"},Object.keys(this.columnName).map(((e,t)=>o.React.createElement("th",{key:t,className:(0,o.classNames)("text-truncate",{"col-4":"subscriberContent"===e,"col-2":"subscriberContent"!==e}),title:this.columnName[e]},this.columnName[e]))))),o.React.createElement("tbody",{className:"container"},e&&Object.keys(e).map(((i,a)=>{var s,n;const r=e[i];return o.React.createElement(jt,{isPremium:r.isPremium,isSubscriber:r.isSubscriber,sourceUrl:i,intl:this.props.intl,key:a,onChange:this.onProxyChange,label:null===(n=null===(s=r.items)||void 0===s?void 0:s[0])||void 0===n?void 0:n.label,proxySettingConfig:null==t?void 0:t[i]})})))))}}const Pt=(0,o.injectIntl)((0,g.withStyles)(Tt,"ProxySetting"));var Rt=function(e,t,i,o){return new(i||(i=Promise))((function(a,s){function n(e){try{l(o.next(e))}catch(e){s(e)}}function r(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,r)}l((o=o.apply(e,t||[])).next())}))};const Mt=o.dataSourceUtils.dataSourceJsonCreator,Nt={};class Lt extends o.React.PureComponent{constructor(e){super(e),this.__unmount=!1,this.getProxySettingConfigs=e=>{var t,i;const a={},s=null===(i=null===(t=(0,o.getAppStore)().getState().appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===i?void 0:i.appProxies;return Object.keys(e).forEach((e=>{const t=mt(e,s);t&&(a[e]=t.without("id").without("proxyId").without("proxyUrl"))})),Promise.resolve(a)},this.registerApp=()=>Rt(this,void 0,void 0,(function*(){var e,t,i,a;const s=null===(t=null===(e=(0,o.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appId;if(Nt[s])return yield Nt[s];const n=`${null===(a=null===(i=(0,o.getAppStore)().getState())||void 0===i?void 0:i.appStateInBuilder)||void 0===a?void 0:a.portalUrl}/sharing/rest/oauth2/registerApp`;return Nt[s]=o.esri.restRequest.request(n,{authentication:o.SessionManager.getInstance().getSessionByUrl((0,o.getAppStore)().getState().portalUrl),httpMethod:"POST",params:{itemId:s,appType:"browser",redirect_uris:JSON.stringify([this.getAppRootUrl()])}}),yield Nt[s]})),this.createProxies=e=>Rt(this,void 0,void 0,(function*(){var t,i,a;if(!e)return yield Promise.resolve(null);const s=null===(a=null===(i=null===(t=(0,o.getAppStore)().getState())||void 0===t?void 0:t.appStateInBuilder)||void 0===i?void 0:i.appConfig)||void 0===a?void 0:a.appProxies,n={};let r=[];if(Object.keys(e).forEach((t=>{const i=e[t];if(!i)return;const o=i.hitsPerInterval,a=i.intervalSeconds,l=mt(t,s);gt(l,t,o,a)?n[l.id]=l:r=r.concat({sourceUrl:t,hitsPerInterval:o,intervalSeconds:a})})),0===r.length)return(0,o.Immutable)(n);ht()||(yield this.registerApp());const l={referrers:[this.getAppOrTemplateUrl()].concat(o.proxyUtils.getProxyReferrers())},c=bt();return o.esri.restRequest.request(c,{authentication:o.SessionManager.getInstance().getSessionByUrl((0,o.getAppStore)().getState().portalUrl),httpMethod:"POST",params:{serviceProxyParams:l,proxies:r}}).then((e=>{var t,i;const a=(null==e?void 0:e.appProxies)||[],s=n,r=null===(i=null===(t=(0,o.getAppStore)().getState())||void 0===t?void 0:t.appStateInBuilder)||void 0===i?void 0:i.appConfig,l=null==r?void 0:r.appProxies;return a.forEach((e=>{const t=mt(e.sourceUrl,l),i=(null==t?void 0:t.id)||o.appConfigUtils.getUniqueId("appProxy");s[i]=Object.assign(Object.assign({},e),{id:i})})),(0,o.Immutable)(s)}))})),this.getAppRootUrl=()=>{var e;return null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.origin},this.getAppOrTemplateUrl=()=>{var e,t,i,a,s,n;const r=null===(t=null===(e=(0,o.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appId,l=null===(a=null===(i=(0,o.getAppStore)().getState())||void 0===i?void 0:i.appStateInBuilder)||void 0===a?void 0:a.appInfo,c="Web Experience Template"===(null==l?void 0:l.type),d=null===(s=o.urlUtils.getAppUrl({id:r,type:c?"template":"app"}))||void 0===s?void 0:s.replace(/^\//,"");return`${null===(n=this.getAppRootUrl())||void 0===n?void 0:n.replace(/\/$/,"")}/${d}`},this.onProxyConfigChange=e=>{this.setState({proxySettingConfigs:e})},this.onFinish=()=>{var e,t,i,a;this.setState({isLoading:!0});const s=this.state.proxySettingConfigs||{},n=null===(i=null===(t=null===(e=(0,o.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===i?void 0:i.appProxies,r=n&&Object.values(n).filter((e=>{var t;let i=s[null==e?void 0:e.sourceUrl];if(Mt.getDataSourceTypeFromArcGISWholeServiceUrl(null==e?void 0:e.sourceUrl)===o.DataSourceTypes.FeatureService){const o=null===(t=null==e?void 0:e.sourceUrl)||void 0===t?void 0:t.replace("/FeatureServer","/SceneServer"),a=s[o];i=i||(a?Object.assign(Object.assign({},a),{sourceUrl:null==e?void 0:e.sourceUrl}):null)}return!i||!gt(e,i.sourceUrl,i.hitsPerInterval,i.intervalSeconds)}));ft(null==r?void 0:r.map((e=>e.proxyId)),null===(a=this.state)||void 0===a?void 0:a.getAppConfigAction()).then((()=>{this.createProxies(s).then((e=>{var t;if(!this.__unmount){if(e){const i=null===(t=this.state)||void 0===t?void 0:t.getAppConfigAction();Object.keys(e).forEach((t=>{null==i||i.editAppProxy(e[t])})),null==i||i.exec()}const i=(0,o.getAppStore)().getState().appStateInBuilder.appConfig;this.props.onFinish(i)}}))})).catch((e=>{console.error("Creating proxy failed: ",e),this.setState({isLoading:!1,isError:!0})}))},this.getPublishButtonText=()=>{const{appHasBeenSaved:e,intl:t}=this.props;return e?t.formatMessage({id:"publish",defaultMessage:o.defaultMessages.publish}):t.formatMessage({id:"saveAndPublish",defaultMessage:j.defaultMessages.saveAndPublish})},this.getSubscriberContentString=()=>{const{appHasBeenSaved:e,intl:t}=this.props;return e?t.formatMessage({id:"subscriberContents",defaultMessage:j.defaultMessages.subscriberContents}):t.formatMessage({id:"unsavedChangesAndSubscriberContents",defaultMessage:j.defaultMessages.unsavedChangesAndSubscriberContents})},this.state={getAppConfigAction:null,isLoading:!1,isError:!1,proxySettingConfigs:null,needProxyItems:null}}componentDidMount(){this.__unmount=!1,o.moduleLoader.loadModule("jimu-for-builder").then((e=>{this.__unmount||this.setState({getAppConfigAction:e.getAppConfigAction})})),this.setState({isLoading:!0}),this.initNeedProxyItemsAndProxySettingConfigs()}componentDidUpdate(e){!e.isOpen&&this.props.isOpen&&this.initNeedProxyItemsAndProxySettingConfigs()}initNeedProxyItemsAndProxySettingConfigs(){return Rt(this,void 0,void 0,(function*(){this.setState({isLoading:!0});try{const e=yield ct(),t=yield this.getProxySettingConfigs(e);this.__unmount||this.setState({proxySettingConfigs:t,needProxyItems:e,isLoading:!1})}catch(e){this.__unmount||this.setState({isLoading:!1}),console.error("Getting proxy config error",e)}}))}componentWillUnmount(){this.__unmount=!0}render(){const e=this.state.proxySettingConfigs,t=this.state.needProxyItems,i=this.getSubscriberContentString();return(0,o.jsx)(j.Modal,{isOpen:this.props.isOpen,centered:!0,className:(0,o.classNames)({[this.props.className]:!!this.props.className}),returnfocusafterclose:"true",contentClassName:"proxy-setting-container",backdrop:"static","aria-label":i},(0,o.jsx)(j.ModalHeader,{className:"d-flex justify-content-between header px-30",toggle:this.props.onToggle},(0,o.jsx)("div",{className:"flex-grow-1 text-truncate"},i)),(0,o.jsx)(j.ModalBody,{className:"d-flex px-30"},(0,o.jsx)(Pt,{onChange:this.onProxyConfigChange,proxySettingConfigs:e,needProxyItems:t,appHasBeenSaved:this.props.appHasBeenSaved})),(0,o.jsx)(j.ModalFooter,{className:"px-30"},(0,o.jsx)(j.Button,{className:"mr-2",type:"primary",onClick:this.onFinish},this.getPublishButtonText()),(0,o.jsx)(j.Button,{type:"default",onClick:this.props.onCancel},this.props.intl.formatMessage({id:"cancel",defaultMessage:o.defaultMessages.cancel}))),this.state.isLoading&&(0,o.jsx)(j.Loading,{type:j.LoadingType.Secondary}),this.state.isError&&(0,o.jsx)(j.Message,{severity:"error",withIcon:!0,open:this.state.isError,autoHideDuration:5e3,onClose:()=>{this.setState({isError:!1})},message:this.props.intl.formatMessage({id:"createProxyToPublishAppError",defaultMessage:j.defaultMessages.createProxyToPublishAppError})}))}}const Dt=(0,g.withStyles)((0,g.withTheme)((0,o.injectIntl)(Lt)),"ProxySettingPopup"),At=o.ReactRedux.connect(((e,t)=>{var i,o;return{appProxies:null===(o=null===(i=null==e?void 0:e.appStateInBuilder)||void 0===i?void 0:i.appConfig)||void 0===o?void 0:o.appProxies}}))(Dt);var Et=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};class Ft extends o.React.PureComponent{componentDidUpdate(e){this.props.pageId===e.pageId&&this.props.sizemode===e.sizemode||this.props.toggle()}getStyle(){const{theme:e}=this.props;return e&&o.css`
      background-color: ${e.ref.palette.neutral[400]};
      ${(0,g.popperPointer)({background:e.ref.palette.neutral[400],border:{color:e.ref.palette.neutral[600],width:"1px"}})}
    `}render(){const e=this.props,{pageId:t,sizemode:i,dispatch:a}=e,s=Et(e,["pageId","sizemode","dispatch"]);return(0,o.jsx)(j.Popper,Object.assign({className:"page-aware-popper",css:this.getStyle()},s))}}const Bt=o.ReactRedux.connect((function(e){return{pageId:e.appRuntimeInfo.currentPageId,sizemode:e.browserSizeMode}}))(Ft);var Ut=v(62838),zt=v.n(Ut),$t=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const Vt=e=>{const t=window.SVG,{className:i}=e,a=$t(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:zt()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var Wt=v(71245),Gt=v.n(Wt),Ht=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const _t=e=>{const t=window.SVG,{className:i}=e,a=Ht(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:Gt()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var Jt=v(2918),Kt=v.n(Jt),qt=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const Xt=e=>{const t=window.SVG,{className:i}=e,a=qt(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:Kt()},a)):o.React.createElement("svg",Object.assign({className:s},a))},Yt=1e3,Qt=o.css`
  color: var(ref-palette-neutral-1100);

  .widget-enterprise-btn {
    position: absolute;
    top: 0;
    left: 0;
    z-index: 1;
  }

  .px-20 {
    padding-left: 18px;
    padding-right: 18px;
  }

  .pt-20 {
    padding-top: 20px;
  }

  .list-container {
    height: calc(100% - 150px);
    overflow-y: auto;
    padding-bottom: 20px;
  }

  .groups {
    font-size: 13px;
    font-weight: 600;
    color: var(--ref-palette-neutral-900);
  }

  .group-select {
    width: 210px;
  }

  .widget-group {
    .group-label{
      font-size: 13px;
      font-weight: 600;
      color: var(--ref-palette-neutral-900);
    }
  }

  .card-grid {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    grid-row-gap: 0.5rem;
    grid-column-gap: 0.5rem;
  }

  .widget-card {
    height: 80px;
    width: 112px;
    padding: 0;
    border: none;
    position: relative;

    > .jimu-btn {
      border-color: var(--ref-palette-neutral-500);
    }

    .widget-card--content {
      padding-top: 12px;
      cursor: pointer;
      background-color: var(--ref-palette-neutral-500);
      &:hover {
        background-color: var(--ref-palette-neutral-600);
      }
    }

    .widget-card-image {
      width: 20px;
      height: 20px;
      &:after {
        display: none;
      }
      img {
        width: 20px;
        height: 20px;
      }
    }

    .widget-card-name {
      line-height: 1rem;
      max-height: 2rem;
      white-space: normal;
      color: var(--ref-palette-neutral-1200);
      padding: 0 5px;
      font-size: 13px;
    }
  }
`;class Zt extends o.React.PureComponent{constructor(e){super(e),this.allGroup={value:Yt,label:this.props.intl.formatMessage({id:"all",defaultMessage:j.defaultMessages.all})},this.getRequireLicenseIconTooltip=e=>this.props.intl.formatMessage({id:`${e}License`}),this.getRequireLicenseIcon=e=>{switch(e){case"Enterprise":return(0,o.jsx)(_t,null);case"Autodesk":return(0,o.jsx)(Xt,null)}},this.WidgetCard=({widgetInfo:e})=>{var t,i,a;return(0,o.jsx)("div",{className:"d-flex align-items-start justify-content-center widget-card"},(null===(t=e.manifest)||void 0===t?void 0:t.requireLicense)&&(0,o.jsx)(j.Button,{title:this.getRequireLicenseIconTooltip(e.manifest.requireLicense),type:"tertiary",className:"widget-enterprise-btn",disableHoverEffect:!0,disableRipple:!0,icon:!0,size:"sm"},this.getRequireLicenseIcon(e.manifest.requireLicense)),(0,o.jsx)(j.Button,{className:"w-100 h-100 p-0",key:e.name,onClick:()=>{this.props.onSelect(e)},"aria-label":e.label},(0,o.jsx)("div",{className:"d-flex flex-column w-100 h-100 widget-card--content"},(0,o.jsx)("div",{className:"d-flex justify-content-center"},(0,o.jsx)("div",{className:"widget-card-image"},(0,o.jsx)(j.Icon,{size:20,className:"w-100 m-0",autoFlip:null===(a=null===(i=e.manifest)||void 0===i?void 0:i.properties)||void 0===a?void 0:a.flipIcon,icon:"string"==typeof e.icon?e.icon:e.icon&&e.icon.svg,color:"var(--ref-palette-neutral-1200)"}))),(0,o.jsx)("div",{className:"flex-grow-1 d-flex align-items-center"},(0,o.jsx)("div",{className:"widget-card-name w-100 text-center text-capitalize text-truncate",css:o.css`
                line-height: 1rem;
                max-height: 2.2rem;
                white-space: normal;
              `,title:e.label},e.label)))))},this.WidgetGroup=({group:e})=>{if(!e)return null;const t=this.WidgetCard;return(0,o.jsx)("div",{className:"widget-group w-100 mb-4"},(0,o.jsx)("h4",{className:"group-label w-100 text-break",title:e.label},e.label),(0,o.jsx)("div",{className:"card-grid m-0"},e.itemList.sort(((e,t)=>e.order-t.order)).map(((e,i)=>e?(0,o.jsx)(t,{widgetInfo:e,key:i}):(0,o.jsx)("div",{className:"widget-card",style:{visibility:"hidden"},key:i})))))},this.getGroupList=(e,t,i)=>{var o,a,s,n;const r=[this.allGroup];if(!!e){const t=this.getCommonGroups(e,Yt,i);t&&Object.values(t).forEach((e=>{"number"==typeof e.groupId&&r.push({value:e.groupId,label:this.getGroupLabel(e.groupId)})}))}if(null===(a=null===(o=this.state.jimuForBuilderUtils)||void 0===o?void 0:o.showCustomWidgets)||void 0===a?void 0:a.call(o,e)){this.getCustomGroup(e,t,Yt,i)&&r.push({value:null===(s=this.state.jimuForBuilderUtils)||void 0===s?void 0:s.CUSTOM_GROUP,label:this.getGroupLabel(null===(n=this.state.jimuForBuilderUtils)||void 0===n?void 0:n.CUSTOM_GROUP)})}return r.filter((e=>!!e.label))},this.changeSelectedGroup=e=>{this.setState({selectedGroup:e.target.value})},this.onSearchValueChange=e=>{this.setState({searchValue:e.target.value,selectedGroup:Yt})},this.state={selectedGroup:Yt,commonWidgetList:null,remoteCustomWidgetList:null,searchValue:"",jimuForBuilderUtils:null},this.searchInputRef=o.React.createRef()}componentDidMount(){this.loadJimuForBuilderUtilsPromise=o.cancelablePromise.cancelable(o.moduleLoader.loadModule("jimu-for-builder").then((e=>{this.setState({jimuForBuilderUtils:null==e?void 0:e.utils})}))),o.lodash.defer((()=>{(0,o.focusElementInKeyboardMode)(this.searchInputRef.current,!0)}))}componentDidUpdate(e,t){!t.jimuForBuilderUtils&&this.state.jimuForBuilderUtils&&(this.loadCommonWidgetList(this.state.jimuForBuilderUtils.fetchCommonWidgetList),this.loadCustomWidgetList(this.state.jimuForBuilderUtils.fetchRemoteCustomWidgetList))}componentWillUnmount(){var e,t,i;null===(e=this.loadJimuForBuilderUtilsPromise)||void 0===e||e.cancel(),null===(t=this.loadCommonWidgetsPromise)||void 0===t||t.cancel(),null===(i=this.loadCommonWidgetsPromise)||void 0===i||i.cancel()}loadCommonWidgetList(e){e&&(this.loadCommonWidgetsPromise=o.cancelablePromise.cancelable(e().then((e=>{var t,i;const o=null==e?void 0:e.filter((e=>this.props.isAccepted(e,this.props.isPlaceholder)));null===(i=(t=this.props).onWidgetLoaded)||void 0===i||i.call(t),this.setState({commonWidgetList:o})}))))}loadCustomWidgetList(e){e&&(this.loadRemoteCustomWidgetsPromise=o.cancelablePromise.cancelable(e().then((e=>{var t,i;const o=null==e?void 0:e.filter((e=>this.props.isAccepted(e,this.props.isPlaceholder)));null===(i=(t=this.props).onWidgetLoaded)||void 0===i||i.call(t),this.setState({remoteCustomWidgetList:o})}))))}getGroupLabel(e){var t,i;return null===(i=null===(t=this.state.jimuForBuilderUtils)||void 0===t?void 0:t.getWidgetsGroupLabel)||void 0===i?void 0:i.call(t,e,this.props.intl)}getCommonGroups(e,t,i){const o=t===Yt?e:null==e?void 0:e.filter((e=>e.group===t)),a={};return null==o||o.forEach((e=>{var t;if(e.group===(null===(t=this.state.jimuForBuilderUtils)||void 0===t?void 0:t.CUSTOM_GROUP))return;const o=this.getGroupLabel(e.group);(this.isFuzzySearch(o,i)||this.isFuzzySearch(e.label,i))&&(a[e.group]||(a[e.group]={label:o,groupId:e.group,itemList:[]}),a[e.group].itemList.push(e))})),a}getCustomGroup(e,t,i,o){var a,s,n;if(i===Yt||i===(null===(a=this.state.jimuForBuilderUtils)||void 0===a?void 0:a.CUSTOM_GROUP)){const i=this.getGroupLabel(null===(s=this.state.jimuForBuilderUtils)||void 0===s?void 0:s.CUSTOM_GROUP),a=(t||[]).concat((null==e?void 0:e.filter((e=>{var t;return e.group===(null===(t=this.state.jimuForBuilderUtils)||void 0===t?void 0:t.CUSTOM_GROUP)})))||[]).filter((e=>this.isFuzzySearch(i,o)||this.isFuzzySearch(e.label,o)));if(!o||a.length>0)return{label:i,groupId:null===(n=this.state.jimuForBuilderUtils)||void 0===n?void 0:n.CUSTOM_GROUP,itemList:a}}return null}isFuzzySearch(e,t){return!!e&&(!t||e.toLocaleLowerCase().includes(t.toLocaleLowerCase()))}render(){var e,t,i,a;const s=this.WidgetGroup,{commonWidgetList:n,remoteCustomWidgetList:r,selectedGroup:l,searchValue:c}=this.state,d=!!n;let p=n;const u=null===(t=null===(e=this.state.jimuForBuilderUtils)||void 0===e?void 0:e.getSectionItemForWidgetsList)||void 0===t?void 0:t.call(e,this.props.intl);d&&this.props.isAccepted(u,this.props.isPlaceholder)&&(p=n.concat([u]));const m=d&&this.getCommonGroups(p,l,c),g=null===(a=null===(i=this.state.jimuForBuilderUtils)||void 0===i?void 0:i.showCustomWidgets)||void 0===a?void 0:a.call(i,p),h=g&&this.getCustomGroup(p,r,l,c),v=this.getGroupList(p,r,c);return(0,o.jsx)("div",{className:(0,o.classNames)("content mt-4",this.props.className),css:Qt},(0,o.jsx)("div",{className:"d-flex justify-content-between align-items-center mb-4 px-20"},(0,o.jsx)(j.TextInput,{ref:this.searchInputRef,prefix:(0,o.jsx)(W,{size:16,color:"var(--ref-palette-neutral-800)"}),value:c,onChange:this.onSearchValueChange,className:"w-100",size:"sm",placeholder:this.props.intl.formatMessage({id:"search",defaultMessage:o.defaultMessages.search}),allowClear:!0})),(0,o.jsx)("div",{className:"d-flex justify-content-between align-items-center mb-4 px-20"},(0,o.jsx)("div",{className:"groups"},this.props.intl.formatMessage({id:"category",defaultMessage:j.defaultMessages.category})),(0,o.jsx)(j.Select,{className:"group-select",size:"sm",value:l,onChange:this.changeSelectedGroup},v.map(((e,t)=>(0,o.jsx)("option",{value:e.value,key:t,selected:e.value===l},e.label))))),(0,o.jsx)("div",{className:"w-100 list-container px-20"},!n&&(0,o.jsx)(j.Loading,{type:j.LoadingType.Secondary}),d&&Object.values(m).sort(((e,t)=>e.groupId-t.groupId)).map(((e,t)=>(0,o.jsx)(s,{key:t,group:e}))),g&&(0,o.jsx)(s,{group:h})))}}Zt.defaultProps={isPlaceholder:!1,isAccepted:()=>!0};const ei=(0,o.injectIntl)(Zt),ti={rootBoundary:"viewport",padding:0},ii={fallbackPlacements:["top","right","bottom","left"]},oi=o.css`
  background-color: var(--sys-color-surface-paper);
  color: var(--ref-palette-neutral-1100);

  .content {
    height: 600px;
    width: 404px;
    overflow: hidden;
    padding: 0;
  }

  .title {
    font-size: 16px;
    font-weight: 600;
    color: var(--ref-palette-neutral-1100);
  }

  .px-20 {
    padding-left: 20px;
    padding-right: 20px;
  }

  .pt-20 {
    padding-top: 20px;
  }
`;class ai extends o.React.PureComponent{constructor(e){super(e),this.togglePopper=e=>{this.state.open&&this.props.onClose&&this.props.onClose(e)},this.onWidgetLoaded=()=>{this.setState({generation:this.state.generation+1})},this.state={open:!0,generation:0}}render(){var e;return this.state.open?(0,o.jsx)(Bt,{className:this.props.className,placement:null!==(e=this.props.placement)&&void 0!==e?e:"bottom",toggle:this.togglePopper,css:oi,version:this.state.generation,shiftOptions:ti,flipOptions:ii,reference:this.props.referenceElement,open:!0,forceLatestFocusElements:!0,autoFocus:!1},(0,o.jsx)("div",{className:"shadow-3 content",css:this.props.css},(0,o.jsx)("div",{className:"d-flex justify-content-between align-items-center px-20 pt-20"},(0,o.jsx)("div",{className:"title"},this.props.intl.formatMessage({id:"addWidget",defaultMessage:j.defaultMessages.addWidget})),(0,o.jsx)(j.Button,{size:"sm",icon:!0,type:"tertiary",onClick:this.togglePopper,title:this.props.intl.formatMessage({id:"close",defaultMessage:o.defaultMessages.close})},(0,o.jsx)(Vt,null))),(0,o.jsx)(ei,{isPlaceholder:this.props.isPlaceholder,isAccepted:this.props.isAccepted,onSelect:this.props.onSelect,onWidgetLoaded:this.onWidgetLoaded}))):null}}ai.defaultProps={isPlaceholder:!1,isAccepted:()=>!0};const si=(0,o.injectIntl)(ai);var ni=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const ri=o.css`button { padding: 0 !important; }`,li=e=>{const{rootItemJson:t,onSort:i,onRemove:a,css:s,className:n}=e,r=ni(e,["rootItemJson","onSort","onRemove","css","className"]),[l,c]=o.React.useState(0),d=o.React.useMemo((()=>0===l?t:Object.assign({},t)),[t,l]),p=o.React.useCallback(((e,t)=>{"handleDidDrop"===e.updateType&&(null==i||i(e))}),[i]),u=o.hooks.useTranslation(j.defaultMessages),m=o.React.useCallback(((e,t)=>{var i;const s=t.props.itemJsons[0];return(0,o.jsx)("div",{css:ri,className:"d-flex align-items-center justify-content-end"},(null===(i=s.itemChildren)||void 0===i?void 0:i.length)>0&&(0,o.jsx)(j.Tooltip,{title:s.itemStateExpanded?u("collapse"):u("expand")},(0,o.jsx)(j.Button,{onClick:()=>{s.itemStateExpanded=!s.itemStateExpanded,c((e=>e+1))},type:"tertiary",disableHoverEffect:!0,disableRipple:!0,icon:!0,"aria-expanded":s.itemStateExpanded},s.itemStateExpanded?(0,o.jsx)(Be,{size:"s"}):(0,o.jsx)(De,{size:"s"}))),(0,o.jsx)(j.Tooltip,{title:u("deleteOption")},(0,o.jsx)(j.Button,{onClick:()=>{null==a||a(s)},type:"tertiary",disableHoverEffect:!0,disableRipple:!0,icon:!0},(0,o.jsx)(Vt,{size:"s"}))))}),[a,u]);(0,g.useTheme)();return(0,o.jsx)(G.Tree,Object.assign({css:[o.css`
width: 100%;
.jimu-tree-main {
  padding: 2px 0 2px 0;
  overflow: hidden;
}
.jimu-tree-item__drag-handle, .jimu-tree-item__title {
  cursor: move;
}
.jimu-tree-item__children-toggle {
  display: none;
}
.toggle-placeholder {
  display: none;
}
.jimu-collapse {
  width: 100%;
}
`,s],className:(0,o.classNames)("sort-tree",n),rootItemJson:d,dndEnabled:!0,isMultiSelection:!1,treeAlignmentType:G.TreeAlignmentType.Intact,renderOverrideItemCommands:m},r,{onUpdateItem:p}))},ci={rootBoundary:"viewport",padding:0},di={fallbackPlacements:["top","right","bottom","left"]},pi=e=>{const{title:t,placement:i,referenceElement:a,onClose:s,css:n,className:r,rootItemJson:l,onSort:c,onRemove:d}=e;return(0,o.jsx)(g.ThemeSwitchComponent,{useTheme2:!0},(0,o.jsx)(Bt,{placement:null!=i?i:"bottom",reference:a,toggle:s,css:n,className:(0,o.classNames)("sort-tree-popper",r),shiftOptions:ci,flipOptions:di,open:!0,forceLatestFocusElements:!0},(0,o.jsx)(j.PanelHeader,{className:"p-3",title:t,onClose:s}),(0,o.jsx)("div",{className:"panel-body p-3"},(0,o.jsx)(li,{rootItemJson:l,onSort:c,onRemove:d}))))};var ui=v(29435),mi=v.n(ui),gi=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const hi=e=>{const t=window.SVG,{className:i}=e,a=gi(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:mi()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var vi=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const fi=()=>o.css`
  .jimu-collapse-wrapper-inner {
    padding-top: var(--sys-spacing-2);
  }
`,yi=()=>o.css`
  flex-grow: 1;
  display: flex;
  justify-content: space-between;
  align-items: center;
  .label {
    color:  var(--sys-color-action-text);
    &.disabled {
      color: var(--sys-color-action-disabled-text);
    }
  }
`;function Si(e){const{label:t,isEmpty:i,onReset:a,children:s}=e,n=vi(e,["label","isEmpty","onReset","children"]),r=(0,o.jsx)(bi,{label:t,isEmpty:i,onReset:a});return(0,o.jsx)(j.CollapsablePanel,Object.assign({css:fi(),headerTag:"div",label:r,"aria-label":t},n,{defaultIsOpen:!i}),s)}function bi(e){const{label:t,isEmpty:i,onReset:a}=e,s=o.hooks.useTranslation(j.defaultMessages)("reset");return(0,o.jsx)("div",{css:yi()},(0,o.jsx)("span",{className:(0,o.classNames)("label",{disabled:i})},t),!i&&(0,o.jsx)(j.Button,{size:"sm",variant:"text",icon:!0,title:s,"aria-label":t,className:"p-0",onClick:a},(0,o.jsx)(hi,null)))}var wi=v(16884);function xi(e){var t,i,a,s;const{template:n,onClick:r}=e,l=(0,o.getAppStore)().getState().appContext.locale,c=null!==(i=null===(t=n.i18nLabel)||void 0===t?void 0:t[l])&&void 0!==i?i:n.label,d=null!==(s=null===(a=n.i18nDescription)||void 0===a?void 0:a[l])&&void 0!==s?s:n.description,p=null!=n.gifThumbnail,u="templage_desc_"+n.name,m=o.React.useMemo((()=>o.css`
    transform: ${(0,o.getAppStore)().getState().appContext.isRTL&&n.flipThumbnail?"scaleX(-1);":""}  ;
  `),[n]);return(0,o.jsx)("div",{className:"block-item"},(0,o.jsx)(j.Tooltip,{title:d},(0,o.jsx)(j.Button,{role:"option","aria-label":c,"aria-describedby":u,onClick:r,className:"block-item--icon p-0"},(0,o.jsx)("img",{className:(0,o.classNames)("default-icon",{"multiple-icon":p}),css:m,src:n.thumbnail,draggable:!1,width:n.thumbnailWidth/2,height:n.thumbnailHeight/2}),p&&(0,o.jsx)("img",{className:(0,o.classNames)("gif-icon",{"multiple-icon":p}),css:m,draggable:!1,src:n.gifThumbnail}))),(0,o.jsx)("span",{"aria-hidden":!0,className:"block-item-label text-center mt-2",css:o.css`max-width: ${n.thumbnailWidth/2}px`},c),(0,o.jsx)("span",{"aria-hidden":!0,className:"sr-only",id:u},d))}var Ci=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};function Ii(e){const{templates:t,onItemSelect:i,formatMessage:a}=e,s=Ci(e,["templates","onItemSelect","formatMessage"]),n=o.React.useMemo((()=>(0,g.getBuilderThemeVariables)()),[]),r=o.React.useMemo((()=>o.css`
    width: auto;
    padding: 20px;
    background-color: ${n?n.ref.palette.neutral[400]:"var(--ref-palette-neutral-400)"};
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-row-gap: 10px;
    grid-column-gap: 10px;

    .block-item {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding: 0;

      .jimu-btn {
        border-radius: unset !important;
      }

      .block-item--icon {
        background: ${n?n.ref.palette.neutral[300]:"var(--ref-palette-neutral-300)"};
        border: none;
        position: relative;
        cursor: pointer;

        .default-icon {
          opacity: 1;
        }
        .gif-icon {
          opacity: 0;
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
        }
      }
      .block-item--icon:hover {
        outline: 2px solid ${n?n.sys.color.primary.main:"var(--sys-color-primary-main)"};
        .default-icon.multiple-icon {
          opacity: 0;
        }
        .gif-icon {
          opacity: 1;
        }
      }

      .block-item-label {
        user-select: none;
        color: ${n?n.ref.palette.neutral[900]:"var(--ref-palette-neutral-900)"};
      }
    }

    .size-mode-SMALL & .block-item {
      width: 140px;
      height: auto;
    }

    .placeholder {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 200%;
    }
  `),[n]);return(0,o.jsx)("div",Object.assign({className:window.jimuConfig.isInBuilder?g.Theme2GlobalStyleClassName:"",css:r},s,{role:"listbox"}),t.map((e=>(0,o.jsx)(xi,{key:e.name,template:e,onClick:()=>{i(e)}}))),0===t.length&&(0,o.jsx)("div",{className:"placeholder"},a("noItemsFound")))}var ki=v(48799),ji=v.n(ki),Oi=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const Ti=e=>{const t=window.SVG,{className:i}=e,a=Oi(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:ji()},a)):o.React.createElement("svg",Object.assign({className:s},a))};class Pi extends o.React.PureComponent{constructor(e){super(e),this.onTabSelect=e=>{this.props.onTabSelect(e)},this.onFullScreenTypeChange=e=>{this.setState({fullScreenType:e.target.value})},this.getValueLabelItems=e=>e.map((e=>({value:e,label:e}))),this.getCapabilitiesForFullScreenApp=()=>{const e=(0,wi.getTemplateCapabilitiesOnlyInCurrentLocale)(wi.TemplateType.FullScreenPage),t=(0,wi.getTemplateCapabilitiesOnlyInCurrentLocale)(wi.TemplateType.FullScreenGridPage),i=e.concat(t),o=Array.from(new Set(i)).sort();return this.getValueLabelItems(o)},this.getCapabilitiesForScrollingPage=()=>{const e=(0,wi.getTemplateCapabilitiesOnlyInCurrentLocale)(wi.TemplateType.ScrollingPage);return this.getValueLabelItems(e)},this.getFilterdTemplatesForFullScreenApp=e=>{let t=[];if("fixed"===e)t=(0,wi.getFullScreenPageTemplates)();else if("grid"===e)t=(0,wi.getFullScreenGridPageTemplates)();else{const e=(0,wi.getFullScreenPageTemplates)(),i=(0,wi.getFullScreenGridPageTemplates)();t=[e[0],i[0]].concat(e.slice(1),i.slice(1))}const i=this.state.capabilitiesSelectedForFullScreenApp.map((e=>e.label));return(0,wi.getTemplatesByCapabilityTags)(t,i)},this.getFilterdTemplatesForScrollingPage=()=>{const e=(0,wi.getScrollingPageTemplates)(),t=this.state.capabilitiesSelectedForScrollingPage.map((e=>e.label));return(0,wi.getTemplatesByCapabilityTags)(e,t)},this.state={fullScreenType:"all",capabilitiesForFullScreenApp:this.getCapabilitiesForFullScreenApp(),capabilitiesForScrollingPage:this.getCapabilitiesForScrollingPage(),capabilitiesSelectedForFullScreenApp:[],capabilitiesSelectedForScrollingPage:[]}}render(){const{theme:e,formatMessage:t}=this.props,{fullScreenType:i}=this.state,a=this.getFilterdTemplatesForFullScreenApp(i),s=this.getFilterdTemplatesForScrollingPage();return(0,o.jsx)("div",{className:"w-100 h-100"},(0,o.jsx)("h5",{className:"pt-4 px-5 mb-2 hint-paper text-truncate",title:t("addPage")},t("addPage")),(0,o.jsx)(j.Tabs,{defaultValue:"fullScreenApp",fill:!0,type:"underline",css:o.css`
            height: calc(100% - 49px);
            width: 390px;
            .tab-content {
              height: calc(100% - 30px);
              .tab-pane {
                height: 100%;
                overflow-y: scroll;
              }
              .tab-pane:first-of-type {
                overflow-y: hidden;
              }
            }
            .jimu-nav {
              padding-left: ${e&&e.sys.spacing(5)};
              padding-right: ${e&&e.sys.spacing(5)};
            }
            .nav-item {
              width: 50%;
              .tab-title {
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
              }
            }
          `,onChange:this.onTabSelect},(0,o.jsx)(j.Tab,{id:"fullScreenApp",title:t("fullScreenApp"),className:j.FOCUSABLE_CONTAINER_CLASS},(0,o.jsx)("div",{className:"d-flex flex-column h-100"},(0,o.jsx)("div",{className:"d-flex align-self-end my-4 w-100",css:o.css`padding: 0 24px;`},(0,o.jsx)(j.Select,{value:i,"aria-label":t("page"),size:"sm",onChange:this.onFullScreenTypeChange},(0,o.jsx)("option",{value:"all"},t("all")),(0,o.jsx)("option",{value:"fixed"},t("fixed")),(0,o.jsx)("option",{value:"grid"},t("grid"))),(0,o.jsx)("div",{className:"ml-2"},(0,o.jsx)(j.Badge,{dot:!0,color:"primary",hideBadge:0===this.state.capabilitiesSelectedForFullScreenApp.length},(0,o.jsx)(j.AdvancedSelect,{icon:!0,size:"sm",arrow:!1,title:this.props.formatMessage("capabilities"),"aria-label":this.props.formatMessage("capabilities"),isMultiple:!0,isEmptyOptionHidden:!0,customDropdownButtonContent:()=>(0,o.jsx)(Ti,null),selectedValues:this.state.capabilitiesSelectedForFullScreenApp,staticValues:this.state.capabilitiesForFullScreenApp,onChange:e=>{this.setState({capabilitiesSelectedForFullScreenApp:e||[]})}})))),(0,o.jsx)(Ii,{className:(0,o.classNames)({[j.FOCUSABLE_CONTAINER_CLASS]:"fullScreenApp"===this.props.tabId}),templates:a,onItemSelect:this.props.onItemSelect,formatMessage:this.props.formatMessage,css:o.css`
                  height: calc(100% - 64px);
                  overflow: auto;
                  padding-top: 0;
                `}))),(0,o.jsx)(j.Tab,{id:"scrollingPage",title:t("scrollingPage"),className:j.FOCUSABLE_CONTAINER_CLASS},(0,o.jsx)("div",{className:"d-flex justify-content-end my-4",css:o.css`padding: 0 24px;`},(0,o.jsx)(j.Badge,{dot:!0,color:"primary",hideBadge:0===this.state.capabilitiesSelectedForScrollingPage.length},(0,o.jsx)(j.AdvancedSelect,{icon:!0,size:"sm",arrow:!1,className:"",css:o.css`width: fit-content;`,title:this.props.formatMessage("capabilities"),"aria-label":this.props.formatMessage("capabilities"),isMultiple:!0,isEmptyOptionHidden:!0,customDropdownButtonContent:()=>(0,o.jsx)(Ti,null),selectedValues:this.state.capabilitiesSelectedForScrollingPage,staticValues:this.state.capabilitiesForScrollingPage,onChange:e=>{this.setState({capabilitiesSelectedForScrollingPage:e||[]})}}))),(0,o.jsx)(Ii,{className:(0,o.classNames)({[j.FOCUSABLE_CONTAINER_CLASS]:"scrollingPage"===this.props.tabId}),templates:s,onItemSelect:this.props.onItemSelect,formatMessage:this.props.formatMessage,css:o.css`
                height: calc(100% - 64px);
                padding-top: 0;
              `}))))}}const Ri={rootBoundary:"viewport",padding:{bottom:20}};class Mi extends o.React.PureComponent{constructor(e){super(e),this.togglePopper=()=>{this.state.open&&this.props.onClose&&this.props.onClose(),this.state.open&&(0,o.focusElementInKeyboardMode)(this.props.referenceElement),this.setState({open:!this.state.open})},this.tabSelect=e=>{this.setState({tabId:e})},this.onItemSelect=e=>{this.props.onClose(),this.props.onItemSelect(e)},this.state={open:!0,tabId:"fullScreenApp"}}render(){const{referenceElement:e,theme:t}=this.props;return(0,o.jsx)(Bt,{placement:"bottom",theme:this.props.theme,reference:e,offsetOptions:10,open:!0,toggle:this.togglePopper,arrowOptions:!0,shiftOptions:Ri,forceLatestFocusElements:!0},(0,o.jsx)("div",{css:o.css`
            width: 390px;
            max-height: 640px;
            height: calc(100vh - 150px);
            overflow: hidden;
          `},(0,o.jsx)(Pi,{theme:t,tabId:this.state.tabId,onTabSelect:this.tabSelect,formatMessage:this.props.formatMessage,onItemSelect:this.onItemSelect})))}}class Ni extends o.React.PureComponent{constructor(e){super(e),this.onTypeChange=e=>{this.setState({type:e.target.value})},this.getCapabilities=()=>{const e=(0,wi.getTemplateCapabilitiesOnlyInCurrentLocale)(wi.TemplateType.Window);return Array.from(new Set(e)).sort().map((e=>({value:e,label:e})))},this.getFilterdTemplates=e=>{let t=[];t="fixedModalWindow"===e?(0,wi.getFixedModalWindowTemplates)():"fixedNonModalWindow"===e?(0,wi.getFixedNonModalWindowTemplates)():"anchoredWindow"===e?(0,wi.getAnchoredWindowTemplates)():(0,wi.getWindowTemplates)();const i=this.state.capabilitiesSelected.map((e=>e.label));return(0,wi.getTemplatesByCapabilityTags)(t,i)},this.state={type:"all",capabilities:this.getCapabilities(),capabilitiesSelected:[]}}render(){const{formatMessage:e,onItemSelect:t}=this.props,{type:i}=this.state,a=this.getFilterdTemplates(i);return(0,o.jsx)("div",{className:"w-100 h-100"},(0,o.jsx)("h5",{className:"pt-4 px-5 mb-2 hint-paper text-truncate",title:e("addDialog")},e("addDialog")),(0,o.jsx)("div",{className:"d-flex flex-column h-100"},(0,o.jsx)("div",{className:"d-flex align-self-end my-4 w-100",css:o.css`padding: 0 24px;`},(0,o.jsx)(j.Select,{value:this.state.type,"aria-label":e("addDialog"),size:"sm",onChange:this.onTypeChange},(0,o.jsx)("option",{value:"all"},e("all")),(0,o.jsx)("option",{value:"fixedModalWindow"},e("fixedModalWindow")),(0,o.jsx)("option",{value:"fixedNonModalWindow"},e("fixedNonModalWindow")),(0,o.jsx)("option",{value:"anchoredWindow"},e("anchoredWindow"))),(0,o.jsx)("div",{className:"ml-2"},(0,o.jsx)(j.Badge,{dot:!0,color:"primary",hideBadge:0===this.state.capabilitiesSelected.length},(0,o.jsx)(j.AdvancedSelect,{icon:!0,size:"sm",arrow:!1,title:e("capabilities"),"aria-label":e("capabilities"),isMultiple:!0,isEmptyOptionHidden:!0,customDropdownButtonContent:()=>(0,o.jsx)(Ti,null),selectedValues:this.state.capabilitiesSelected,staticValues:this.state.capabilities,onChange:e=>{this.setState({capabilitiesSelected:e||[]})}})))),(0,o.jsx)(Ii,{templates:a,onItemSelect:t,formatMessage:e,css:o.css`
              height: calc(100% - 110px);
              overflow: auto;
              padding-top: 0;
              .block-item .block-item--icon {
                outline-offset: -2px;
              }
            `})))}}const Li={rootBoundary:"viewport",padding:{bottom:20}};class Di extends o.React.PureComponent{constructor(e){super(e),this.togglePopper=()=>{this.state.open&&this.props.onClose&&this.props.onClose(),this.state.open&&(0,o.focusElementInKeyboardMode)(this.props.referenceElement),this.setState({open:!this.state.open})},this.onItemSelect=e=>{this.props.onClose(),this.props.onItemSelect(e)},this.state={open:!0}}render(){const{referenceElement:e,theme:t}=this.props;return(0,o.jsx)(Bt,{placement:"bottom",theme:t,reference:e,offsetOptions:10,open:!0,toggle:this.togglePopper,arrowOptions:!0,shiftOptions:Li,forceLatestFocusElements:!0},(0,o.jsx)("div",{css:o.css`
            width: 390px;
            max-height: 640px;
            height: calc(100vh - 150px);
            overflow: hidden;
          `},(0,o.jsx)(Ni,{formatMessage:this.props.formatMessage,onItemSelect:this.onItemSelect})))}}const Ai={rootBoundary:"viewport",crossAxis:!0,padding:{bottom:20}},Ei={boundary:document.body,fallbackPlacements:["right","left"]};function Fi(e){const{title:t,templates:i,templateContentStyle:a,referenceElement:s,onItemSelect:n,onClose:r}=e,l=o.React.useMemo((()=>e.theme?e.theme:window.jimuConfig.isInBuilder?(0,g.getTheme2)():(0,g.getTheme)()),[e.theme]),c=o.React.useMemo((()=>o.css`
    min-width: 300px;
    width: auto;
    border: 1px solid ${l?l.ref.palette.neutral[600]:"var(--ref-palette-neutral-600)"};
    box-shadow: 0 4px 20px 4px rgba(0,0,0,0.50);

    .template-content {
      max-height: 600px;
      height: ${t?"calc(100% - 50px)":"100%"};
      overflow: auto;
    }

    .size-mode-SMALL & .template-content {
      width: 320px;
    }
  `),[l,t]),d=o.React.useCallback((()=>{null==r||r(),"function"==typeof(null==s?void 0:s.focus)&&o.lodash.defer((()=>{(0,o.focusElementInKeyboardMode)(s)}))}),[r,s]),p=o.React.useCallback((e=>{d(),n(e)}),[d,n]);return(0,o.jsx)(Bt,{placement:"bottom",theme:l,css:c,reference:s,offsetOptions:10,toggle:d,open:!0,arrowOptions:!0,shiftOptions:Ai,flipOptions:Ei},t&&(0,o.jsx)("h5",{className:"hint-paper text-truncate title px-5 pt-4 mb-0"},t),(0,o.jsx)("div",{className:"template-content",style:a},(0,o.jsx)(Ii,{templates:i,onItemSelect:p})))}var Bi=v(12046),Ui=v.n(Bi),zi=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const $i=e=>{const t=window.SVG,{className:i}=e,a=zi(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:Ui()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var Vi=v(23662),Wi=v.n(Vi),Gi=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const Hi=e=>{const t=window.SVG,{className:i}=e,a=Gi(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:Wi()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var _i=v(54578),Ji=v.n(_i),Ki=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const qi=e=>{const t=window.SVG,{className:i}=e,a=Ki(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:Ji()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var Xi=v(14962),Yi=v.n(Xi),Qi=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const Zi=e=>{const t=window.SVG,{className:i}=e,a=Qi(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:Yi()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var eo=v(32881),to=v.n(eo),io=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const oo=e=>{const t=window.SVG,{className:i}=e,a=io(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:to()},a)):o.React.createElement("svg",Object.assign({className:s},a))};class ao extends o.React.PureComponent{constructor(e){super(e),this.preValue=null,this.initRuleOptionName=(e,t)=>{var i,a;const s=(null==e?void 0:e.map((e=>null==e?void 0:e.ruleOptionName)))||[],n=(null==t?void 0:t.map((e=>null==e?void 0:e.ruleOptionName)))||[];let r=!1;(null==e?void 0:e.length)===(null==t?void 0:t.length)&&s.join("")===n.join("")||(r=!0,this.initEditOptionNameStatus(e)),(r||!(null===(a=null===(i=this.state)||void 0===i?void 0:i.ruleOptionName)||void 0===a?void 0:a.length)&&(null==s?void 0:s.length)>0)&&this.setState({ruleOptionName:(0,o.Immutable)(s)})},this.initEditOptionNameStatus=e=>{const t=e.map((e=>!1));this.setState({editOptionNameStatus:t})},this.initData=()=>{if(Array.isArray(this.props.value)&&this.props.value.length)return!1;const e=this.deepClone(this.state.option);e.ruleOptionName=this.props.intl.formatMessage({id:"option",defaultMessage:j.defaultMessages.option})+0;const t=[e];this.props.onChange(t)},this.onOptionChange=(e,t,i,o)=>{const a=this.deepClone(this.props.value);a[t].rule[e][i]=o,this.props.onChange(a,t)},this.onOptionKeyUp=(e,t,i,o,a)=>{"Enter"!==e.key&&" "!==e.key||this.onOptionChange(t,i,o,a)},this.onSelectChange=(e,t,i)=>{const o=e[0];if(!o)return;const a=this.deepClone(this.props.value),s=o.name;a[i].rule[t].jimuFieldName=s,this.props.onChange(a,i)},this.addOption=()=>{const e=Array.isArray(this.props.value),t=e?this.props.value.length:0,i=this.createOptionText(t),o=this.deepClone(this.state.option);o.ruleOptionName=i;const a=e?this.deepClone(this.props.value):[];a.push(o),this.props.onChange(a)},this.createOptionText=e=>{const t=this.props.intl.formatMessage({id:"option",defaultMessage:j.defaultMessages.option})+e;if(!this.isOptionNameRepeat(t))return t;const i=e+1;return this.createOptionText(i)},this.deleteOption=(e,t)=>{if(t&&"Enter"!==t.key&&" "!==t.key)return!1;const i=this.deepClone(this.props.value);i.splice(e,1),this.props.onChange(i)},this.deleteAll=()=>{this.props.onChange([])},this.toggleOptionNameDisplay=(e,t=!1,i)=>{const{editOptionNameStatus:a}=this.state;if(i&&"Enter"!==i.key&&" "!==i.key)return!1;const s=(null==a?void 0:a.asMutable({deep:!0}))||[];s[e]=t,this.setState({editOptionNameStatus:(0,o.Immutable)(s)},(()=>{var e;null===(e=this.inputRef)||void 0===e||e.select()}))},this.handleOptionNameChange=(e,t)=>{if(!t)return;const i=this.deepClone(this.props.value),o=t;!this.isOptionNameRepeat(o)&&o&&(i[e].ruleOptionName=o),this.props.onChange(i)},this.isOptionNameRepeat=e=>{if(!Array.isArray(this.props.value))return!1;let t=!1;return this.props.value.forEach((i=>{i.ruleOptionName===e&&(t=!0)})),t},this.deepClone=e=>{const t=Array.isArray(e)?[]:{};for(const i in e){const o=("object"==typeof e[i]||"function"==typeof e[i])&&null!==e[i];t[i]=o?this.deepClone(e[i]):e[i]}return t},this.setInputRef=e=>{e&&(this.inputRef=e,(0,o.focusElementInKeyboardMode)(e,!0))},this.createRuleOptionElement=(e,t,i,a)=>{const s=t.jimuFieldName?(0,o.Immutable)([t.jimuFieldName]):(0,o.Immutable)([]);return(0,o.jsx)("div",{className:"select-down-con",key:t.jimuFieldName||i},this.props.useDataSource&&(0,o.jsx)("div",{className:"sort-field-selector"},(0,o.jsx)(rt.FieldSelector,{useDataSources:e,onChange:(e,t)=>{this.onSelectChange(e,i,a)},selectedFields:s,isDataSourceDropDownHidden:!0,useDropdown:!0,useKeyUpEvent:!0})),[{getTitle:()=>this.nls("ascending"),order:o.OrderRule.Asc},{getTitle:()=>this.nls("descending"),order:o.OrderRule.Desc}].map(((e,s,n)=>(0,o.jsx)(j.Button,{key:s,title:e.getTitle(),size:"sm",type:t.order===e.order?"primary":"secondary",className:"sort-button "+(this.props.singleRowItemOnly&&t.order!==e.order?"collapse":""),onClick:()=>{this.onOptionChange(i,a,"order",this.props.singleRowItemOnly?[...n,n[0]][s+1].order:e.order)},onKeyUp:t=>{this.onOptionKeyUp(t,i,a,"order",this.props.singleRowItemOnly?[...n,n[0]][s+1].order:e.order)}},e.order===o.OrderRule.Asc&&(0,o.jsx)(Zi,{size:"12",className:"sort-arrow-down-icon"}),e.order===o.OrderRule.Desc&&(0,o.jsx)(qi,{size:"12",className:"sort-arrow-down-icon"})))))},this.onRuleOptionNameChange=(e,t)=>{var i;const a=e.target.value,s=(null===(i=this.state.ruleOptionName)||void 0===i?void 0:i.asMutable({deep:!0}))||[];s[t]=a,this.setState({ruleOptionName:(0,o.Immutable)(s)})},this.createOptionNameElement=(e,t)=>{var i;const{editOptionNameStatus:a}=this.state,s=e.ruleOptionName,n=null===(i=this.state.ruleOptionName)||void 0===i?void 0:i[t],r=this.props.intl.formatMessage({id:"optionNamePlaceholder",defaultMessage:j.defaultMessages.optionNamePlaceholder}),l=(0,o.jsx)(j.TextInput,{className:"flex-grow-1 h-100 edit-input",size:"sm",type:"text",defaultValue:s,onChange:e=>{this.onRuleOptionNameChange(e,t)},onAcceptValue:e=>{this.handleOptionNameChange(t,e)},onBlur:()=>{this.toggleOptionNameDisplay(t,!1)},ref:e=>{this.setInputRef(e)},placeholder:r,title:n||r,"aria-label":n||r});return(0,o.jsx)("div",{className:"option-name d-flex align-items-center flex-grow-1","aria-label":s},a[t]?l:(0,o.jsx)("span",{id:"optionNameCon",title:s,onDoubleClick:()=>{this.toggleOptionNameDisplay(t,!0)}},s),(0,o.jsx)(j.Button,{size:"sm",type:"tertiary",icon:!0,className:"padding-0 option-name-icon-con",title:this.nls("edit"),"aria-describedby":"optionNameCon",onClick:()=>{this.toggleOptionNameDisplay(t,!a[t])},onKeyDown:e=>{this.toggleOptionNameDisplay(t,!a[t],e)}},(0,o.jsx)($i,{size:"s",className:"option-name-icon"})))},this.createOptionElement=(e,t,i)=>{let a;a=(0,o.jsx)("div",{className:"close-con text-right"},(0,o.jsx)(j.Button,{size:"sm",icon:!0,type:"tertiary",className:"padding-0",title:this.nls("deleteOption"),onClick:()=>{this.deleteOption(i)},onKeyUp:e=>{this.deleteOption(i,e)}},(0,o.jsx)(Vt,{size:this.props.singleRowItemOnly?14:12,className:"sort-arrow-down-icon"})));const s=()=>t.rule.map(((t,o)=>this.createRuleOptionElement(e,t,o,i)));return(0,o.jsx)("div",{className:"select-con flex-grow-1",key:i,role:"group","aria-label":t.ruleOptionName},this.props.singleRowItemOnly&&(0,o.jsx)(o.React.Fragment,null,(0,o.jsx)("div",{className:"option-name-con"},(0,o.jsx)(oo,{size:14}),s(),a))||(0,o.jsx)(o.React.Fragment,null,(0,o.jsx)("div",{className:"option-name-con d-flex align-items-center"},(()=>this.createOptionNameElement(t,i))(),a),s()))},this.nls=e=>this.props.intl?this.props.intl.formatMessage({id:e,defaultMessage:j.defaultMessages[e]}):e,this.onDataSourceCreated=e=>null,this.state={option:{ruleOptionName:"",isEditOptionName:!1,rule:[{jimuFieldName:"",order:o.OrderRule.Asc}]},ruleOptionName:null,editOptionNameStatus:(0,o.Immutable)([])}}componentDidMount(){this.initData()}componentDidUpdate(e,t){var i,o,a,s;this.preValue=null==e?void 0:e.value,this.initRuleOptionName(null===(i=this.props)||void 0===i?void 0:i.value,null==e?void 0:e.value),(null===(o=null==e?void 0:e.useDataSource)||void 0===o?void 0:o.dataSourceId)!==(null===(s=null===(a=this.props)||void 0===a?void 0:a.useDataSource)||void 0===s?void 0:s.dataSourceId)&&Promise.resolve(!0).then((()=>{this.initData()}))}render(){const{value:e}=this.props,t=this.props.intl.formatMessage({id:"invalidExpression",defaultMessage:j.defaultMessages.invalidExpression});return(0,o.jsx)("div",{className:(0,o.classNames)("sort-con",this.props.singleRowItemOnly&&"single-row-item",{[this.props.className]:!!this.props.className})},(0,o.jsx)("div",null,(0,o.jsx)(j.Button,{type:"tertiary",className:"add-option-btn",onClick:this.addOption},(0,o.jsx)(Hi,{size:"s",className:"add-option-icon"}),(0,o.jsx)("span",null,this.props.intl.formatMessage({id:"addOption",defaultMessage:j.defaultMessages.addOption}))),(0,o.jsx)(o.DataSourceComponent,{useDataSource:this.props.useDataSource,onDataSourceCreated:this.onDataSourceCreated},(i=>Array.isArray(e)?(0,o.jsx)(G.List,{size:"sm",className:"setting-ui-unit-list",itemsJson:e.asMutable({deep:!0}).map(((e,t)=>({itemStateDetailContent:e,itemKey:`${t}`}))),dndEnabled:!0,onUpdateItem:(e,t)=>{const{itemJsons:i}=t.props,[,o]=i,a=o.map((e=>e.itemStateDetailContent));e.updateType===G.TreeItemActionType.HandleDidDrop&&this.props.onChange(a)},overrideItemBlockInfo:({itemBlockInfo:e})=>({name:G.TreeItemActionType.RenderOverrideItem,children:[{name:G.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:G.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:G.TreeItemActionType.RenderOverrideItemBody,children:[{name:G.TreeItemActionType.RenderOverrideItemDragHandle},{name:G.TreeItemActionType.RenderOverrideItemMainLine}]}]}]}]}),renderOverrideItemMainLine:(e,t)=>{var i;const{itemJsons:a}=t.props,s=a[0],n=a[1];return this.createOptionElement((0,o.Immutable)([null===(i=this.props.useDataSource)||void 0===i?void 0:i.asMutable({deep:!0})]),s.itemStateDetailContent,n.indexOf(s))}}):t)),Array.isArray(e)&&0===e.length&&(0,o.jsx)("div",{className:"no-sort-remind"},(0,o.jsx)("div",null,this.props.intl.formatMessage({id:"noOptionRemindText",defaultMessage:j.defaultMessages.noOptionRemindText})),(0,o.jsx)("div",null,this.props.intl.formatMessage({id:"pleaseAddOne",defaultMessage:j.defaultMessages.pleaseAddOne})))))}}const so=(0,g.withStyles)((0,o.injectIntl)(ao),"SortSetting");var no=v(16435),ro=v.n(no),lo=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const co=e=>{const t=window.SVG,{className:i}=e,a=lo(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:ro()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var po=v(57993),uo=v.n(po),mo=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const go=e=>{const t=window.SVG,{className:i}=e,a=mo(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:uo()},a)):o.React.createElement("svg",Object.assign({className:s},a))};var ho=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const vo=e=>{const t=o.hooks.useTranslation(j.defaultMessages),{vertical:i=!1,onChange:a,autoFlip:s=!0,className:n,size:r="sm"}=e,l=ho(e,["vertical","onChange","autoFlip","className","size"]);return o.React.createElement(j.AdvancedButtonGroup,Object.assign({size:r,className:(0,o.classNames)("setting--direction-selector",n)},l),o.React.createElement(j.Button,{size:r,title:t("horizontal"),"aria-label":t("horizontal"),type:"default",icon:!0,active:!i,onClick:()=>{a(!1)}},o.React.createElement(co,{autoFlip:s})),o.React.createElement(j.Button,{size:r,title:t("vertical"),"aria-label":t("vertical"),type:"default",icon:!0,active:i,onClick:()=>{a(!0)}},o.React.createElement(go,null)))};var fo;!function(e){e.Auto="AUTO",e.Custom="CUSTOM"}(fo||(fo={}));class yo extends o.React.PureComponent{constructor(e){super(e),this.toggleDropdown=()=>{this.setState((e=>({dropdownOpen:!e.dropdownOpen})))},this.state={dropdownOpen:!1},this._onAutoSelected=this.onSelect.bind(this,fo.Auto),this._onCustomSelected=this.onSelect.bind(this,fo.Custom)}onSelect(e){this.props.mode!==e&&this.props.onChange(e)}getStyle(){return o.css`
      .auto-dropdown.jimu-dropdown {
        width: 26px;
        height: 26px;

        .btn {
          padding: 0 !important;
        }
      }

      & > .jimu-dropdown .jimu-dropdown-button,
      & > .jimu-dropdown .jimu-dropdown-button:hover {
        height: 26px;
        padding: 0 0.375rem;
      }
    `}autoInput(){return(0,o.jsx)(j.Input,{style:{width:"110px"},css:o.css`
          background-color: var(--ref-palette-neutral-600);
          border-color: var(--ref-palette-neutral-600);
          color: var(--ref-palette-black);
          height: 1.625rem;
          border-width: 0;
          padding: 0 0.25rem;
        `,disabled:!0,value:this.props.intl.formatMessage({id:"auto"})})}render(){const{mode:e,intl:t}=this.props,i=t.formatMessage({id:"auto"}),a=t.formatMessage({id:"custom"});return(0,o.jsx)("div",{className:"d-flex",css:this.getStyle()},(0,o.jsx)(j.Dropdown,{className:"auto-dropdown",isOpen:this.state.dropdownOpen,toggle:this.toggleDropdown},(0,o.jsx)(j.DropdownButton,{icon:!0}),(0,o.jsx)(j.DropdownMenu,null,(0,o.jsx)(j.DropdownItem,{onClick:this._onAutoSelected},(0,o.jsx)("span",{css:o.css`width: 1rem;`},e===fo.Auto&&(0,o.jsx)(kt,{size:"s"})),i),(0,o.jsx)(j.DropdownItem,{onClick:this._onCustomSelected},(0,o.jsx)("span",{css:o.css`width: 1rem;`},e===fo.Custom&&(0,o.jsx)(kt,{size:"s"})),a))),e===fo.Auto&&this.autoInput(),e===fo.Custom&&this.props.children)}}const So=(0,o.injectIntl)(yo);var bo=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const wo={crossAxis:!0},xo={fallbackPlacements:["bottom-end","top-end"]},Co=(0,g.styled)(j.FloatingPanel)((()=>{const e=(0,g.getTheme2)(),t=null==e?void 0:e.ref.palette.neutral[1e3],i=null==e?void 0:e.ref.palette.neutral[1100];return`\n    background-color: ${null==e?void 0:e.ref.palette.neutral[400]};\n    color: ${t};\n    border: 1px solid ${null==e?void 0:e.ref.palette.neutral[600]};\n    > .popper-box {\n      > .panel-header {\n        color: ${t};\n        .action-btn {\n          color: ${t};\n          &:hover {\n            color: ${i};\n          }\n        }\n      }\n    }\n  `})),Io=o.React.forwardRef(((e,t)=>{const{className:i,placement:a="right-start",onInitResizeHandler:s,onInitDragHandler:n,version:r}=e,l=bo(e,["className","placement","onInitResizeHandler","onInitDragHandler","version"]),c=o.React.useRef(null),d=o.hooks.useForkRef(t,c),[p,u]=o.hooks.useControlled({controlled:r,default:0});return o.React.useEffect((()=>{null==s||s((()=>{var e;null===(e=c.current)||void 0===e||e.classList.add("d-none")}),null,(()=>{var e;u((e=>e+1)),null===(e=c.current)||void 0===e||e.classList.remove("d-none")}))}),[s,u]),o.React.useEffect((()=>{null==n||n((()=>{var e;null===(e=c.current)||void 0===e||e.classList.add("d-none")}),null,(()=>{var e;u((e=>e+1)),null===(e=c.current)||void 0===e||e.classList.remove("d-none")}))}),[n,u]),o.React.createElement(Co,Object.assign({className:(0,o.classNames)("shadow-2",i),shiftOptions:wo,flipOptions:xo,placement:a,ref:d,version:p},l))}));var ko=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const jo=e=>{const{onClose:t,open:i,reference:a,children:s,floating:n}=e,r=ko(e,["onClose","open","reference","children","floating"]),l=o.hooks.useTranslation(j.defaultMessages)("quickStyle");return o.React.createElement(o.React.Fragment,null,n&&o.React.createElement(Io,Object.assign({},r,{headerTitle:n?l:"",onHeaderClose:t}),s),!n&&o.React.createElement(j.Popper,Object.assign({open:i,reference:a},r),o.React.createElement(j.PanelHeader,{className:"px-4 py-2",title:l,onClose:t}),s))},Oo=6,To=1e3,Po=6,Ro="default_geocode",Mo=3e5;var No,Lo;!function(e){e.Both="Both",e.GeocodeService="GeocodeService",e.FeatureService="FeatureService"}(No||(No={})),function(e){e.GeocodeService="GeocodeService",e.FeatureService="FeatureService"}(Lo||(Lo={}));const Do="FieldName",Ao="FieldValue",Eo=99,Fo=1e3,Bo=20,Uo="__",zo="objectid",$o="address",Vo="default_address",Wo="Default Address",Go="https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",Ho="ArcGIS World Geocoding Service";var _o,Jo=v(71371),Ko=function(e,t,i,o){return new(i||(i=Promise))((function(a,s){function n(e){try{l(o.next(e))}catch(e){s(e)}}function r(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,r)}l((o=o.apply(e,t||[])).next())}))};!function(e){e.Pass="Pass",e.NotHttps="Not_Https",e.InvalidURL="Invalid_URL"}(_o||(_o={}));const qo=e=>{if(!e)return"geocoder";const t=e.split("/");return t[t.length-2]||"geocoder"},Xo=e=>!!e&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi.test(e);function Yo(e){return Ko(this,void 0,void 0,(function*(){const{useUtility:t}=e,i=(null==e?void 0:e.geocodeURL)||(yield oa(t));return aa(i).then((t=>{if((null==t?void 0:t.urlCheckResultType)!==_o.Pass)return Promise.resolve({urlCheckResult:t});{const i=t.addressFields.concat(t.candidateFields),o=Object.assign(Object.assign({},e),{urlCheckResult:t,fields:i}),a=Qo(o);return Promise.resolve({urlCheckResult:t,dataSourceConfig:a})}}))}))}const Qo=e=>{const{urlCheckResult:t,useUtility:i,fields:o,datasourceConfig:a,configId:s,viewId:n,createOutputDs:r,id:l,dataSourceConfigItem:c,geocodeURL:d,notAddNewUtility:p}=e,{singleLineFieldName:u,spatialReference:m,isSupportSuggest:g}=t,h=fa(null==a?void 0:a.asMutable({deep:!0})),v=s||ya(h,n);let f=a?a.asMutable({deep:!0}):[];const y=ea(i,d),S=ta(i,d),{addressFieldsSchema:b,defaultAddressFieldName:w}=da(o),x={configId:v,icon:null,label:y,hint:S,useUtility:i,searchServiceType:Lo.GeocodeService,singleLineFieldName:u,isSupportSuggest:g,spatialReference:m};return p&&(x.geocodeURL=d),r&&(x.outputDataSourceId=`${l}_output_${v}`,x.addressFields=b,x.displayFields=Zo(b,w),x.defaultAddressFieldName=w),(null==c?void 0:c.configId)?f=a.map((e=>(null==e?void 0:e.configId)===v?x:e)):f.push(x),f},Zo=(e,t)=>{let i;return null==e||e.forEach((e=>{var o;(null===(o=null==e?void 0:e.jimuName)||void 0===o?void 0:o.toLocaleLowerCase())===t&&(i=e)})),i||(i=e[0]),[i]},ea=(e,t)=>{if(null==e?void 0:e.utilityId)return o.UtilityManager.getInstance().getLabelOfUseUtility(e);if(t){const e=ia(t);return null==e?void 0:e.name}},ta=(e,t)=>{var i;if(null==e?void 0:e.utilityId){const t=o.UtilityManager.getInstance().getUtilityJson(e.utilityId);return null===(i=null==t?void 0:t.orgSetting)||void 0===i?void 0:i.placeholder}if(t){const e=ia(t);return null==e?void 0:e.placeholder}},ia=e=>{var t;const i=null===(t=(0,o.getAppStore)().getState().portalSelf)||void 0===t?void 0:t.helperServices;return((null==i?void 0:i.geocode)||[]).filter((t=>(null==t?void 0:t.url)===e))[0]},oa=e=>Ko(void 0,void 0,void 0,(function*(){return o.UtilityManager.getInstance().getUrlOfUseUtility(e).then((e=>Promise.resolve(e)),(e=>Promise.reject(new Error(e))))})),aa=e=>Ko(void 0,void 0,void 0,(function*(){const t=new RegExp("^(([h][t]{2}[p][s])?://)");if(!e||!t.test(e))return Promise.resolve({urlCheckResultType:_o.NotHttps});try{return(0,o.loadArcGISJSAPIModules)(["esri/request"]).then((t=>{const[i]=t;return i(e,{query:{f:"json"},responseType:"json"}).then((e=>{var t;const i=(null==e?void 0:e.data)||{};if(null==i?void 0:i.capabilities){const e=(null==i?void 0:i.singleLineAddressField)||{},o=(null==i?void 0:i.addressFields)||[],a=(null==i?void 0:i.spatialReference)||null,s=(null==i?void 0:i.candidateFields)||[],n=(null===(t=null==i?void 0:i.capabilities)||void 0===t?void 0:t.split(","))||[],r=null==n?void 0:n.includes("Suggest");return Promise.resolve({urlCheckResultType:_o.Pass,singleLineFieldName:null==e?void 0:e.name,addressFields:o,isSupportSuggest:r,candidateFields:s,spatialReference:a})}return Promise.resolve({urlCheckResultType:_o.InvalidURL})}),(e=>Promise.resolve({urlCheckResultType:_o.InvalidURL})))}),(e=>Promise.resolve({urlCheckResultType:_o.InvalidURL})))}catch(e){return Promise.resolve({urlCheckResultType:_o.InvalidURL})}}));function sa(e){return Ko(this,void 0,void 0,(function*(){var t,i;const{nls:a,isSingle:s,createOutputDs:n,id:r,viewId:l,notAddNewUtility:c}=e,d=(null===(i=null===(t=function(e){var t;const i=null===(t=(0,o.getAppStore)().getState().portalSelf)||void 0===t?void 0:t.helperServices;return(0,Jo.extractService)(i,o.SupportedUtilityType.GeoCoding,null,null,e)}(a))||void 0===t?void 0:t[0])||void 0===i?void 0:i.children)||[];if(s){const e={utility:d[0],id:r,createOutputDs:n,viewId:l,notAddNewUtility:c,index:0},t=yield na(e);return Promise.resolve(t?[t]:[])}{const e=null==d?void 0:d.map(((e,t)=>na({utility:e,id:r,createOutputDs:n,viewId:Ro,notAddNewUtility:c,index:t}))),t=yield Promise.all(e),i=null==t?void 0:t.filter((e=>!!e));return Promise.resolve(i)}}))}function na(e){return Ko(this,void 0,void 0,(function*(){const{utility:t,id:i,createOutputDs:a,viewId:s,notAddNewUtility:n,index:r}=e;if(!t)return Promise.resolve(null);let l=o.UtilityManager.getInstance().getIdOfOrgUtility(t.name,t.url,t.index,t.label);l||n||(l=(0,Jo.addNewUtility)(t));const c=s?`${s}_${l||r}`:`${Ro}_${l||r}`,d=s?`${s}_${t.index}`:`${Ro}_${t.index}`;return Yo({id:i,createOutputDs:a,dataSourceConfigItem:null,viewId:n?d:c,configId:null,datasourceConfig:null,useUtility:{utilityId:l},geocodeURL:t.url,notAddNewUtility:n}).then((e=>{var t,i;return(null===(t=e.urlCheckResult)||void 0===t?void 0:t.urlCheckResultType)===_o.Pass&&(null===(i=e.dataSourceConfig)||void 0===i?void 0:i.length)>0?Promise.resolve(e.dataSourceConfig[0]):Promise.resolve(null)}))}))}const ra={jimuName:zo,alias:"OBJECTID",esriType:o.EsriFieldType.OID,type:o.JimuFieldType.Number,name:zo},la=(e="",t=[])=>{const i={};return null==t||t.forEach(((e,t)=>{i[null==e?void 0:e.jimuName]=e,0===t&&(i[zo]=ra)})),{label:e,idField:zo,fields:i}},ca=(e,t=0)=>{let i=Vo;return null==e||e.forEach((o=>{i=t?`${i}${t}`:i,o.jimuName===i&&(i=ca(e,t+=1))})),i},da=(e=[])=>{var t;const i=null===(t=null==e?void 0:e.map((e=>o.dataSourceUtils.convertFieldToJimuField(e,e))))||void 0===t?void 0:t.filter((e=>e)),a=ca(i,0),s={jimuName:a,alias:Wo,type:o.JimuFieldType.String,esriType:o.EsriFieldType.String,name:a};return i.unshift(s),{addressFieldsSchema:i,defaultAddressFieldName:a}},pa=(e,t,i,a)=>{const s=a||(e=>Xo(e)?Ho:qo(e))(i),n=ba(t,e),r=la(a);return{id:n,type:o.DataSourceTypes.FeatureLayer,label:s,originDataSources:[],isOutputFromWidget:!0,isDataInDataSourceInstance:!1,schema:r,geometryType:"esriGeometryPoint"}},ua=e=>e?e.type===o.DataSourceTypes.SceneLayer?e.getAssociatedDataSource():e:null,ma=(e,t)=>!(!e||!t)&&t.some((t=>t.dataSourceId===e.dataSourceId)),ga=(e,t)=>{var i;return(null===(i=t.filter((t=>(null==t?void 0:t.dataSourceId)===(null==e?void 0:e.dataSourceId))))||void 0===i?void 0:i.length)>0},ha=(e,t)=>{var i;if((null==e?void 0:e.length)!==(null==t?void 0:t.length))return!0;const o=[];if(null==e||e.forEach((e=>{var i;const a=t.filter((t=>(null==t?void 0:t.dataSourceId)===(null==e?void 0:e.dataSourceId)));(null==a?void 0:a.length)>0&&o.push({dsFields:null==e?void 0:e.fields,preDsFields:null===(i=a[0])||void 0===i?void 0:i.fields})})),(null==o?void 0:o.length)!==(null==e?void 0:e.length))return!0;return(null===(i=null==o?void 0:o.filter((e=>{var t,i,o,a;const s=(null===(t=null==e?void 0:e.dsFields)||void 0===t?void 0:t.length)!==(null===(i=null==e?void 0:e.preDsFields)||void 0===i?void 0:i.length),n=(null===(a=null===(o=null==e?void 0:e.dsFields)||void 0===o?void 0:o.filter((t=>{var i;return!(null===(i=null==e?void 0:e.preDsFields)||void 0===i?void 0:i.includes(t))})))||void 0===a?void 0:a.length)>0;return s||n})))||void 0===i?void 0:i.length)>0},va=(e,t,i)=>{var o,a,s;const n=(null===(o=null==e?void 0:e.useDataSources)||void 0===o?void 0:o.asMutable({deep:!0}))||[],r=(null===(a=null==e?void 0:e.outputDataSources)||void 0===a?void 0:a.asMutable({deep:!0}))||[];if((null==n?void 0:n.length)!==(null==t?void 0:t.length)||(null==r?void 0:r.length)!==(null==i?void 0:i.length))return!0;const l=ha(t,n),c=(null===(s=r.filter((e=>!(null==i?void 0:i.includes(e)))))||void 0===s?void 0:s.length)>0;return l||c},fa=e=>null==e?void 0:e.map((e=>e.configId)),ya=(e,t)=>{if(!e||0===(null==e?void 0:e.length))return t?`config_${t}_0`:"config_0";const i=Sa(e);return t?`config_${t}_${i+1}`:`config_${i+1}`},Sa=e=>{var t;const i=null==e?void 0:e.map((e=>{var t;const i=null===(t=null==e?void 0:e.split("_"))||void 0===t?void 0:t.pop();return i?Number(i):0}));return null===(t=null==i?void 0:i.sort(((e,t)=>t-e)))||void 0===t?void 0:t[0]},ba=(e,t)=>{var i;if(!e)return`${t}_output_0`;const o=null===(i=null==e?void 0:e.split("_"))||void 0===i?void 0:i.pop();return`${t}_output_${Number(o)}`},wa=e=>{var t;const{datasourceConfig:i,dsJsonOriginDs:a,useDataSource:s,configId:n,viewId:r,fieldsInMapSearchProperties:l,exactMatch:c,label:d,searchInCurrentMapExtent:p}=e,u=fa(null==i?void 0:i.asMutable({deep:!0})),m=n||ya(u,r),g=d||(null==a?void 0:a.getLabel()),h=Ia(s,l);if(u&&u.includes(m)){const e=i.filter((e=>e.configId===m))[0],a=null===(t=e.useDataSource)||void 0===t?void 0:t.dataSourceId,n=s.dataSourceId;if(a&&n&&o.dataSourceUtils.areDerivedFromSameMain(a,n)){const t=xa((0,o.Immutable)(Object.assign(Object.assign({},e),{configId:m,useDataSource:s,label:g})));return null==t?void 0:t.asMutable({deep:!0})}}s.fields=null==h?void 0:h.map((e=>null==e?void 0:e.jimuName));return{configId:m,icon:null,label:g,displayLabel:!0,useDataSource:s,displayFields:h,searchFields:h,hint:"",searchServiceType:Lo.FeatureService,searchExact:!!c,searchInCurrentMapExtent:!!p}},xa=e=>{var t,i,o,a;const s=(null===(i=null===(t=null==e?void 0:e.searchFields)||void 0===t?void 0:t.asMutable({deep:!0}))||void 0===i?void 0:i.map((e=>null==e?void 0:e.jimuName)))||[],n=(null===(a=null===(o=null==e?void 0:e.displayFields)||void 0===o?void 0:o.asMutable({deep:!0}))||void 0===a?void 0:a.map((e=>null==e?void 0:e.jimuName)))||[],r=Array.from(new Set(s.concat(n)));return e.setIn(["useDataSource","fields"],r)},Ca=e=>{const{datasourceConfig:t,datasourceConfigItem:i,configId:o}=e;let a=t?t.asMutable({deep:!0}):[];const s=wa(e);return(null==i?void 0:i.configId)?a=a.map((e=>(null==e?void 0:e.configId)===o?s:e)):a.push(s),{dsConfigItem:s,datasourceConfig:a}},Ia=(e,t)=>{var i,a,s,n,r;const l=o.DataSourceManager.getInstance().getDataSource(null==e?void 0:e.dataSourceId),c=(null==l?void 0:l.getLayerDefinition)&&(null===(i=null==l?void 0:l.getLayerDefinition())||void 0===i?void 0:i.displayField);let d;(null==t?void 0:t.length)>0&&(d=t.map((e=>null==e?void 0:e.name)));const p=null===(a=null==l?void 0:l.getSchema())||void 0===a?void 0:a.fields;let u;const m=[];for(const e in p)(null===(s=null==p?void 0:p[e])||void 0===s?void 0:s.type)!==o.JimuFieldType.Date&&m.push(null==p?void 0:p[e]),(null===(n=null==p?void 0:p[e])||void 0===n?void 0:n.name)===c&&(null===(r=null==p?void 0:p[e])||void 0===r?void 0:r.type)!==o.JimuFieldType.Date&&c&&(u=null==p?void 0:p[e]);let g=[];return d?g=null==m?void 0:m.filter((e=>d.includes(e.name))):(null==m?void 0:m.length)>0&&(g=(null==m?void 0:m.length)>1?[(0,o.Immutable)(m[1])]:[(0,o.Immutable)(m[0])]),d&&0===(null==g?void 0:g.length)&&(null==m?void 0:m.length)>0&&(g=(null==m?void 0:m.length)>1?[(0,o.Immutable)(m[1])]:[(0,o.Immutable)(m[0])]),d&&(null==g?void 0:g.length)>0?g:u?[(0,o.Immutable)(u)]:g},ka=e=>o.DataSourceManager.getInstance().createDataSourceByUseDataSource((0,o.Immutable)(e)).then((e=>{const t=ua(e);return t||Promise.reject(Error("")),t})),ja=e=>{const t={useDataSources:[],outputDataSources:[]};return Object.keys(e||{}).forEach((i=>{var a;const s=e[i],n=Oa((0,o.Immutable)((null==s?void 0:s.dataSourceConfig)||[]),!0);null===(a=n.useDataSources)||void 0===a||a.forEach((e=>{ga(e,null==t?void 0:t.useDataSources)?t.useDataSources=Ma(e,t.useDataSources):t.useDataSources.push(e)})),t.outputDataSources=t.outputDataSources.concat(n.outputDataSources)})),t},Oa=(e,t)=>{var i;return null===(i=null==e?void 0:e.asMutable({deep:!0}))||void 0===i?void 0:i.reduce(((e,i)=>{const o=null==i?void 0:i.useDataSource;if(o&&(ga(o,null==e?void 0:e.useDataSources)?e.useDataSources=Ma(o,null==e?void 0:e.useDataSources):null==e||e.useDataSources.push(o)),t){const t=Pa(i);t&&e.outputDataSources.push(t)}return e}),{useDataSources:[],outputDataSources:[]})},Ta=(e,t,i)=>{var a,s,n,r;const l=(0,o.getAppStore)().getState(),c=null===(n=null===(s=null===(a=null==l?void 0:l.appStateInBuilder)||void 0===a?void 0:a.appConfig)||void 0===s?void 0:s.widgets)||void 0===n?void 0:n[t],d={id:t};return d.useDataSources=null==e?void 0:e.useDataSources,i&&(d.outputDataSources=null===(r=null==e?void 0:e.outputDataSources)||void 0===r?void 0:r.map((e=>null==e?void 0:e.id))),{dsInWidgetJson:d,isWidgetJsonDsChanged:va(c,d.useDataSources,d.outputDataSources)}},Pa=(e,t=!0)=>{let i;return(null==e?void 0:e.searchServiceType)===Lo.GeocodeService&&(i={id:null==e?void 0:e.outputDataSourceId,type:o.DataSourceTypes.FeatureLayer,label:null==e?void 0:e.label,originDataSources:[],isOutputFromWidget:t,isDataInDataSourceInstance:!1,schema:la(null==e?void 0:e.label,null==e?void 0:e.addressFields),geometryType:"esriGeometryPoint"}),i};function Ra(e){const t=o.DataSourceManager.getInstance().getDataSource(e);return t&&t.supportSpatialInfo&&!t.supportSpatialInfo()}const Ma=(e,t)=>t.map((t=>{if((null==e?void 0:e.dataSourceId)===(null==t?void 0:t.dataSourceId)){const i=(null==e?void 0:e.fields)||[],o=(null==t?void 0:t.fields)||[],a=Array.from(new Set(o.concat(i)));t.fields=a}return t}));var Na=v(79298),La=v(35809);const Da=e=>{const t={overrideItemBlockInfo:({itemBlockInfo:e},t)=>({name:G.TreeItemActionType.RenderOverrideItem,children:[{name:G.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:G.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:G.TreeItemActionType.RenderOverrideItemBody,children:[{name:G.TreeItemActionType.RenderOverrideItemMainLine,children:[{name:G.TreeItemActionType.RenderOverrideItemDragHandle},{name:G.TreeItemActionType.RenderOverrideItemIcon,autoCollapsed:!0},{name:G.TreeItemActionType.RenderOverrideItemTitle},{name:G.TreeItemActionType.RenderOverrideItemCommands}]}]}]}]}]})},i=o.css`
    &{
      max-height: 256px;
      overflow-y: auto;
    }
  `,a=(0,g.useTheme)(),{disPlayField:s,useDataSource:n,onFieldChange:r}=e;return(0,o.jsx)("div",{className:"w-100"},(0,o.jsx)(rt.FieldSelector,{useDataSources:n?(0,o.Immutable)([n]):(0,o.Immutable)([]),onChange:e=>{r(e,s,!0)},selectedFields:(0,o.Immutable)(null==s?void 0:s.map((e=>null==e?void 0:e.name))),isMultiple:!0,isDataSourceDropDownHidden:!0,useDropdown:!0,useMultiDropdownBottomTools:!0,types:(0,o.Immutable)([o.JimuFieldType.Number,o.JimuFieldType.String])}),(0,o.jsx)("div",{css:i},(0,o.jsx)(G.List,Object.assign({size:"sm",className:"mt-2",autoHandleFocus:!1,itemsJson:Array.from(s).map(((e,t)=>({itemStateDetailContent:e,itemKey:`${null==e?void 0:e.name}${t}`,itemStateIcon:rt.dataComponentsUtils.getIconFromFieldType(e.type,a),itemStateTitle:e.alias||e.jimuName||e.name,itemStateCommands:[]}))),dndEnabled:!0,onUpdateItem:(e,t)=>{const{itemJsons:i}=t.props,[,o]=i,a=o.map((e=>e.itemStateDetailContent));r(a,s,!0)}},t))))},{useEffect:Aa,useRef:Ea}=o.React,Fa=(0,o.Immutable)([o.AllDataSourceTypes.FeatureLayer,o.AllDataSourceTypes.SceneLayer,o.AllDataSourceTypes.BuildingComponentSubLayer,o.AllDataSourceTypes.OrientedImageryLayer,o.AllDataSourceTypes.ImageryLayer,o.AllDataSourceTypes.SubtypeGroupLayer,o.AllDataSourceTypes.SubtypeSublayer]),Ba=e=>{var t;const i=o.hooks.useTranslation(j.defaultMessages,o.defaultMessages),a=Ea(null),{trigger:s,isOpen:n,id:r,datasourceConfig:l,dsConfigItemIndex:c,popperFocusNode:d,viewId:p,propsForDataSourceSelector:u,showSearchInCurrentMapExtentSetting:m,hideDisplayFieldSetting:g,toggle:h,updateConfigForLayerOptions:v,onSettingChange:f,dsStatusChange:y,hideIconSetting:S,supportedDsTypes:b,hideDs:w}=e,x=(null==l?void 0:l[c])||(0,o.Immutable)({}),{configId:C,label:I,icon:k,searchFields:O,searchExact:T,displayFields:P,hint:R,useDataSource:M,searchInCurrentMapExtent:N}=x,[L,D]=o.React.useState(null),[A,E]=o.React.useState(I);Aa((()=>{C&&E(I)}),[C]),Aa((()=>{C&&I!==A&&E(I)}),[x]),Aa((()=>{n&&(clearTimeout(a.current),a.current=setTimeout((()=>{const e=document.querySelector(".search-ds-setting-popper .action-close");(0,o.focusElementInKeyboardMode)(e)}),200))}),[n]);const F=()=>{const e=fa(null==l?void 0:l.asMutable({deep:!0})),t=C||ya(e,p);let i=l?l.asMutable({deep:!0}):[];const a={configId:t,icon:null,label:"......",displayLabel:!0,useDataSource:null,displayFields:[],searchFields:[],hint:"",searchServiceType:Lo.FeatureService};i=i.map((e=>(null==e?void 0:e.configId)===t?a:e)),v((0,o.Immutable)(i))},B=(e,t,i=!1)=>{var a,s;if(!e)return;const n=i?"displayFields":"searchFields";let r=U(e);0===(null==r?void 0:r.length)&&(r=null===(s=null===(a=(0,o.Immutable)(t))||void 0===a?void 0:a.asMutable({deep:!0}))||void 0===s?void 0:s.splice(0,1));const d=null==l?void 0:l.asMutable({deep:!0});let p=null==x?void 0:x.setIn([n],r);p=xa(p),null==d||d.splice(c,1,null==p?void 0:p.asMutable({deep:!0})),v((0,o.Immutable)(d))},U=e=>null==e?void 0:e.filter((e=>(null==e?void 0:e.type)!==(null===o.JimuFieldType||void 0===o.JimuFieldType?void 0:o.JimuFieldType.Date))),z=(e,t)=>{const i=null==l?void 0:l.asMutable({deep:!0}),a=null==x?void 0:x.setIn(e,t);null==i||i.splice(c,1,null==a?void 0:a.asMutable({deep:!0})),f((0,o.Immutable)(i),null,p)},$=e=>{z(["searchExact"],!T)},V=e=>{var t;const i=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;E(i)},W=e=>{e?(E(null==e?void 0:e.trim()),z(["label"],null==e?void 0:e.trim())):E(I)},G=e=>{var t;const i=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;z(["hint"],i)},H=e=>{z(["searchInCurrentMapExtent"],!N)},_=(null==x?void 0:x.useDataSource)?[null===(t=null==x?void 0:x.useDataSource)||void 0===t?void 0:t.asMutable({deep:!0})]:[];return(0,o.jsx)(Na.SidePopper,{className:"search-ds-setting-popper",isOpen:n,position:"right",toggle:h,trigger:s,title:i("setLayerSource"),backToFocusNode:d},(0,o.jsx)("div",{className:"w-100 h-100",css:o.css`overflow: auto;`},(0,o.jsx)(Na.SettingSection,{style:{paddingTop:0}},(0,o.jsx)(Na.SettingRow,{flow:"wrap",label:i("data")},(0,o.jsx)(rt.DataSourceSelector,{closeDataSourceListOnChange:!0,hideDs:w,types:b?(0,o.Immutable)(b):Fa,useDataSources:(0,o.Immutable)(_),disableRemove:()=>!0,mustUseDataSource:!0,onChange:e=>{e&&e.length>0?1===(null==e?void 0:e.length)||C?(e=>{ka(e).then((t=>{const i=Ca({datasourceConfig:l,datasourceConfigItem:x,dsJsonOriginDs:t,useDataSource:e,configId:C});v((0,o.Immutable)(i.datasourceConfig))}))})(e[0]):(e=>{const t=e.map((e=>ka(e).then((t=>{const i=wa({datasourceConfig:l,datasourceConfigItem:x,dsJsonOriginDs:t,useDataSource:e,configId:null});return Promise.resolve(i)}))));Promise.all(t).then((e=>{const t=[];e=e.map((e=>{if(null==t?void 0:t.includes(null==e?void 0:e.configId)){const i=ya(t,p);e.configId=i}return t.push(e.configId),e}));let i=l?l.asMutable({deep:!0}):[];i=i.concat(e),v((0,o.Immutable)(i),!0)}))})(e):F()},widgetId:r,isBatched:!0,isMultiple:!C,disableDataView:null==u?void 0:u.disableDataView,fromDsIds:(null==u?void 0:u.fromDsIds)?(0,o.Immutable)(null==u?void 0:u.fromDsIds):null,fromRootDsIds:(null==u?void 0:u.fromRootDsIds)?(0,o.Immutable)(null==u?void 0:u.fromRootDsIds):null}))),(null==x?void 0:x.configId)&&L&&(0,o.jsx)("div",null,(0,o.jsx)(Na.SettingSection,null,(0,o.jsx)(Na.SettingRow,{flow:"wrap",label:i("label")},(0,o.jsx)(j.TextInput,{"aria-label":i("label"),size:"sm",value:A||"",onAcceptValue:W,onChange:V,className:"w-100",placeholder:i("findAddressOrPlace")}))),!S&&(0,o.jsx)(Na.SettingSection,null,(0,o.jsx)(Na.SettingRow,{label:i("searchIcon")},(0,o.jsx)(La.IconPicker,{icon:k,onChange:e=>{z(["icon"],e)},configurableOption:"none",setButtonUseColor:!1}))),(0,o.jsx)(Na.SettingSection,{title:i("searchOptions"),role:"group","aria-label":i("searchOptions")},(0,o.jsx)(Na.SettingRow,{flow:"wrap",label:i("selectSearchFields"),role:"group","aria-label":i("selectSearchFields")},(0,o.jsx)(rt.FieldSelectorWithFullTextIndex,{useDataSources:M?(0,o.Immutable)([M]):(0,o.Immutable)([]),onChange:e=>{B(e,O)},selectedFields:(0,o.Immutable)(null==O?void 0:O.map((e=>null==e?void 0:e.name))),isMultiple:!0,isDataSourceDropDownHidden:!0,useDropdown:!0,useMultiDropdownBottomTools:!0,widgetId:r,types:(0,o.Immutable)([o.JimuFieldType.Number,o.JimuFieldType.String])}),(0,o.jsx)("div",{className:"mt-2","aria-label":i("exactMatch"),onClick:$},(0,o.jsx)(j.Checkbox,{title:i("exactMatch"),checked:T,className:"mr-2"}),i("exactMatch"))),!g&&(0,o.jsx)(Na.SettingRow,{flow:"wrap",label:i("displayFields"),role:"group","aria-label":i("displayFields")},(0,o.jsx)(Da,{disPlayField:P||[],onFieldChange:B,useDataSource:M})),(0,o.jsx)(Na.SettingRow,{flow:"wrap",label:i("searchHint")},(0,o.jsx)(j.TextInput,{size:"sm",value:R||"",title:R||i("findAddressOrPlace"),"aria-label":i("searchHint"),onChange:G,className:"w-100",placeholder:i("findAddressOrPlace")})),!(!(null==x?void 0:x.useDataSource)||!m)&&!Ra(x.useDataSource.dataSourceId)&&(0,o.jsx)(Na.SettingRow,null,(0,o.jsx)("div",{className:"mt-2","aria-label":i("searchInCurrentMapExtent"),onClick:H},(0,o.jsx)(j.Checkbox,{title:i("searchInCurrentMapExtent"),checked:!!N,className:"mr-2"}),i("searchInCurrentMapExtent"))))),(null==_?void 0:_[0])&&(0,o.jsx)("div",{className:"waiting-for-database"},(0,o.jsx)(o.DataSourceComponent,{useDataSource:(0,o.Immutable)(_[0]),onDataSourceCreated:e=>{D(e),e&&y(e.id,!0)},onCreateDataSourceFailed:e=>{if(!(null==x?void 0:x.useDataSource))return!1;const t=x.useDataSource.dataSourceId;y(t,!1)}}))))};var Ua=v(96745),za=v.n(Ua),$a=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const Va=e=>{const t=window.SVG,{className:i}=e,a=$a(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:za()},a)):o.React.createElement("svg",Object.assign({className:s},a))},{useEffect:Wa,useRef:Ga}=o.React;var Ha;!function(e){e.Pass="Pass",e.NotHttps="Not_Https",e.InvalidURL="Invalid_URL"}(Ha||(Ha={}));const _a=[o.SupportedUtilityType.GeoCoding],Ja=/http(s)?:\/\/(geocode|geocodedev|geocodeqa)(\.){0,3}\.arcgis\.com\/arcgis\/rest\/services\/World\/GeocodeServer/g,Ka=e=>{const t=o.hooks.useTranslation(j.defaultMessages,o.defaultMessages),i=Ga(null),{id:a,trigger:s,toggle:n,isOpen:r,datasourceConfig:l,dsConfigItemIndex:c,popperFocusNode:d,createOutputDs:p,viewId:u,showSearchInCurrentMapExtentSetting:m,showEnableLocalSearchSetting:g,onSettingChange:h,updateConfigForLayerOptions:v,hideIconSetting:f}=e,y=(null==l?void 0:l[c])||(0,o.Immutable)({}),{configId:S,label:b,icon:w,hint:x,outputDataSourceId:C,displayFields:I,searchInCurrentMapExtent:k,enableLocalSearch:O}=y,[T,P]=o.React.useState(b),[R,M]=o.React.useState(!1),[N,L]=o.React.useState(Ha.Pass),[D,A]=o.React.useState(null==y?void 0:y.useUtility),[E,F]=o.React.useState(!1),[B,U]=o.React.useState(!1),[z,$]=o.React.useState(null),[V,W]=o.React.useState(null),[G,H]=o.React.useState(null),[_,J]=o.React.useState(!1);Wa((()=>{r&&(clearTimeout(i.current),i.current=setTimeout((()=>{const e=document.querySelector(".search-locator-setting-popper .action-close");(0,o.focusElementInKeyboardMode)(e)}),200))}),[r]),Wa((()=>{r&&(L(Ha.Pass),F(!1),(null==y?void 0:y.useUtility)?(oa(null==y?void 0:y.useUtility).then((e=>{M(!1),H(e),aa(e).then((e=>{M(!0),L(null==e?void 0:e.urlCheckResultType)}),(e=>{M(!0)}))})),A(null==y?void 0:y.useUtility),P(null==y?void 0:y.label)):(A(null),P(Ho)))}),[c,S,r]),Wa((()=>{P(null==y?void 0:y.label),U(!!(null==y?void 0:y.enableCountryCode)),$(null==y?void 0:y.countryCode),W(null==y?void 0:y.minScale)}),[y]),Wa((()=>{J(Ja.test(G))}),[G]);const K=(e,t)=>{const i=null==l?void 0:l.asMutable({deep:!0}),a=null==y?void 0:y.setIn(e,t);null==i||i.splice(c,1,null==a?void 0:a.asMutable({deep:!0})),h((0,o.Immutable)(i),null,u)},q=e=>{const t=e[0];if(A(t||null),t){F(!0);const e={id:a,createOutputDs:p,dataSourceConfigItem:y,viewId:u,configId:S,datasourceConfig:l,useUtility:null==t?void 0:t.asMutable({deep:!0})};M(!1),Yo(e).then((e=>{M(!0),F(!1);const{urlCheckResult:t,dataSourceConfig:i}=e;(null==t?void 0:t.urlCheckResultType)!==Ha.Pass?A(null):v((0,o.Immutable)(i))}),(e=>{M(!0)}))}else X()},X=()=>{const e=fa(null==l?void 0:l.asMutable({deep:!0})),t=S||ya(e,u);let i=l?l.asMutable({deep:!0}):[];const a={configId:t,icon:null,label:".....",hint:"",useUtility:null,searchServiceType:Lo.GeocodeService,singleLineFieldName:""};i=l.map((e=>(null==e?void 0:e.configId)===t?a:e)),v((0,o.Immutable)(i))},Y=o.css`
    &>div {
      padding: 0!important;
    }
  `,Q=e=>{var t;if(!e)return(0,o.Immutable)([]);const i=null===(t=(0,o.getAppStore)().getState().appStateInBuilder.appConfig)||void 0===t?void 0:t.utilities;if(null==i?void 0:i[e.utilityId])return(0,o.Immutable)([e]);(0,o.Immutable)([])},Z=(0,o.useIntl)();return(0,o.jsx)(Na.SidePopper,{className:"search-locator-setting-popper",isOpen:r,position:"right",toggle:n,trigger:s,title:t("setLocatorSource"),backToFocusNode:d},(0,o.jsx)("div",{className:"w-100 h-100",css:o.css`overflow: auto;`},(0,o.jsx)(Na.SettingSection,{style:{paddingTop:0}},(0,o.jsx)(Na.SettingRow,{flow:"wrap",label:t("locatorSource"),role:"group","aria-label":t("locatorSource")},(0,o.jsx)("div",{className:"w-100",css:Y},(0,o.jsx)(Jo.UtilitySelector,{useUtilities:Q(D),onChange:q,showRemove:!1,types:_a,closePopupOnSelect:!0})),N!==Ha.Pass&&R&&(0,o.jsx)("div",{className:"d-flex w-100 align-items-center justify-content-between mt-1"},(0,o.jsx)(j.Alert,{form:"basic",type:"warning",className:"w-100",open:!0,withIcon:!0,text:t("invalidUrlMessage")})))),E&&(0,o.jsx)(j.Loading,{type:j.LoadingType.Secondary}),N===Ha.Pass&&S&&D&&(0,o.jsx)("div",null,(0,o.jsx)(Na.SettingSection,null,(0,o.jsx)(Na.SettingRow,{flow:"wrap",label:t("label")},(0,o.jsx)(j.TextInput,{"aria-label":t("label"),size:"sm",value:T||"",onChange:e=>{var t;const i=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;P(i)},onAcceptValue:e=>{e?(P(null==e?void 0:e.trim()),K(["label"],null==e?void 0:e.trim())):P(b)},className:"w-100"}))),!f&&(0,o.jsx)(Na.SettingSection,null,(0,o.jsx)(Na.SettingRow,{label:t("searchIcon")},(0,o.jsx)(La.IconPicker,{icon:w,onChange:e=>{K(["icon"],e)},configurableOption:"none",setButtonUseColor:!1}))),(0,o.jsx)(Na.SettingSection,{title:t("searchOptions"),role:"group","aria-label":t("searchOptions")},C&&(0,o.jsx)(Na.SettingRow,{flow:"wrap",label:t("displayFields"),role:"group","aria-label":t("displayFields")},(0,o.jsx)(Da,{disPlayField:I||[],onFieldChange:(e,t,i=!1)=>{var a,s;if(!e)return;0===(null==e?void 0:e.length)&&(e=null===(s=null===(a=(0,o.Immutable)(t))||void 0===a?void 0:a.asMutable({deep:!0}))||void 0===s?void 0:s.splice(0,1));const n=null==l?void 0:l.asMutable({deep:!0}),r=null==y?void 0:y.setIn(["displayFields"],e);null==n||n.splice(c,1,null==r?void 0:r.asMutable({deep:!0})),v((0,o.Immutable)(n))},useDataSource:{dataSourceId:C,mainDataSourceId:C}})),(0,o.jsx)(Na.SettingRow,{flow:"wrap",label:t("searchHint")},(0,o.jsx)(j.TextInput,{size:"sm","aria-label":t("searchHint"),title:x||t("findAddressOrPlace"),value:x||"",onChange:e=>{var t;const i=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;K(["hint"],i)},className:"w-100",placeholder:t("findAddressOrPlace")})),g&&(0,o.jsx)(Na.SettingRow,{label:t("enableLocalSearch")},(0,o.jsx)(j.Switch,{title:t("enableLocalSearch"),checked:!!O,onChange:e=>{const t=!O,i=null==l?void 0:l.asMutable({deep:!0});let a=null==y?void 0:y.setIn(["enableLocalSearch"],t);t&&(a=a.setIn(["minScale"],Mo)),null==i||i.splice(c,1,null==a?void 0:a.asMutable({deep:!0})),h((0,o.Immutable)(i),null,u)}})),g&&!!O&&(0,o.jsx)(Na.SettingRow,{label:t("minScale"),flow:"wrap"},(0,o.jsx)(j.NumericInput,{"aria-label":t("minScale"),size:"sm",value:V,showHandlers:!1,onChange:e=>{W(e)},onAcceptValue:e=>{(e<0||!e)&&(e=Mo),W(e),K(["minScale"],e)},className:"w-100"})),_&&(0,o.jsx)(Na.SettingRow,null,(0,o.jsx)(j.Label,{className:"d-flex w-100 align-items-center",onClick:()=>{U(!B),K(["enableCountryCode"],!B)}},(0,o.jsx)(j.Checkbox,{className:"mr-2",checked:B}),(0,o.jsx)("div",null,t("searchCountryCodeLabel")))),(null==y?void 0:y.enableCountryCode)&&(0,o.jsx)(Na.SettingRow,null,(0,o.jsx)(j.TextInput,{placeholder:t("searchCountryCodeHint"),"aria-label":t("label"),size:"sm",value:z||"",onChange:e=>{var t;const i=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;$(i)},onAcceptValue:e=>{$(null==e?void 0:e.trim()),K(["countryCode"],null==e?void 0:e.trim())},className:"w-100",suffix:(0,o.jsx)(j.Button,{disableHoverEffect:!0,disableRipple:!0,type:"tertiary",size:"sm",target:"_blank",icon:!0,href:"https://developers.arcgis.com/rest/geocode/api-reference/geocode-coverage.htm"},(0,o.jsx)(Va,{autoFlip:!o.i18n.isSameLanguage(null==Z?void 0:Z.locale,"he")}))})),m&&(0,o.jsx)(Na.SettingRow,null,(0,o.jsx)(j.Label,{className:"d-flex w-100 align-items-center",onClick:e=>{K(["searchInCurrentMapExtent"],!k)}},(0,o.jsx)(j.Checkbox,{className:"mr-2",checked:!!k}),(0,o.jsx)("div",null,t("searchInCurrentMapExtent"))))))))},{useState:qa,useEffect:Xa}=o.React,Ya=e=>{const{datasourceConfig:t,dsStatusChange:i}=e,[a,s]=qa([]),n=e=>{e&&i(e.id,!0)};return Xa((()=>{const e=[];t.forEach((t=>{t.searchServiceType===Lo.FeatureService&&(null==t?void 0:t.useDataSource)&&e.push(null==t?void 0:t.useDataSource)})),s(e)}),[t]),(0,o.jsx)("div",{className:"data-source-list"},a.map(((e,t)=>(0,o.jsx)(o.DataSourceComponent,{key:t,useDataSource:e,onDataSourceCreated:n,onCreateDataSourceFailed:t=>{var o;o=e.dataSourceId,i(o,!1)}}))))};var Qa=function(e,t,i,o){return new(i||(i=Promise))((function(a,s){function n(e){try{l(o.next(e))}catch(e){s(e)}}function r(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,r)}l((o=o.apply(e,t||[])).next())}))};const{useState:Za,useRef:es}=o.React,ts=v(62838),is=o.css`
  .warning-alert-con {
    padding: 0 !important;
  }
  .warning-alert-con .jimu-icon-component {
    color: var(--sys-color-warning-light) !important;
  }
  .setting-ui-unit-list-new {
    margin-top: 4px;
  }
`,os=e=>{const t=o.hooks.useTranslation(o.defaultMessages,j.defaultMessages),i=es(!1),a=es(null),s=es(null),n=es(null),{className:r,datasourceConfig:l,useDataSources:c,dsConfigItemIndex:d,createOutputDs:p,showSourcePanel:u,showNewSourceItem:m,id:g,dataSourceCreateStatus:h,dsStatusChange:v,onDsConfigIdChange:f,updateConfigForLayerOptions:y,hideSidePopper:S}=e,b=o.ReactRedux.useSelector((e=>{var t,i,o;return null===(o=null===(i=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===i?void 0:i.widgets)||void 0===o?void 0:o[g]})),w=o.ReactRedux.useSelector((e=>{var t,i;return null===(i=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===i?void 0:i.widgets})),x={overrideItemBlockInfo:({itemBlockInfo:e},t)=>({name:G.TreeItemActionType.RenderOverrideItem,children:[{name:G.TreeItemActionType.RenderOverrideItemDroppableContainer,children:[{name:G.TreeItemActionType.RenderOverrideItemDraggableContainer,children:[{name:G.TreeItemActionType.RenderOverrideItemBody,children:[{name:G.TreeItemActionType.RenderOverrideItemMainLine,children:[{name:G.TreeItemActionType.RenderOverrideItemDragHandle},{name:G.TreeItemActionType.RenderOverrideItemIcon,autoCollapsed:!0},{name:G.TreeItemActionType.RenderOverrideItemTitle},{name:G.TreeItemActionType.RenderOverrideItemDetailToggle},{name:G.TreeItemActionType.RenderOverrideItemCommands}]}]}]}]}]})},[C,I]=Za(null),[k,O]=Za(null),[T,P]=Za(!1),[R,M]=Za(null);o.ReactRedux.useSelector((e=>{var i,a;const n={},r=(null===(a=null===(i=e.appStateInBuilder)||void 0===i?void 0:i.appRuntimeInfo)||void 0===a?void 0:a.utilityStates)||{};null==l||l.forEach((e=>{(null==e?void 0:e.searchServiceType)===Lo.GeocodeService&&(n[e.configId]=((e,i)=>{var a,s;if((null==e?void 0:e.searchServiceType)===Lo.FeatureService)return null;const n=null===(a=null==e?void 0:e.useUtility)||void 0===a?void 0:a.utilityId;return o.UtilityManager.getInstance().utilityHasSignInError(n)?t("signInErrorDefault"):!1===(null===(s=null==i?void 0:i[n])||void 0===s?void 0:s.success)?t("utilityNotAvailable"):null})(null==e?void 0:e.asMutable({deep:!0}),r))})),s.current=n}));const N=o.hooks.useEventCallback((()=>{const e=null==l?void 0:l.asMutable({deep:!0});null==e||e.splice(k,1),y((0,o.Immutable)(e)),S()})),L=e=>{var t;(null===(t=l[e])||void 0===t?void 0:t.searchServiceType)===Lo.GeocodeService?i.current?D(e):Qa(void 0,void 0,void 0,(function*(){return!i.current&&o.moduleLoader.loadModule("jimu-ui/advanced/data-source-selector").then((e=>(i.current=!0,a.current=e.dataComponentsUtils,n.current=e.DataSourceRemoveWaringReason,M(e.DataSourceRemoveWarningPopup),Promise.resolve(!0))))})).then((()=>{D(e)})):A(e)},D=o.hooks.useEventCallback((e=>{const t=l[e].outputDataSourceId;0===a.current.getWidgetsUsingDsOrItsDescendantDss(t,w).length?A(e):(I(t),P(!0),O(e))})),A=e=>{const t=null==l?void 0:l.asMutable({deep:!0});null==t||t.splice(e,1),y((0,o.Immutable)(t)),S()},E=o.hooks.useEventCallback((e=>{const t=(null==l?void 0:l.map((e=>null==e?void 0:e.configId)))||[],i=(null==e?void 0:e.map((e=>null==e?void 0:e.configId)))||[];return t.join("")!==i.join("")}));return(0,o.jsx)("div",{className:`w-100 mt-2 ${r||""}`,css:is},(0,o.jsx)(G.List,Object.assign({className:"w-100",itemsJson:Array.from(l).map(((e,i)=>{var o;return{itemStateDetailContent:e,itemKey:`${i}`,itemStateChecked:u&&i===d,itemStateTitle:null==e?void 0:e.label,itemStateIcon:{icon:null===(o=e.icon)||void 0===o?void 0:o.svg},itemStateCommands:[{label:t("deleteOption"),iconProps:()=>({icon:ts,size:12}),action:()=>{L(i)}}]}})),dndEnabled:!0,renderOverrideItemDetailToggle:(e,i)=>{var a,n;const{itemJsons:r}=i.props,[l]=r,d=null==l?void 0:l.itemStateDetailContent,u=(null==d?void 0:d.searchServiceType)===Lo.GeocodeService,m=u?null==d?void 0:d.outputDataSourceId:null===(a=null==d?void 0:d.useDataSource)||void 0===a?void 0:a.dataSourceId,g=!!p&&!((e,t=!1)=>{let i,o=!0;if(t){const t=(null==b?void 0:b.outputDataSources)||[];i=(null==t?void 0:t.filter((t=>e===t)).length)>0}else i=(null==c?void 0:c.filter((t=>e===t.dataSourceId)).length)>0;return"boolean"!=typeof(null==h?void 0:h[e])||(null==h?void 0:h[e])||(o=!1),i&&e&&o})(m,u),v=null===(n=s.current)||void 0===n?void 0:n[d.configId];return u&&v?(0,o.jsx)(j.Alert,{className:"warning-alert-con",variant:"text",form:"tooltip",size:"small",type:"warning",text:v}):g&&m?(0,o.jsx)(j.Alert,{variant:"text",form:"tooltip",size:"small",type:"error",text:t("dataSourceCreateError")}):""},onUpdateItem:(e,t)=>{const{itemJsons:i}=t.props,[,a]=i,s=a.map((e=>e.itemStateDetailContent));f(null),E(s)&&y((0,o.Immutable)(s))},onClickItemBody:(e,t)=>{var i;const{itemJsons:[o]}=t.props,a=(null===(i=null==o?void 0:o.itemStateDetailContent)||void 0===i?void 0:i.searchServiceType)===Lo.GeocodeService;f(+o.itemKey,a)}},x)),m&&(0,o.jsx)(G.List,Object.assign({className:"setting-ui-unit-list-new",itemsJson:[{name:"......"}].map(((e,t)=>({itemStateDetailContent:"item",itemKey:"index",itemStateChecked:!0,itemStateTitle:"......",itemStateCommands:[]}))),dndEnabled:!1,renderOverrideItemDetailToggle:()=>""},x)),R&&(0,o.jsx)(R,{dataSourceId:C,isOpen:T,toggle:()=>{P(!T)},reason:n.current.DataSourceRemoved,afterRemove:()=>{I(null),O(null),P(!1)},beforeRemove:N}),(0,o.jsx)(Ya,{datasourceConfig:l,dsStatusChange:v}))},{useSelector:as}=o.ReactRedux,{useRef:ss,useEffect:ns}=o.React,rs=e=>{var t,i,a,s;const n=o.hooks.useTranslation(j.defaultMessages,o.defaultMessages),r=(0,g.useTheme)(),{datasourceConfig:l,id:c,useDataSources:d,searchDataSettingType:p,showSearchInCurrentMapExtentSetting:u,createOutputDs:m,hideIconSetting:h,hideDisplayFieldSetting:v,enableFiltering:f,viewId:y,hideEnableFiltering:S,showEnableLocalSearchSetting:b,hideTitleOfNewSearchSource:w,propsForDataSourceSelector:x,autoSelectSingleGeocodeService:C,autoSelectAllOrgGeocodeService:I,onSettingChange:k,onOutputDsSettingChange:O,onEnableFilteringChange:T,supportedDsTypes:P,hideDs:R}=e,M=ss(null),N=ss(null),L=ss(!1),D=ss(null),A=ss(null),[E,F]=o.React.useState(!1),[B,U]=o.React.useState(!1),[z,$]=o.React.useState(!1),[V,W]=o.React.useState(!1),[G,H]=o.React.useState(null),[_,J]=o.React.useState(null),[K,q]=o.React.useState((0,o.Immutable)({})),[X,Y]=o.React.useState(!1),Q=as((e=>{var t,i,o;return null===(o=null===(i=null===(t=null==e?void 0:e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===i?void 0:i.widgets)||void 0===o?void 0:o[c]})),Z=as((e=>e.appStateInBuilder.appConfig.utilities)),ee=o.css`
    & {
      background-color: ${null===(i=null===(t=null==r?void 0:r.sys.color)||void 0===t?void 0:t.secondary)||void 0===i?void 0:i.main};
    }
  `,te=o.css`
    .data-remind {
      color: ${null===(s=null===(a=null==r?void 0:r.ref.palette)||void 0===a?void 0:a.neutral)||void 0===s?void 0:s[1e3]};
      font-size: ${o.polished.rem(12)};
    }
    .loading-con {
      height: 80px;
    }
  `;ns((()=>{D.current=null==l?void 0:l.asMutable({deep:!0}),m&&oe()}),[l]),ns((()=>{const e=(I||C)&&!A.current&&!L.current&&!l,t=D.current||[];if(e){const e={nls:n,id:c,createOutputDs:m,viewId:y,isSingle:C};L.current=!0,Y(!0),sa(e).then((e=>{if(L.current=!1,A.current=e,Y(!1),e){let i=t;i=null==e?void 0:e.concat(i),re((0,o.Immutable)(i))}}),(e=>{Y(!1),L.current=!1}))}}),[I,C]),ns((()=>{ie(Z)}),[Z]);const ie=e=>{let t=!1;const i=null==l?void 0:l.filter((i=>{var o;if((null==i?void 0:i.searchServiceType)===Lo.FeatureService)return!0;{const a=null===(o=null==i?void 0:i.useUtility)||void 0===o?void 0:o.utilityId;return!a||(!!(null==e?void 0:e[a])||(t=!0,!1))}}));t&&re(i)},oe=()=>{const e=(null==Q?void 0:Q.outputDataSources)||[],t=(null==l?void 0:l.asMutable({deep:!0}))||[];for(let i;i<(null==t?void 0:t.length)-1;i++){const o=t[i];if((null==o?void 0:o.searchServiceType)===Lo.FeatureService)continue;const a=null==o?void 0:o.outputDataSourceId;if(!(null==e?void 0:e.includes(a))){re(l);break}}},ae=(e,t=!1)=>{const i=K.set(e,t);q(i)},se=()=>{$(!1),U(!1),H(null)},ne=e=>{const t=e?!z:!B;if(W(t),t){const e=(null==l?void 0:l.length)||0;H(e),de(e,!0)}e?U(t):$(t)},re=(e,t=!1)=>{le(e)&&W(!1),t&&se();const i=Oa(e,m),o=Ta(i,c,m);m?O&&O(i.outputDataSources,e,o,y):k&&k(e,o,y)},le=e=>(null==e?void 0:e.length)!==(null==l?void 0:l.length),ce=()=>{var e;const t=null===(e=null==l?void 0:l.asMutable({deep:!0}))||void 0===e?void 0:e.filter((e=>(null==e?void 0:e.useDataSource)||(null==e?void 0:e.useUtility)));re((0,o.Immutable)(t))},de=(e,t=!1)=>{let i;i=t?N.current.getElementsByClassName("add-search-btn")[0]:N.current.getElementsByClassName("jimu-tree-item__body")[e],J(i)};return(0,o.jsx)("div",null,(0,o.jsx)(Na.SettingSection,{css:te},!w&&(0,o.jsx)(Na.SettingRow,{flow:"wrap"},(0,o.jsx)("span",{className:"w-100 data-remind",id:`addSources_${c}`},n("addSources"))),(0,o.jsx)(Na.SettingRow,{flow:"wrap"},(0,o.jsx)("div",{className:"w-100",ref:N},(0,o.jsx)("div",null,(!p||p===No.Both)&&(0,o.jsx)(j.Dropdown,{className:"w-100",size:"sm",toggle:()=>{F(!E)},isOpen:E,autoWidth:!0},(0,o.jsx)(j.DropdownButton,{"aria-describedby":`addSources_${c}`,className:"add-search-btn w-100",title:n("newSearchSource"),"aria-label":n("newSearchSource"),arrow:!1,icon:!0,type:"primary"},(0,o.jsx)("div",{className:"w-100 text-truncate"},(0,o.jsx)(Hi,{className:"mr-1 d-inline-block",autoFlip:!0}),n("newSearchSource"))),(0,o.jsx)(j.DropdownMenu,{css:ee},(0,o.jsx)(j.DropdownItem,{className:"w-100",onClick:()=>{ne(!0)},title:n("layerSource")},n("layerSource")),(0,o.jsx)(j.DropdownItem,{className:"w-100",onClick:()=>{ne(!1)},title:n("locatorSource")},n("locatorSource")))),p===No.FeatureService&&(0,o.jsx)(j.Button,{type:"primary",className:"w-100 add-search-btn",onClick:()=>{ne(!0)}},(0,o.jsx)(Hi,{className:"mr-1 d-inline-block",autoFlip:!0}),n("layerSource")),p===No.GeocodeService&&(0,o.jsx)(j.Button,{type:"primary",className:"w-100 add-search-btn",onClick:()=>{ne(!1)}},(0,o.jsx)(Hi,{className:"mr-1 d-inline-block",autoFlip:!0}),n("locatorSource"))),(0,o.jsx)("div",{className:"w-100",ref:M},(0,o.jsx)(os,{id:c,dsConfigItemIndex:G,datasourceConfig:l||(0,o.Immutable)([]),showSourcePanel:(()=>{var e;return(null===(e=null==l?void 0:l[G])||void 0===e?void 0:e.searchServiceType)===Lo.GeocodeService?z:B})(),useDataSources:d,onDsConfigIdChange:(e,t)=>{W(!1),"number"==typeof e?(de(e,!1),G===e?t?($(!z),U(!1)):(U(!B),$(!1)):(H(e),t?($(!0),U(!1)):(U(!0),$(!1)))):se()},showNewSourceItem:V,updateConfigForLayerOptions:re,hideSidePopper:se,dsStatusChange:ae,createOutputDs:m,dataSourceCreateStatus:K}))),(0,o.jsx)(Ba,{supportedDsTypes:P,hideDs:R,viewId:y,id:c,dsConfigItemIndex:G,datasourceConfig:l||(0,o.Immutable)([]),useDataSources:d,isOpen:B,onSettingChange:k,trigger:null==M?void 0:M.current,updateConfigForLayerOptions:re,toggle:()=>{B&&H(null),U(!B),W(!1),ce()},dsStatusChange:ae,popperFocusNode:_,hideIconSetting:h,hideDisplayFieldSetting:v,propsForDataSourceSelector:x,showSearchInCurrentMapExtentSetting:u}),(0,o.jsx)(Ka,{id:c,viewId:y,dsConfigItemIndex:G,datasourceConfig:l||(0,o.Immutable)([]),useDataSources:d,isOpen:z,onSettingChange:k,updateConfigForLayerOptions:re,trigger:null==M?void 0:M.current,toggle:()=>{z&&H(null),$(!z),W(!1),ce()},popperFocusNode:_,hideIconSetting:h,createOutputDs:m,showSearchInCurrentMapExtentSetting:u,showEnableLocalSearchSetting:b})),X&&(0,o.jsx)(Na.SettingRow,null,(0,o.jsx)("div",{className:"position-relative w-100 loading-con"},(0,o.jsx)(j.Loading,{type:j.LoadingType.Secondary})))),(p===No.Both||p===No.FeatureService)&&!S&&(0,o.jsx)(Na.SettingSection,null,(0,o.jsx)(Na.SettingRow,{tag:"label",label:n("enableSearchFilter")},(0,o.jsx)(j.Switch,{checked:f,onChange:e=>{const t=e.target.checked;T&&T(t)},title:n("enableSearchFilter")}))),(p===No.Both||p===No.FeatureService)&&(0,o.jsx)("span",null))};var ls=v(68972);const cs=e=>{const t=o.hooks.useTranslation(j.defaultMessages,o.defaultMessages),i=(0,g.useTheme)(),a=o.css`
    .check-box-label {
      color: ${i.ref.palette.neutral[1100]}
    }
    .search-setting-con {
      padding-left: 0;
      padding-right: 0;
    }
    .checkbox-con .jimu-widget-setting--row-label{
      max-width: 100%;
    }
    .cursor-pointer {
      cursor: pointer;
    }
  `,{onSettingChange:s,hideRecentSearchSetting:n}=e,r=e.settingConfig||(0,o.Immutable)({}),{maxSuggestions:l,isUseCurrentLoation:c,isShowRecentSearches:d,recentSearchesMaxNumber:p}=r,[u,m]=o.React.useState(p),[h,v]=o.React.useState(l);(0,ls.useEffect)((()=>{m(p),v(l)}),[r]);const f=(e,t)=>{const i=r.setIn(e,t);s&&s(i)},y=(e,t=1)=>{if(0===(null==e?void 0:e.length))return!0;if(isNaN(Number(e)))return!1;{const i=Number(e);return Number.isInteger(i)&&i>=t}};return(0,o.jsx)("div",{css:a},(0,o.jsx)(Na.SettingRow,{flow:"wrap",className:"mt-2 checkbox-con",label:t("maximumSuggestions")},(0,o.jsx)(j.TextInput,{size:"sm","aria-label":t("maximumSuggestions"),value:h,onChange:e=>{const t=e.target.value;y(t,0)&&v(t)},onAcceptValue:e=>{(!e||e>To)&&v(e=l||Oo),y(e,0)&&f(["maxSuggestions"],Number(e))},className:"w-100"})),(0,o.jsx)(Na.SettingRow,null,(0,o.jsx)("div",{className:"cursor-pointer d-flex align-items-center",onClick:e=>{f(["isUseCurrentLoation"],!c)},"aria-label":t("useCurrentLocation")},(0,o.jsx)(j.Checkbox,{checked:!!c,className:"mr-1",title:t("useCurrentLocation")}),(0,o.jsx)("span",{className:"check-box-label"},t("useCurrentLocation")))),!n&&(0,o.jsx)(Na.SettingRow,{tag:"label",label:t("recentSearches")},(0,o.jsx)(j.Switch,{checked:d||!1,title:t("recentSearches"),onChange:e=>{f(["isShowRecentSearches"],!d)}})),d&&(0,o.jsx)(Na.SettingRow,{label:t("maximumNumber")},(0,o.jsx)(j.TextInput,{size:"sm","aria-label":t("maximumNumber"),value:u,onChange:e=>{const t=e.target.value;y(t)&&m(t)},onAcceptValue:e=>{e||m(e=p||Po),y(e)&&f(["recentSearchesMaxNumber"],Number(e))},style:{width:"50px"}})))},ds=e=>{const t=o.hooks.useTranslation(j.defaultMessages,o.defaultMessages),{hint:i,allowSearchSourceSelection:a,enableAllowSearchSourceSelectionSetting:s,onGeneralSettingChange:n}=e,[r,l]=o.React.useState(i);(0,ls.useEffect)((()=>{l(i)}),[i]);return(0,o.jsx)("div",{className:"general-setting-con"},s&&(0,o.jsx)(Na.SettingRow,null,(0,o.jsx)("div",{className:"d-flex w-100 align-items-center",onClick:e=>{n&&n(["allowSearchSourceSelection"],!1===a)}},(0,o.jsx)(j.Checkbox,{"aria-label":t("allowSearchSourceSelection"),className:"mr-3",checked:!1!==a}),(0,o.jsx)("div",null,t("allowSearchSourceSelection")))),(0,o.jsx)(Na.SettingRow,{flow:"wrap",label:t("multiSearchHint")},(0,o.jsx)(j.TextInput,{"aria-label":t("multiSearchHint"),title:r||t("findAddressOrPlace"),size:"sm",value:r,onChange:e=>{var t;const i=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value;l(i)},onAcceptValue:e=>{l(e),n&&n(["hint"],e)},className:"w-100",placeholder:t("findAddressOrPlace")})))};var ps=v(53195),us=v.n(ps),ms=v(72529),gs=v.n(ms);var hs=["br","col","colgroup","dl","hr","iframe","img","input","link","menuitem","meta","ol","param","select","table","tbody","tfoot","thead","tr","ul","wbr"],vs={"accept-charset":"acceptCharset",acceptcharset:"acceptCharset",accesskey:"accessKey",allowfullscreen:"allowFullScreen",autocapitalize:"autoCapitalize",autocomplete:"autoComplete",autocorrect:"autoCorrect",autofocus:"autoFocus",autoplay:"autoPlay",autosave:"autoSave",cellpadding:"cellPadding",cellspacing:"cellSpacing",charset:"charSet",class:"className",classid:"classID",classname:"className",colspan:"colSpan",contenteditable:"contentEditable",contextmenu:"contextMenu",controlslist:"controlsList",crossorigin:"crossOrigin",dangerouslysetinnerhtml:"dangerouslySetInnerHTML",datetime:"dateTime",defaultchecked:"defaultChecked",defaultvalue:"defaultValue",enctype:"encType",for:"htmlFor",formmethod:"formMethod",formaction:"formAction",formenctype:"formEncType",formnovalidate:"formNoValidate",formtarget:"formTarget",frameborder:"frameBorder",hreflang:"hrefLang",htmlfor:"htmlFor",httpequiv:"httpEquiv","http-equiv":"httpEquiv",icon:"icon",innerhtml:"innerHTML",inputmode:"inputMode",itemid:"itemID",itemprop:"itemProp",itemref:"itemRef",itemscope:"itemScope",itemtype:"itemType",keyparams:"keyParams",keytype:"keyType",marginwidth:"marginWidth",marginheight:"marginHeight",maxlength:"maxLength",mediagroup:"mediaGroup",minlength:"minLength",nomodule:"noModule",novalidate:"noValidate",playsinline:"playsInline",radiogroup:"radioGroup",readonly:"readOnly",referrerpolicy:"referrerPolicy",rowspan:"rowSpan",spellcheck:"spellCheck",srcdoc:"srcDoc",srclang:"srcLang",srcset:"srcSet",tabindex:"tabIndex",typemustmatch:"typeMustMatch",usemap:"useMap",accentheight:"accentHeight","accent-height":"accentHeight",alignmentbaseline:"alignmentBaseline","alignment-baseline":"alignmentBaseline",allowreorder:"allowReorder",arabicform:"arabicForm","arabic-form":"arabicForm",attributename:"attributeName",attributetype:"attributeType",autoreverse:"autoReverse",basefrequency:"baseFrequency",baselineshift:"baselineShift","baseline-shift":"baselineShift",baseprofile:"baseProfile",calcmode:"calcMode",capheight:"capHeight","cap-height":"capHeight",clippath:"clipPath","clip-path":"clipPath",clippathunits:"clipPathUnits",cliprule:"clipRule","clip-rule":"clipRule",colorinterpolation:"colorInterpolation","color-interpolation":"colorInterpolation",colorinterpolationfilters:"colorInterpolationFilters","color-interpolation-filters":"colorInterpolationFilters",colorprofile:"colorProfile","color-profile":"colorProfile",colorrendering:"colorRendering","color-rendering":"colorRendering",contentscripttype:"contentScriptType",contentstyletype:"contentStyleType",diffuseconstant:"diffuseConstant",dominantbaseline:"dominantBaseline","dominant-baseline":"dominantBaseline",edgemode:"edgeMode",enablebackground:"enableBackground","enable-background":"enableBackground",externalresourcesrequired:"externalResourcesRequired",fillopacity:"fillOpacity","fill-opacity":"fillOpacity",fillrule:"fillRule","fill-rule":"fillRule",filterres:"filterRes",filterunits:"filterUnits",floodopacity:"floodOpacity","flood-opacity":"floodOpacity",floodcolor:"floodColor","flood-color":"floodColor",fontfamily:"fontFamily","font-family":"fontFamily",fontsize:"fontSize","font-size":"fontSize",fontsizeadjust:"fontSizeAdjust","font-size-adjust":"fontSizeAdjust",fontstretch:"fontStretch","font-stretch":"fontStretch",fontstyle:"fontStyle","font-style":"fontStyle",fontvariant:"fontVariant","font-variant":"fontVariant",fontweight:"fontWeight","font-weight":"fontWeight",glyphname:"glyphName","glyph-name":"glyphName",glyphorientationhorizontal:"glyphOrientationHorizontal","glyph-orientation-horizontal":"glyphOrientationHorizontal",glyphorientationvertical:"glyphOrientationVertical","glyph-orientation-vertical":"glyphOrientationVertical",glyphref:"glyphRef",gradienttransform:"gradientTransform",gradientunits:"gradientUnits",horizadvx:"horizAdvX","horiz-adv-x":"horizAdvX",horizoriginx:"horizOriginX","horiz-origin-x":"horizOriginX",imagerendering:"imageRendering","image-rendering":"imageRendering",kernelmatrix:"kernelMatrix",kernelunitlength:"kernelUnitLength",keypoints:"keyPoints",keysplines:"keySplines",keytimes:"keyTimes",lengthadjust:"lengthAdjust",letterspacing:"letterSpacing","letter-spacing":"letterSpacing",lightingcolor:"lightingColor","lighting-color":"lightingColor",limitingconeangle:"limitingConeAngle",markerend:"markerEnd","marker-end":"markerEnd",markerheight:"markerHeight",markermid:"markerMid","marker-mid":"markerMid",markerstart:"markerStart","marker-start":"markerStart",markerunits:"markerUnits",markerwidth:"markerWidth",maskcontentunits:"maskContentUnits",maskunits:"maskUnits",numoctaves:"numOctaves",overlineposition:"overlinePosition","overline-position":"overlinePosition",overlinethickness:"overlineThickness","overline-thickness":"overlineThickness",paintorder:"paintOrder","paint-order":"paintOrder","panose-1":"panose1",pathlength:"pathLength",patterncontentunits:"patternContentUnits",patterntransform:"patternTransform",patternunits:"patternUnits",pointerevents:"pointerEvents","pointer-events":"pointerEvents",pointsatx:"pointsAtX",pointsaty:"pointsAtY",pointsatz:"pointsAtZ",preservealpha:"preserveAlpha",preserveaspectratio:"preserveAspectRatio",primitiveunits:"primitiveUnits",refx:"refX",refy:"refY",renderingintent:"renderingIntent","rendering-intent":"renderingIntent",repeatcount:"repeatCount",repeatdur:"repeatDur",requiredextensions:"requiredExtensions",requiredfeatures:"requiredFeatures",shaperendering:"shapeRendering","shape-rendering":"shapeRendering",specularconstant:"specularConstant",specularexponent:"specularExponent",spreadmethod:"spreadMethod",startoffset:"startOffset",stddeviation:"stdDeviation",stitchtiles:"stitchTiles",stopcolor:"stopColor","stop-color":"stopColor",stopopacity:"stopOpacity","stop-opacity":"stopOpacity",strikethroughposition:"strikethroughPosition","strikethrough-position":"strikethroughPosition",strikethroughthickness:"strikethroughThickness","strikethrough-thickness":"strikethroughThickness",strokedasharray:"strokeDasharray","stroke-dasharray":"strokeDasharray",strokedashoffset:"strokeDashoffset","stroke-dashoffset":"strokeDashoffset",strokelinecap:"strokeLinecap","stroke-linecap":"strokeLinecap",strokelinejoin:"strokeLinejoin","stroke-linejoin":"strokeLinejoin",strokemiterlimit:"strokeMiterlimit","stroke-miterlimit":"strokeMiterlimit",strokewidth:"strokeWidth","stroke-width":"strokeWidth",strokeopacity:"strokeOpacity","stroke-opacity":"strokeOpacity",suppresscontenteditablewarning:"suppressContentEditableWarning",suppresshydrationwarning:"suppressHydrationWarning",surfacescale:"surfaceScale",systemlanguage:"systemLanguage",tablevalues:"tableValues",targetx:"targetX",targety:"targetY",textanchor:"textAnchor","text-anchor":"textAnchor",textdecoration:"textDecoration","text-decoration":"textDecoration",textlength:"textLength",textrendering:"textRendering","text-rendering":"textRendering",underlineposition:"underlinePosition","underline-position":"underlinePosition",underlinethickness:"underlineThickness","underline-thickness":"underlineThickness",unicodebidi:"unicodeBidi","unicode-bidi":"unicodeBidi",unicoderange:"unicodeRange","unicode-range":"unicodeRange",unitsperem:"unitsPerEm","units-per-em":"unitsPerEm",unselectable:"unselectable",valphabetic:"vAlphabetic","v-alphabetic":"vAlphabetic",vectoreffect:"vectorEffect","vector-effect":"vectorEffect",vertadvy:"vertAdvY","vert-adv-y":"vertAdvY",vertoriginx:"vertOriginX","vert-origin-x":"vertOriginX",vertoriginy:"vertOriginY","vert-origin-y":"vertOriginY",vhanging:"vHanging","v-hanging":"vHanging",videographic:"vIdeographic","v-ideographic":"vIdeographic",viewbox:"viewBox",viewtarget:"viewTarget",vmathematical:"vMathematical","v-mathematical":"vMathematical",wordspacing:"wordSpacing","word-spacing":"wordSpacing",writingmode:"writingMode","writing-mode":"writingMode",xchannelselector:"xChannelSelector",xheight:"xHeight","x-height":"xHeight",xlinkactuate:"xlinkActuate","xlink:actuate":"xlinkActuate",xlinkarcrole:"xlinkArcrole","xlink:arcrole":"xlinkArcrole",xlinkhref:"xlinkHref","xlink:href":"xlinkHref",xlinkrole:"xlinkRole","xlink:role":"xlinkRole",xlinkshow:"xlinkShow","xlink:show":"xlinkShow",xlinktitle:"xlinkTitle","xlink:title":"xlinkTitle",xlinktype:"xlinkType","xlink:type":"xlinkType",xmlbase:"xmlBase","xml:base":"xmlBase",xmllang:"xmlLang","xml:lang":"xmlLang","xml:space":"xmlSpace",xmlnsxlink:"xmlnsXlink","xmlns:xlink":"xmlnsXlink",xmlspace:"xmlSpace",ychannelselector:"yChannelSelector",zoomandpan:"zoomAndPan",onblur:"onBlur",onchange:"onChange",onclick:"onClick",oncontextmenu:"onContextMenu",ondoubleclick:"onDoubleClick",ondrag:"onDrag",ondragend:"onDragEnd",ondragenter:"onDragEnter",ondragexit:"onDragExit",ondragleave:"onDragLeave",ondragover:"onDragOver",ondragstart:"onDragStart",ondrop:"onDrop",onerror:"onError",onfocus:"onFocus",oninput:"onInput",oninvalid:"onInvalid",onkeydown:"onKeyDown",onkeypress:"onKeyPress",onkeyup:"onKeyUp",onload:"onLoad",onmousedown:"onMouseDown",onmouseenter:"onMouseEnter",onmouseleave:"onMouseLeave",onmousemove:"onMouseMove",onmouseout:"onMouseOut",onmouseover:"onMouseOver",onmouseup:"onMouseUp",onscroll:"onScroll",onsubmit:"onSubmit",ontouchcancel:"onTouchCancel",ontouchend:"onTouchEnd",ontouchmove:"onTouchMove",ontouchstart:"onTouchStart",onwheel:"onWheel"};function fs(e,t){const{key:i,level:o,...a}=t;switch(e.nodeType){case 1:return ls.createElement(function(e){if(/[a-z]+[A-Z]+[a-z]+/.test(e))return e;return e.toLowerCase()}(e.nodeName),function(e,t){const i={key:t};if(e instanceof Element){const t=e.getAttribute("class");t&&(i.className=t),[...e.attributes].forEach((e=>{switch(e.name){case"class":break;case"style":i[e.name]="string"!=typeof(t=e.value)?{}:t.split(/ ?; ?/).reduce(((e,t)=>{const[i,o]=t.split(/ ?: ?/).map(((e,t)=>0===t?e.replace(/\s+/g,""):e.trim()));if(i&&o){const t=i.replace(/(\w)-(\w)/g,((e,t,i)=>`${t}${i.toUpperCase()}`));let a=o.trim();Number.isNaN(Number(o))||(a=Number(o)),e[i.startsWith("-")?i:t]=a}return e}),{});break;case"allowfullscreen":case"allowpaymentrequest":case"async":case"autofocus":case"autoplay":case"checked":case"controls":case"default":case"defer":case"disabled":case"formnovalidate":case"hidden":case"ismap":case"itemscope":case"loop":case"multiple":case"muted":case"nomodule":case"novalidate":case"open":case"readonly":case"required":case"reversed":case"selected":case"typemustmatch":i[vs[e.name]||e.name]=!0;break;default:i[vs[e.name]||e.name]=e.value}var t}))}return i}(e,i),ys(e.childNodes,o,a));case 3:{const t=e.nodeValue?.toString()??"";if(!a.allowWhiteSpaces&&/^\s+$/.test(t)&&!/[\u00A0\u202F]/.test(t))return null;if(!e.parentNode)return t;const i=e.parentNode.nodeName.toLowerCase();return hs.includes(i)?(/\S/.test(t)&&console.warn(`A textNode is not allowed inside '${i}'. Your text "${t}" will be ignored`),null):t}case 8:default:return null;case 11:return ys(e.childNodes,o,t)}}function ys(e,t,i){const o=[...e].map(((e,o)=>bs(e,{...i,index:o,level:t+1}))).filter(Boolean);return o.length?o:null}function Ss(e,t={}){return"string"==typeof e?function(e,t={}){if(!e||"string"!=typeof e)return null;const{includeAllNodes:i=!1,nodeOnly:o=!1,selector:a="body > *",type:s="text/html"}=t;try{const n=(new DOMParser).parseFromString(e,s);if(i){const{childNodes:e}=n.body;return o?e:[...e].map((e=>bs(e,t)))}const r=n.querySelector(a)||n.body.childNodes[0];if(!(r instanceof Node))throw new TypeError("Error parsing input");return o?r:bs(r,t)}catch(e){0}return null}(e,t):e instanceof Node?bs(e,t):null}function bs(e,t={}){if(!(e&&e instanceof Node))return null;const{actions:i=[],index:o=0,level:a=0,randomKey:s}=t;let n=e,r=`${a}-${o}`;const l=[];return s&&0===a&&(r=`${function(e=6){const t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let i="";for(let o=e;o>0;--o)i+=t[Math.round(61*Math.random())];return i}()}-${r}`),Array.isArray(i)&&i.forEach((t=>{t.condition(n,r,a)&&("function"==typeof t.pre&&(n=t.pre(n,r,a),n instanceof Node||(n=e)),"function"==typeof t.post&&l.push(t.post(n,r,a)))})),l.length?l:fs(n,{key:r,level:a,...t})}var ws=Object.defineProperty,xs=(e,t,i)=>((e,t,i)=>t in e?ws(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i)(e,"symbol"!=typeof t?t+"":t,i),Cs="react-inlinesvg",Is={IDLE:"idle",LOADING:"loading",LOADED:"loaded",FAILED:"failed",READY:"ready",UNSUPPORTED:"unsupported"};function ks(){return!("undefined"==typeof window||!window.document?.createElement)}function js(){return function(){if(!document)return!1;const e=document.createElement("div");e.innerHTML="<svg />";const t=e.firstChild;return!!t&&"http://www.w3.org/2000/svg"===t.namespaceURI}()&&"undefined"!=typeof window&&null!==window}async function Os(e,t){const i=await fetch(e,t),o=i.headers.get("content-type"),[a]=(o??"").split(/ ?; ?/);if(i.status>299)throw new Error("Not found");if(!["image/svg+xml","text/plain"].some((e=>a.includes(e))))throw new Error(`Content type isn't valid: ${a}`);return i.text()}function Ts(e=1){return new Promise((t=>{setTimeout(t,1e3*e)}))}var Ps,Rs=class{constructor(){xs(this,"cacheApi"),xs(this,"cacheStore"),xs(this,"subscribers",[]),xs(this,"isReady",!1),this.cacheStore=new Map;let e=Cs,t=!1;ks()&&(e=window.REACT_INLINESVG_CACHE_NAME??Cs,t=!!window.REACT_INLINESVG_PERSISTENT_CACHE&&"caches"in window),t?caches.open(e).then((e=>{this.cacheApi=e})).catch((e=>{console.error(`Failed to open cache: ${e.message}`),this.cacheApi=void 0})).finally((()=>{this.isReady=!0;const e=[...this.subscribers];this.subscribers.length=0,e.forEach((e=>{try{e()}catch(e){console.error(`Error in CacheStore subscriber callback: ${e.message}`)}}))})):this.isReady=!0}onReady(e){this.isReady?e():this.subscribers.push(e)}async get(e,t){return await(this.cacheApi?this.fetchAndAddToPersistentCache(e,t):this.fetchAndAddToInternalCache(e,t)),this.cacheStore.get(e)?.content??""}set(e,t){this.cacheStore.set(e,t)}isCached(e){return this.cacheStore.get(e)?.status===Is.LOADED}async fetchAndAddToInternalCache(e,t){const i=this.cacheStore.get(e);if(i?.status!==Is.LOADING){if(!i?.content){this.cacheStore.set(e,{content:"",status:Is.LOADING});try{const i=await Os(e,t);this.cacheStore.set(e,{content:i,status:Is.LOADED})}catch(t){throw this.cacheStore.set(e,{content:"",status:Is.FAILED}),t}}}else await this.handleLoading(e,(async()=>{this.cacheStore.set(e,{content:"",status:Is.IDLE}),await this.fetchAndAddToInternalCache(e,t)}))}async fetchAndAddToPersistentCache(e,t){const i=this.cacheStore.get(e);if(i?.status===Is.LOADED)return;if(i?.status===Is.LOADING)return void await this.handleLoading(e,(async()=>{this.cacheStore.set(e,{content:"",status:Is.IDLE}),await this.fetchAndAddToPersistentCache(e,t)}));this.cacheStore.set(e,{content:"",status:Is.LOADING});const o=await(this.cacheApi?.match(e));if(o){const t=await o.text();this.cacheStore.set(e,{content:t,status:Is.LOADED})}else try{await(this.cacheApi?.add(new Request(e,t)));const i=await(this.cacheApi?.match(e)),o=await(i?.text())??"";this.cacheStore.set(e,{content:o,status:Is.LOADED})}catch(t){throw this.cacheStore.set(e,{content:"",status:Is.FAILED}),t}}async handleLoading(e,t){for(let t=0;t<10;t++){if(this.cacheStore.get(e)?.status!==Is.LOADING)return;await Ts(.1)}await t()}keys(){return[...this.cacheStore.keys()]}data(){return[...this.cacheStore.entries()].map((([e,t])=>({[e]:t})))}async delete(e){this.cacheApi&&await this.cacheApi.delete(e),this.cacheStore.delete(e)}async clear(){if(this.cacheApi){const e=await this.cacheApi.keys();await Promise.allSettled(e.map((e=>this.cacheApi.delete(e))))}this.cacheStore.clear()}};function Ms(e){const t=(0,ls.useRef)(void 0);return(0,ls.useEffect)((()=>{t.current=e})),t.current}function Ns(e){const{baseURL:t,content:i,description:o,handleError:a,hash:s,preProcessor:n,title:r,uniquifyIDs:l=!1}=e;try{const e=function(e,t){if(t)return t(e);return e}(i,n),a=Ss(e,{nodeOnly:!0});if(!(a&&a instanceof SVGSVGElement))throw new Error("Could not convert the src to a DOM Node");const c=Ls(a,{baseURL:t,hash:s,uniquifyIDs:l});if(o){const e=c.querySelector("desc");e?.parentNode&&e.parentNode.removeChild(e);const t=document.createElementNS("http://www.w3.org/2000/svg","desc");t.innerHTML=o,c.prepend(t)}if(void 0!==r){const e=c.querySelector("title");if(e?.parentNode&&e.parentNode.removeChild(e),r){const e=document.createElementNS("http://www.w3.org/2000/svg","title");e.innerHTML=r,c.prepend(e)}}return c}catch(e){return a(e)}}function Ls(e,t){const{baseURL:i="",hash:o,uniquifyIDs:a}=t,s=["id","href","xlink:href","xlink:role","xlink:arcrole"],n=["href","xlink:href"];return a?([...e.children].forEach((e=>{if(e.attributes?.length){const t=Object.values(e.attributes).map((e=>{const t=e,a=/url\((.*?)\)/.exec(e.value);return a?.[1]&&(t.value=e.value.replace(a[0],`url(${i}${a[1]}__${o})`)),t}));s.forEach((e=>{const i=t.find((t=>t.name===e));var a,s;i&&(a=e,s=i.value,!n.includes(a)||!s||s.includes("#"))&&(i.value=`${i.value}__${o}`)}))}return e.children.length?Ls(e,t):e})),e):e}function Ds(e){const{cacheRequests:t=!0,children:i=null,description:o,fetchOptions:a,innerRef:s,loader:n=null,onError:r,onLoad:l,src:c,title:d,uniqueHash:p}=e,[u,m]=(0,ls.useReducer)(((e,t)=>({...e,...t})),{content:"",element:null,isCached:t&&Ps.isCached(e.src),status:Is.IDLE}),{content:g,element:h,isCached:v,status:f}=u,y=Ms(e),S=Ms(u),b=(0,ls.useRef)(p??function(e){const t="abcdefghijklmnopqrstuvwxyz",i=`${t}${t.toUpperCase()}1234567890`;let o="";for(let t=0;t<e;t++)o+=(a=i)[Math.floor(Math.random()*a.length)];var a;return o}(8)),w=(0,ls.useRef)(!1),x=(0,ls.useRef)(!1),C=(0,ls.useCallback)((e=>{w.current&&(m({status:"Browser does not support SVG"===e.message?Is.UNSUPPORTED:Is.FAILED}),r?.(e))}),[r]),I=(0,ls.useCallback)(((e,t=!1)=>{w.current&&m({content:e,isCached:t,status:Is.LOADED})}),[]),k=(0,ls.useCallback)((async()=>{const e=await Os(c,a);I(e)}),[a,I,c]),j=(0,ls.useCallback)((()=>{try{const t=Ss(Ns({...e,handleError:C,hash:b.current,content:g}));if(!t||!(0,ls.isValidElement)(t))throw new Error("Could not convert the src to a React element");m({element:t,status:Is.READY})}catch(e){C(e)}}),[g,C,e]),O=(0,ls.useCallback)((async()=>{const e=/^data:image\/svg[^,]*?(;base64)?,(.*)/u.exec(c);let i;if(e?i=e[1]?window.atob(e[2]):decodeURIComponent(e[2]):c.includes("<svg")&&(i=c),i)I(i);else try{if(t){const e=await Ps.get(c,a);I(e,!0)}else await k()}catch(e){C(e)}}),[t,k,a,C,I,c]),T=(0,ls.useCallback)((async()=>{w.current&&m({content:"",element:null,isCached:!1,status:Is.LOADING})}),[]);(0,ls.useEffect)((()=>{if(w.current=!0,ks()&&!x.current){try{if(f===Is.IDLE){if(!js())throw new Error("Browser does not support SVG");if(!c)throw new Error("Missing src");T()}}catch(e){C(e)}return x.current=!0,()=>{w.current=!1}}}),[]),(0,ls.useEffect)((()=>{if(ks()&&y&&y.src!==c){if(!c)return void C(new Error("Missing src"));T()}}),[C,T,y,c]),(0,ls.useEffect)((()=>{f===Is.LOADED&&j()}),[f,j]),(0,ls.useEffect)((()=>{ks()&&y&&y.src===c&&(y.title===d&&y.description===o||j())}),[o,j,y,c,d]),(0,ls.useEffect)((()=>{if(S)switch(f){case Is.LOADING:S.status!==Is.LOADING&&O();break;case Is.LOADED:S.status!==Is.LOADED&&j();break;case Is.READY:S.status!==Is.READY&&l?.(c,v)}}),[O,j,v,l,S,c,f]);const P=function(e,...t){const i={};for(const o in e)({}).hasOwnProperty.call(e,o)&&(t.includes(o)||(i[o]=e[o]));return i}(e,"baseURL","cacheRequests","children","description","fetchOptions","innerRef","loader","onError","onLoad","preProcessor","src","title","uniqueHash","uniquifyIDs");return ks()?h?(0,ls.cloneElement)(h,{ref:s,...P}):[Is.UNSUPPORTED,Is.FAILED].includes(f)?i:n:n}const As={s:12,m:16,l:20},Es=e=>{let t=As.m;return Object.keys(As).includes(e)?t=As[e]:"string"!=typeof e&&"number"!=typeof e||(t=e),t=t||As.m,t},Fs=/\.svg$/,Bs=/<svg\b[^>]*>([\s\S]*?)<\/svg>/;var Us=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const zs=e=>o.React.createElement("svg",Object.assign({},e,{viewBox:"0,0,16,16"}),o.React.createElement("path",{d:"M16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8Z",fill:"currentColor"})),$s=e=>o.React.createElement("svg",Object.assign({},e),o.React.createElement("path",{d:"M4 4.7959L4.79602 4L8.0199 7.22388L11.204 4.03979L12 4.83569L8.81592 8.02002L11.9598 11.1641L11.1639 11.9602L8.0199 8.81592L4.83606 12L4.04004 11.2041L7.224 8.02002L4 4.7959Z",fill:"currentColor"}),o.React.createElement("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M0 4L4 0H12L16 4V12L12 16H4L0 12V4ZM1 4.41431L4.41418 1H11.5858L15 4.41431V11.5857L11.5858 15H4.41418L1 11.5857V4.41431Z",fill:"currentColor"})),Vs=(0,g.styled)((function(e){Ps||(Ps=new Rs);const{loader:t}=e,[i,o]=(0,ls.useState)(Ps.isReady);return(0,ls.useEffect)((()=>{i||Ps.onReady((()=>{o(!0)}))}),[i]),i?ls.default.createElement(Ds,{...e}):t}),{name:"SVG",part:"root"})((()=>({fill:"currentColor"}))),Ws=o.React.memo(o.React.forwardRef(((e,t)=>{var i;const{role:a,className:s,src:n,srcRTL:r,isRTL:l=(null===(i=(0,o.getAppStore)().getState().appContext)||void 0===i?void 0:i.isRTL),size:c="m",color:d,style:p,autoFlip:u=!1,currentColor:m=!0,preProcessor:g,width:h,height:v,loader:f,children:y,"aria-hidden":S=!0}=e,b=Us(e,["role","className","src","srcRTL","isRTL","size","color","style","autoFlip","currentColor","preProcessor","width","height","loader","children","aria-hidden"]),w=!0===S||"true"===S,x=!w,C=a||(w?"none":void 0),I=u&&l,k=I&&r,j=k?r:n,O=Es(c),T=h||O,P=v||O,R=Object.assign(Object.assign({},e),{size:O}),M=(0,o.classNames)("jimu-svg",s,"svg-component",{rtl:I&&!k}),N=o.React.useMemo((()=>f||o.React.createElement(zs,{type:"loading",className:M,width:T,height:P,color:"var(--ref-palette-neutral-600)"})),[M,P,f,T]),L=o.React.useMemo((()=>y||o.React.createElement($s,{type:"error",className:M,width:16,height:16,color:"var(--ref-palette-neutral-800)"})),[y,M]),D=o.React.useMemo((()=>{const e=(null==p?void 0:p.transform)||(I&&!k?"scaleX(-1)":"");return Object.assign(Object.assign({},p),{color:d,transform:e})}),[p,d,I,k]),A=o.React.useMemo((()=>{if(m||g)return e=>{var t;return e=null!==(t=null==g?void 0:g(e))&&void 0!==t?t:e,e=m?(e=>e.replace(/fill="(?!.*none).*?"/g,'fill="currentColor"').replace(/stroke="(?!.*none).*?"/g,'stroke="currentColor"'))(e):e}}),[m,g]);return o.React.createElement(Vs,Object.assign({role:C,styleState:R,focusable:x,className:M,width:T,height:P,src:j,style:D,loader:N,preProcessor:A,innerRef:t,"aria-hidden":S},b),L)}))),Gs=(0,g.styled)(Ws,{name:"Icon",part:"root"})(),Hs=(0,g.styled)("img",{name:"Icon",part:"img"})(),_s=o.React.memo(o.React.forwardRef(((e,t)=>{var i;const{className:a,style:s,icon:n,width:r,height:l,size:c="m",color:d,rotate:p,flip:u,title:m,options:h,currentColor:v=!0,autoFlip:f,role:y,"aria-label":S,"aria-hidden":b}=e,w=Es(c),x=r||w,C=l||w,I=h?h.currentColor:v,k=f&&(null===(i=(0,o.getAppStore)().getState().appContext)||void 0===i?void 0:i.isRTL),j="string"==typeof(O=n)&&O?Fs.test(O)||Bs.test(O):(console.warn("The `icon` should be a URL or a string (base64 or url encoded)."),!1);var O;const T=Object.assign(Object.assign({},e),{size:w,currentColor:I}),P=(e=>{const{flip:t}=e,i={root:[t&&`flip-${t}`],img:[t&&`flip-${t}`]};return g.utils.composeClasses("icon",i)})(T),R=o.React.useMemo((()=>{let e="";k&&(e="scaleX(-1)"),"vertical"===u?e="scaleY(-1)":"horizontal"===u&&(e="scaleX(-1)");return`${p?`rotate(${p}deg)`:""} ${e}`}),[u,k,p]),M=o.React.useMemo((()=>Object.assign(Object.assign({},s),{transform:R})),[s,R]),N=o.React.useMemo((()=>"string"==typeof n?o.appConfigUtils.processResourceUrl(n):void 0),[n]);return o.React.createElement(o.React.Fragment,null,j?o.React.createElement(Gs,{ref:t,styleState:T,src:n,color:d,width:x,height:C,className:(0,o.classNames)(P.root,a,{rtl:k}),style:M,title:m,autoFlip:!1,"aria-label":S||m,"aria-hidden":b,currentColor:I,role:y}):o.React.createElement(Hs,{ref:t,styleState:T,src:N,width:x,height:C,className:(0,o.classNames)(P.img,a,{rtl:k}),style:M,alt:null!=m?m:"",role:y}))})));var Js=v(28996),Ks=v.n(Js);const qs=e=>o.css`
    .multiple-map-item {
      position: relative;
      background-color: ${e.ref.palette.neutral[500]};
      .multiple-map-item__body {
        display: flex;
        align-items: center;
        padding: 0.375rem 0.5rem 0.375rem 0;
        margin: 0.25rem 0;
        background-color: ${e.ref.palette.neutral[500]};
        cursor: pointer;
        font-weight: 400;
        .multiple-map-item__icon {
          margin-left: 0.75rem;
          flex: 0 0 auto;
        }
        .multiple-map-item__title {
          margin-left: 0.375rem;
          flex: 1 1 0%;
          overflow: hidden;
          text-overflow: ellipsis;
          width: 0;
          min-width: 0;
        }
        .multiple-map-item__commands {
          margin-left: auto;
          flex: 0 0 auto;
          button {
            padding: 0;
          }
          .multiple-map-item-invalid-icon {
            color: var(--sys-color-warning-dark);
          }
        }
      }
      .multiple-map-item__childList {
        padding: 0 0.5rem 0.5rem 0.5rem;
      }
    }
    .multiple-map-item.active:after {
      border-left: 0.125rem solid ${e.sys.color.primary.main}!important;
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
    }
  `;function Xs(e){var t;const{mapWidgetId:i,itemJson:a,isDataSourceValid:s,showSelectedLayers:n,dndEnabled:r,onMapItemClick:l,onLayerItemClick:c,onLayerReorder:d}=e,[p,u]=o.React.useState(!1),m=o.React.useRef(null),h=(0,g.useTheme)(),{itemKey:v,itemStateTitle:f,itemStateIcon:y,itemStateChecked:S}=a,b=s&&!s(v).isValid,w=s&&!s(v).invalidMessage;return(0,o.jsx)("div",{className:"multiple-map-item-container",css:qs(h)},(0,o.jsx)("div",{className:(0,o.classNames)("multiple-map-item",S?"active":"")},(0,o.jsx)("div",{ref:m,role:"button",className:(0,o.classNames)("multiple-map-item__body"),onClick:()=>{l(a,m.current)},tabIndex:0,onKeyDown:e=>{"Space"!==e.code&&"Enter"!==e.code||e.target!==e.currentTarget||l(a,m.current)}},y&&(0,o.jsx)(_s,{size:16,icon:y.icon,className:"multiple-map-item__icon"}),(0,o.jsx)("div",{className:"multiple-map-item__title"},f),(0,o.jsx)("div",{className:"multiple-map-item__commands"},b&&(0,o.jsx)(j.Tooltip,{title:w,role:"tooltip"},(0,o.jsx)(j.Button,{icon:!0,variant:"text",className:"multiple-map-item-invalid-icon"},(0,o.jsx)(_s,{size:16,icon:Ks()}))),n&&(null===(t=a.itemChildren)||void 0===t?void 0:t.length)>0&&(0,o.jsx)(j.Button,{icon:!0,variant:"text",onClick:e=>{(e=>{e.stopPropagation(),u(!p)})(e)}},(0,o.jsx)(_s,{size:16,icon:p?Ee():Ne()})))),p&&a.itemChildren&&(0,o.jsx)(G.List,{className:"multiple-map-item__childList",itemsJson:a.itemChildren,dndEnabled:r,onClickItemBody:(e,t)=>{const i=t.dragRef.current.parentNode.parentNode;c(e,t,i)},onUpdateItem:(e,t)=>{if(e.updateType===G.TreeItemActionType.HandleDidDrop){const e=t.props.itemJsons[1];d&&d(`${i}-${v}`,e)}}})))}const Ys=()=>{const e=[];for(let t=0;t<2;t++)e.push({itemKey:t.toString(),itemStateCommands:[{iconProps:()=>({icon:" ",size:12,style:{opacity:0}})}]});return(0,o.jsx)(G.List,{className:"w-100",itemsJson:e,dndEnabled:!1,handleClickItemBody:()=>null})};const Qs=function(e){var t,i;const{mapWidgetId:a,disabled:s,disableSwitchMap:n=!1,onClick:r,onMapItemClick:l,onLayerItemClick:c,sidePopperContent:d,isDataSourceValid:p,showDefaultMapWhenEmpty:u,keepLastTimeMap:m=!1,"aria-describedby":g="",showSelectedLayers:h=!1,selectedJimuLayerViewIds:v,children:f,dndEnabled:y,onLayerReorder:S}=e,b=o.React.useRef(""),w=o.React.useRef(""),x=o.React.useRef(null),[C,I]=o.React.useState(!1),[k,O]=o.React.useState(!1),[T,P]=o.React.useState(null),[R,M]=o.React.useState(""),[N,L]=o.React.useState(null),[D,A]=o.React.useState(null),E=H.MapViewManager.getInstance().getJimuMapViewGroup(a),[F,B]=o.React.useState(!1),U=o.hooks.useTranslation(j.defaultMessages),z=o.ReactRedux.useSelector((e=>{var t,i,o;const s=e.appStateInBuilder;return s&&(null===(o=null===(i=null===(t=null==s?void 0:s.appConfig)||void 0===t?void 0:t.widgets)||void 0===i?void 0:i[a])||void 0===o?void 0:o.useDataSources)})),$=o.ReactRedux.useSelector((e=>{const t=e.appStateInBuilder;return t&&(null==t?void 0:t.dataSourcesInfo)}),((e,t)=>{if(z){for(const i of z)if(e&&t&&e[i.dataSourceId]!==t[i.dataSourceId])return!1;return!0}return!0}));o.React.useEffect((()=>{if(!F)if(z&&0!==(null==z?void 0:z.length)){let e=0;for(const t of z){const i=null==$?void 0:$[t.dataSourceId];!i||i.instanceStatus!==o.DataSourceStatus.Created&&i.instanceStatus!==o.DataSourceStatus.CreateError||(e++,e===z.length&&B(!0))}}else B(!0)}),[F,$,z]);const V=o.React.useCallback((e=>{if(!e)return"";return e.getLabel()||(null==e?void 0:e.getDataSourceJson().sourceLabel)||e.id}),[]),W=e=>{const t=[];return e.forEach((e=>{if(t.push(e),e.allLayers){const i=e.allLayers;t.push(...W(i))}e.sublayers&&e.sublayers.length&&t.push(...W(e.sublayers))})),t},G=null===(i=null===(t=null==z?void 0:z.asMutable({deep:!0}))||void 0===t?void 0:t.sort(((e,t)=>e.dataSourceId.localeCompare(t.dataSourceId))))||void 0===i?void 0:i.map((e=>{const t=o.DataSourceManager.getInstance().getDataSource(e.dataSourceId);let i=null;const n=`${a}-${e.dataSourceId}`;return t?(i={itemStateTitle:V(t),itemStateChecked:e.dataSourceId===b.current,itemKey:e.dataSourceId,itemStateDisabled:s,itemStateIcon:{icon:t.type===o.DataSourceTypes.WebScene?gs():us()}},h&&(i.itemChildren=(e=>{const t=v[e];if(!t||0===t.length)return null;const i=H.MapViewManager.getInstance().getJimuMapViewById(e);if(!i)return null;const o=[],a=W(i.view.map.allLayers),s=i.view.map.tables;for(const e of a.concat(...s)){const a=i.getJimuLayerViewIdByAPILayer(e),s=t.indexOf(a);-1!==s&&(o[s]={itemKey:a,itemStateTitle:null==e?void 0:e.title,itemStateChecked:w.current===a})}return o})(n))):i={itemStateTitle:U("none"),itemKey:e.dataSourceId,itemStateDisabled:!0},i})),_=o.React.useCallback((()=>!u||z&&0!==z.length?{itemKey:"root",itemChildren:G}:{itemKey:"root",itemChildren:[{itemStateTitle:U("multipleMapDefaultWebMap"),itemKey:"default",itemStateChecked:"default"===b.current,itemStateDisabled:s,itemStateIcon:{icon:us()}}]}),[G,s,u,U,z]);o.React.useEffect((()=>{if(!(null==E?void 0:E.jimuMapViews))return;const e=Object.keys(null==E?void 0:E.jimuMapViews).map((e=>null==E?void 0:E.jimuMapViews[e].whenJimuMapViewLoaded()));Promise.all(e).then((()=>{var e;const t=(null===(e=null==E?void 0:E.getActiveJimuMapView())||void 0===e?void 0:e.dataSourceId)||"";L(t.length>0?t:" "),A(t.length>0?t:" ")})).catch((e=>{console.error(e)}))}),[E,null==E?void 0:E.jimuMapViews]);const J=(e,t)=>{const i=e;p&&!p(i.itemKey).isValid||(L(i.itemKey),P(t),r&&r(i.itemKey),l&&l(i.itemKey),b.current!==i.itemKey||k?(b.current=i.itemKey,M(i.itemStateTitle),I(!0),O(!1),w.current=""):(b.current="",I(!1)),n||!E||i.itemKey===N||i.itemKey.includes(N)||E.switchMap())},K=(e,t,i)=>{const{itemJsons:o}=t.props,a=o[0];P(i),c&&c(a.itemKey),w.current!==a.itemKey||C?(w.current=a.itemKey,M(a.itemStateTitle),O(!0),C&&(I(!1),b.current="")):(w.current="",O(!1))};return o.React.useEffect((()=>()=>{n||!C||D===N||m||(E.switchMap(),L(D))}),[N,D,n,E,C,m]),(0,o.jsx)("div",{ref:x,className:"w-100 multiple-jimu-map-config-component","aria-describedby":g},F&&N?(0,o.jsx)(o.React.Fragment,null,_().itemChildren.map((e=>(0,o.jsx)(Xs,{key:e.itemKey,mapWidgetId:a,itemJson:e,showSelectedLayers:h,onMapItemClick:J,onLayerItemClick:K,dndEnabled:y,onLayerReorder:S}))),(0,o.jsx)(Na.SidePopper,{position:"right",isOpen:C,toggle:()=>{I(!1),b.current="",(0,o.focusElementInKeyboardMode)(null==x?void 0:x.current)},title:R,trigger:null==x?void 0:x.current,backToFocusNode:T},d),(0,o.jsx)(Na.SidePopper,{position:"right",isOpen:k,toggle:()=>{O(!1),w.current="",(0,o.focusElementInKeyboardMode)(null==x?void 0:x.current)},title:R,trigger:null==x?void 0:x.current,backToFocusNode:T},f)):(0,o.jsx)(Ys,null))};var Zs,en;!function(e){e.AUTO="Auto",e.CUSTOM="Custom"}(Zs||(Zs={})),function(e){e.Default="DEFAULT",e.Selected="SELECTED",e.Hover="HOVER"}(en||(en={}));var tn=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const on=e=>{const t=window.SVG,{className:i}=e,a=tn(e,["className"]),s=(0,o.classNames)("jimu-icon jimu-icon-component",i);return t?o.React.createElement(t,Object.assign({className:s,src:Ks()},a)):o.React.createElement("svg",Object.assign({className:s},a))},an=e=>{const{layout:t,config:i,widgetId:o,status:a,isCardWidget:s,mainSizeMode:n}=e,r=(null==e?void 0:e.layouts)||{},l=(null==r?void 0:r[a])||{},c=(0,b.getAppConfigAction)();Object.keys(l).forEach((e=>{const t=O.searchUtils.findLayoutId(l,e,n);t&&c.removeLayout(t)}));const d=nn(i,s,t,a);(null==r?void 0:r[a])&&delete r[a],c.editWidgetConfig(o,d),c.editWidgetProperty(o,"layouts",r),c.exec()},sn=e=>{const{layout:t,config:i,widgetId:a,appConfig:s,status:n,label:r,isCardWidget:l,mainSizeMode:c}=e,d=(null==e?void 0:e.layouts)||{},p=(0,b.getAppConfigAction)(),u=(null==d?void 0:d[en.Default])||{};Object.keys(u).forEach((e=>{var t;const i=null===(t=s.widgets[a].layouts[n])||void 0===t?void 0:t[e];i&&p.removeLayout(i);const l=O.searchUtils.findLayoutId(d[en.Default],e,c),u=p.duplicateLayout(l,!1);p.editLayoutProperty(u.id,"label",r),p.editWidgetProperty(a,`layouts.${n}.${e}`,u.id),p.editLayoutProperty(u.id,"parent",{type:o.LayoutParentType.Widget,id:a})}));const m=nn(i,l,t,n);p.editWidgetConfig(a,m),p.exec()};function nn(e,t,i,o){let a=e;return a=t?e.set("cardLayout",i):e.setIn(["cardConfigs",o,"listLayout"],i),a}const rn=o.css`
  .jimu-radio {
    cursor: pointer;
  }
  .clear-padding {
    padding-left: 0;
    padding-right: 0;
  }
`,ln=o.css`
  & .modal-content {
    border: none;
  }
  .header-con {
    & {
      border: none;
      padding: ${o.polished.rem(30)};
      padding-bottom: 0;
    }
    svg {
      color: var(--sys-color-warning-main);
      border-bottom: none;
      margin-right: ${o.polished.rem(12)} !important;
    }
  }
  .modal-body {
    padding: ${o.polished.rem(24)} ${o.polished.rem(30)};
  }
  .modal-footer {
    & {
      padding: ${o.polished.rem(30)};
      padding-top: 0;
    }
  }
`,cn=e=>{const{id:t,cardLayout:i,status:a,isCardWidget:s,layouts:n,mainSizeMode:r,config:l,appConfig:c}=e,[d,p]=(0,ls.useState)(!1),[u,m]=(0,ls.useState)(null),[g,h]=(0,ls.useState)(null),[v,f]=(0,ls.useState)(null),y=o.React.useRef(i),S=o.React.useRef(i);(0,ls.useEffect)((()=>{y.current=e.cardLayout,S.current=e.cardLayout}),[a,e]);const b=()=>{p(!d),y.current=S.current},w=()=>{const e={layout:y.current,config:l,widgetId:t,appConfig:c,status:a,label:I(a.toLowerCase()),isCardWidget:s,layouts:null==n?void 0:n.asMutable({deep:!0}),mainSizeMode:r};y.current===Zs.AUTO?an(e):sn(e),p(!1),S.current=y.current},x=e=>{S.current!==e&&(e===Zs.AUTO?(m(I("remindAutoLayoutTitle")),h(I("remindAutoLayoutText")),f("")):(m(I("remindCustomLayoutTitle")),h(I("remindCustomLayoutText")),f(I("remindCustomLayoutBottomText"))),p(!0),y.current=e)},I=o.hooks.useTranslation(j.defaultMessages,o.defaultMessages);return(0,o.jsx)("div",{css:rn,role:"group","aria-label":I("layout")},(0,o.jsx)(C,{className:"clear-padding",title:I("layout")},(0,o.jsx)(k,{flow:"wrap"},(0,o.jsx)("div",{className:"d-flex align-items-center",onClick:()=>{x(Zs.AUTO)}},(0,o.jsx)(j.Radio,{title:I("auto"),checked:i===Zs.AUTO,className:"mr-2"})," ",I("auto"))),(0,o.jsx)(k,null,(0,o.jsx)("div",{className:"d-flex align-items-center",onClick:()=>{x(Zs.CUSTOM)}},(0,o.jsx)(j.Radio,{title:I("custom"),checked:i===Zs.CUSTOM||!i,className:"mr-2"})," ",I("custom"))),(0,o.jsx)(j.Modal,{isOpen:d,toggle:b,centered:!0,css:ln},(0,o.jsx)(j.ModalHeader,{className:"header-con"},(0,o.jsx)(on,{className:"mr-2",size:24}),u),(0,o.jsx)(j.ModalBody,null,(0,o.jsx)("div",null,g),v&&(0,o.jsx)("div",{className:"mt-5"},v)),(0,o.jsx)(j.ModalFooter,null,(0,o.jsx)(j.Button,{title:I("ok"),type:"primary",onClick:w},I("ok")),(0,o.jsx)(j.Button,{title:I("cancel"),onClick:()=>{p(!1)}},I("cancel"))))))};function dn(e){const{mapViewId:t,isCustomizeEnabled:i,isShowRuntimeAddedLayerEnabled:a,selectedValues:s,showTable:n=!0,onToggleCustomize:r,onShowRuntimeAddedLayersChange:l,onSelectedLayerIdChange:c,showRuntimeAddedLayerOption:d=!0,extraSettingOptions:p,hideLayers:u,disableLayers:m}=e,g=o.hooks.useTranslation(j.defaultMessages,o.defaultMessages);return(0,o.jsx)("div",{className:"w-100 h-100 layer-item-panel"},(0,o.jsx)(Na.SettingSection,null,(0,o.jsx)(Na.SettingRow,{tag:"label",label:g("customizeLayers")},(0,o.jsx)(j.Switch,{className:"can-x-switch",checked:i,"data-key":"customizeLayers",onChange:e=>{(e=>{const i=(0,Na.getAllItemsInMapView)(t,n);r(e,i)})(e.target.checked)}})),i&&d&&(0,o.jsx)(Na.SettingRow,{tag:"label",label:g("showRuntimeAddedLayers")},(0,o.jsx)(j.Switch,{className:"can-x-switch",checked:a,"data-key":"showRuntimeAddedLayers",onChange:e=>{l(e.target.checked)}})),i&&p),i&&(0,o.jsx)(Na.SettingSection,null,(0,o.jsx)(Na.SettingRow,null,(0,o.jsx)(Na.JimuLayerViewSelector,{key:t,jimuMapViewId:t,onChange:c,isMultiSelection:!0,selectedValues:s[t].asMutable(),isShowTables:n,hideLayers:u,disableLayers:m}))))}function pn(e){const{mapWidgetId:t,onMapItemClick:i,onLayerItemClick:a,mapViewId:s,isCustomizeEnabled:n,isShowRuntimeAddedLayerEnabled:r,showTable:l,onToggleCustomize:c,onShowRuntimeAddedLayersChange:d,onSelectedLayerIdChange:p,selectedValues:u,showSelectedLayers:m=!1,children:g,dndEnabled:h=!1,onLayerReorder:v,extraSettingOptions:f,showRuntimeAddedLayerOption:y,hideLayers:S,disableLayers:b}=e;return o.React.createElement(Qs,{mapWidgetId:t,onLayerItemClick:a,onMapItemClick:i,showSelectedLayers:m,selectedJimuLayerViewIds:u,dndEnabled:h,onLayerReorder:v,sidePopperContent:o.React.createElement(dn,{mapViewId:s,isCustomizeEnabled:n,isShowRuntimeAddedLayerEnabled:r,showTable:l,onToggleCustomize:c,onShowRuntimeAddedLayersChange:d,onSelectedLayerIdChange:p,selectedValues:u,extraSettingOptions:f,showRuntimeAddedLayerOption:y,hideLayers:S,disableLayers:b})},g)}function un(e,t){const i=H.MapViewManager.getInstance().getJimuMapViewById(e);if(!i)return[];let o=Object.keys((null==i?void 0:i.jimuLayerViews)||{}).filter((e=>!i.jimuLayerViews[e].fromRuntime));return t&&(o=o.concat(...Object.keys(null==i?void 0:i.jimuTables))),o}var mn=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(i[o[a]]=e[o[a]])}return i};const gn=o.React.memo((e=>{const{messageWidgetId:t,messageType:i,clearInvalid:a=!0,defaultSelectAll:s=!0,types:n,useDataSources:r=(0,o.Immutable)([]),onChange:l}=e,c=mn(e,["messageWidgetId","messageType","clearInvalid","defaultSelectAll","types","useDataSources","onChange"]),{fromRootDsIds:d,fromDsIds:p,allUseDataSources:u}=o.React.useMemo((()=>{let e=(0,o.Immutable)([]),a=(0,o.Immutable)([]),s=(0,o.Immutable)([]);const r=o.DataSourceManager.getInstance();return(b.messageActionUtils.getDsByWidgetId(t,i)||(0,o.Immutable)([])).forEach((t=>{const i=r.getDataSource(t.dataSourceId);if(i)if(i.type===o.DataSourceTypes.WebMap||i.type===o.DataSourceTypes.WebScene){const a=i;e=e.concat([t.dataSourceId]);const r=a.getAllChildDataSources().filter((e=>n.includes(e.type))).map((e=>o.dataSourceUtils.getUseDataSourceByDataSource(e)));s=s.concat(r)}else a=a.concat([i.isDataView?i.getMainDataSource().id:i.id]),s=s.concat(t)})),{fromRootDsIds:e.length>0?e:void 0,fromDsIds:0===e.length?a:void 0,allUseDataSources:s}}),[n,i,t]),m=o.hooks.useLatest(r);return o.React.useEffect((()=>{const e=(null==u?void 0:u.map((e=>e.mainDataSourceId)))||[],t=m.current.filter((t=>e.includes(t.dataSourceId)||e.includes(t.mainDataSourceId)||e.includes(t.rootDataSourceId)));a&&t.length<m.current.length&&l(t.asMutable({deep:!0}))}),[u,a,l,m]),o.React.useEffect((()=>{s&&0===m.current.length&&l(u.asMutable({deep:!0}))}),[u,s,l,m]),o.React.createElement(rt.DataSourceSelector,Object.assign({types:n,useDataSources:r,fromRootDsIds:d,fromDsIds:p,onChange:l,mustUseDataSource:!0,isMultiple:!0,isMultipleDataView:!0,hideAddDataButton:!0,hideDataView:!0,hideTypeDropdown:!0,enableToSelectOutputDsFromSelf:!0},c))}));function hn(e){var t,i;const a=(0,o.getAppStore)().getState().appStateInBuilder,s=a.appRuntimeInfo.currentPageId,n=a.appRuntimeInfo.currentDialogId;let r=a.appRuntimeInfo.dialogInfos||(0,o.Immutable)({});const l=a.appConfig.dialogs,c=a.appConfig.pages,d={canClose:!0,checked:!0,isClosed:!0};return n&&((null===(t=l[n])||void 0===t?void 0:t.isSplash)&&(r=r.set(n,d)),c[s].autoOpenDialogId&&(r=r.set(s+"-"+c[s].autoOpenDialogId,d)),e&&Object.keys(c).forEach((e=>{c[e].autoOpenDialogId===n&&(r=r.set(e+"-"+n,d))}))),(null===(i=l[n])||void 0===i?void 0:i.isSplash)||Object.keys(l).some((e=>{l[e].isSplash&&(r=r.set(e,d))})),e&&r&&Object.keys(r).forEach((t=>{t!==e&&t!==s+"-"+e||(r=r.set(t,{canClose:vn(e),checked:!1,isClosed:!1}))})),r}function vn(e){const t=(0,o.getAppStore)().getState().appStateInBuilder.appConfig.dialogs[e];return!t.interactionType||!t.confirmBeforeClose}function fn(e){const t=(0,o.getAppStore)().getState().appStateInBuilder,i=t.appRuntimeInfo.currentPageId,a=t.appRuntimeInfo.currentDialogId;if(b.builderAppSync.publishChangeSelectionToApp(null),a){const e=hn();b.builderAppSync.publishDialogInfosChangeToApp(e),b.builderAppSync.publishDialogChangeToApp(null)}i!==e&&b.builderAppSync.publishPageChangeToApp(e),b.builderAppSync.publishActivePagePartChangeToApp(o.PagePart.Body)}function yn(e,t=!1){b.builderAppSync.publishChangeSelectionToApp(null);const i=(0,o.getAppStore)().getState().appStateInBuilder.appRuntimeInfo.currentDialogId;if(t||e!==i){b.builderAppSync.publishDialogChangeToApp(e);const t=hn(e);b.builderAppSync.publishDialogInfosChangeToApp(t),b.builderAppSync.publishActivePagePartChangeToApp(null)}}(0,g.registerStyles)("jimu-ui/advanced/setting-components/",e)})(),f})())}}}));