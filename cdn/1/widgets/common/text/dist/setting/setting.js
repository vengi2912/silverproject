System.register(["jimu-core","jimu-for-builder","jimu-ui/advanced/setting-components","jimu-ui/advanced/rich-text-editor","jimu-ui","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/expression-builder","jimu-ui/advanced/dynamic-style-builder"],(function(e,t){var n={},o={},a={},l={},i={},r={},s={},c={};return{setters:[function(e){n.DataSourceTypes=e.DataSourceTypes,n.DynamicStyleType=e.DynamicStyleType,n.Immutable=e.Immutable,n.React=e.React,n.ReactRedux=e.ReactRedux,n.appConfigUtils=e.appConfigUtils,n.classNames=e.classNames,n.css=e.css,n.dynamicStyleUtils=e.dynamicStyleUtils,n.getAppStore=e.getAppStore,n.hooks=e.hooks,n.jsx=e.jsx},function(e){o.builderAppSync=e.builderAppSync},function(e){a.SettingRow=e.SettingRow,a.SettingSection=e.SettingSection},function(e){l.RichTextFormatKeys=e.RichTextFormatKeys,l.RichTextFormats=e.RichTextFormats,l.richTextEditorUtils=e.richTextEditorUtils,l.useEditorSelectionFormats=e.useEditorSelectionFormats},function(e){i.Button=e.Button,i.Switch=e.Switch,i.TextArea=e.TextArea,i.defaultMessages=e.defaultMessages,i.richTextUtils=e.richTextUtils},function(e){r.DataSourceSelector=e.DataSourceSelector},function(e){s.ExpressionInput=e.ExpressionInput,s.ExpressionInputType=e.ExpressionInputType},function(e){c.DynamicStyleBuilderSwitch=e.DynamicStyleBuilderSwitch}],execute:function(){e((()=>{var e={4108:e=>{"use strict";e.exports=o},9759:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M3.5 2a.5.5 0 0 0 0 1H7l-1.868 8.406a.488.488 0 0 0 .953.212L8 3h3.5a.5.5 0 0 0 0-1zm-1 11a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zm6.64-3.86a.477.477 0 0 1 .674 0l1.686 1.686 1.686-1.686a.477.477 0 1 1 .674.674L12.174 11.5l1.686 1.686a.477.477 0 1 1-.674.674L11.5 12.174 9.814 13.86a.477.477 0 1 1-.674-.674l1.686-1.686L9.14 9.814a.477.477 0 0 1 0-.674" clip-rule="evenodd"></path></svg>'},13089:e=>{"use strict";e.exports=r},14321:e=>{"use strict";e.exports=i},33949:e=>{"use strict";e.exports=l},79244:e=>{"use strict";e.exports=n},79298:e=>{"use strict";e.exports=a},84845:e=>{"use strict";e.exports=s},85252:e=>{"use strict";e.exports=c}},t={};function u(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,u),a.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var n in t)u.o(t,n)&&!u.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="";var p={};return u.p=window.jimuConfig.baseUrl,(()=>{"use strict";u.r(p),u.d(p,{__set_webpack_public_path__:()=>O,default:()=>R});var e=u(79244),t=u(4108),n=u(79298),o=u(33949),a=u(14321),l=u(13089);const i={verticalAlignment:"Vertical alignment"};var r=u(84845);var s=u(9759),c=u.n(s),d=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(n[o[a]]=e[o[a]])}return n};const y=t=>{const n=window.SVG,{className:o}=t,a=d(t,["className"]),l=(0,e.classNames)("jimu-icon jimu-icon-component",o);return n?e.React.createElement(n,Object.assign({className:l,src:c()},a)):e.React.createElement("svg",Object.assign({className:l},a))};var m=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(n[o[a]]=e[o[a]])}return n};const S=e.css`
  > * {
    user-select: none;
  }
`,g=t=>{const{editor:n,onChange:l}=t,i=m(t,["editor","onChange"]),[,r]=(0,o.useEditorSelectionFormats)(n,!0),s=e.hooks.useTranslation(a.defaultMessages);return(0,e.jsx)(a.Button,Object.assign({css:S},i,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{o.richTextEditorUtils.clearFormats(n,r),null==l||l(null==n?void 0:n.root.innerHTML)},title:s("clearAllFormats"),"aria-label":s("clearAllFormats")}),(0,e.jsx)(y,null))};var b=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(n[o[a]]=e[o[a]])}return n};const f=t=>{const{editor:n,defaultColor:a}=t,l=b(t,["editor","defaultColor"]),[i,r]=(0,o.useEditorSelectionFormats)(n,!0),s=e.React.useMemo((()=>{var e;let t=i;return null!=(null===(e=null==t?void 0:t.link)||void 0===e?void 0:e.link)&&(t=Object.assign(Object.assign({},t),{link:t.link.link})),!t.color&&a&&(t=Object.assign(Object.assign({},t),{color:a})),t}),[i,a]);return e.React.createElement(o.RichTextFormats,Object.assign({editor:n,formats:s,selection:r},l))};var v=u(85252);const x=(0,e.Immutable)([e.DataSourceTypes.FeatureLayer,e.DataSourceTypes.SceneLayer,e.DataSourceTypes.BuildingComponentSubLayer,e.DataSourceTypes.OrientedImageryLayer,e.DataSourceTypes.ImageryLayer,e.DataSourceTypes.SubtypeGroupLayer,e.DataSourceTypes.SubtypeSublayer]),h=(0,e.Immutable)([e.DynamicStyleType.Text,e.DynamicStyleType.Background]),w=(0,e.Immutable)([e.DynamicStyleType.Text,e.DynamicStyleType.Background]),T=(0,e.Immutable)([r.ExpressionInputType.Static,r.ExpressionInputType.Attribute,r.ExpressionInputType.Statistics,r.ExpressionInputType.Expression]),E=(0,e.Immutable)([]),R=s=>{var c,u,p,d,y,m,S,b,R;const{id:O,config:j,useDataSources:D,useDataSourcesEnabled:I,onSettingChange:C}=s,A="Web Experience Template"===(null===(u=null===(c=(0,e.getAppStore)().getState().appStateInBuilder)||void 0===c?void 0:c.appInfo)||void 0===u?void 0:u.type),M=j.style,U=null===(p=null==M?void 0:M.wrap)||void 0===p||p,F=null!==(d=null==M?void 0:M.enableDynamicStyle)&&void 0!==d&&d,k=null==M?void 0:M.dynamicStyleConfig,P=j.text,B=j.placeholder,L=e.React.useMemo((()=>{var e;return null!==(e=a.richTextUtils.getHTMLTextContent(B))&&void 0!==e?e:""}),[B]),_=e.React.useMemo((()=>{var e,t;return Object.values(null!==(t=null===(e=a.richTextUtils.getAllExpressions(P))||void 0===e?void 0:e.asMutable({deep:!0}))&&void 0!==t?t:{})}),[P]),N=j.tooltip,V=e.ReactRedux.useSelector((e=>e.appStateInBuilder)),H=null===(m=null===(y=null==V?void 0:V.widgetsMutableStateVersion)||void 0===y?void 0:y[O])||void 0===m?void 0:m.editor,W=null===(b=null===(S=null==V?void 0:V.widgetsRuntimeInfo)||void 0===S?void 0:S[O])||void 0===b?void 0:b.isInlineEditing,z=I&&(null==D?void 0:D.length)>0,[K,G]=e.React.useState(null),[q,J]=e.React.useState(!1);e.React.useEffect((()=>{var e;const t=window._appWindow._mutableStoreManager,n=null!==(e=null==t?void 0:t.getStateValue([O,"editor"]))&&void 0!==e?e:null;G(n)}),[H,O]);const Q=e.hooks.useTranslation(i,a.defaultMessages),X=(t,n,l)=>{const i=a.richTextUtils.isBlankRichText(P)&&!!B,r=!W&&i?"placeholder":"text";t="text"===r?e.appConfigUtils.restoreResourceUrl(t):t;let s=j.set(r,t);W||n!==o.RichTextFormatKeys.Color||(s=s.setIn(["style","color"],l)),C({id:O,config:s})},Y=e.React.useMemo((()=>z?T:(0,e.Immutable)([r.ExpressionInputType.Static])),[z]);return e.React.createElement("div",{className:"widget-setting-text jimu-widget-setting"},e.React.createElement(n.SettingSection,null,e.React.createElement(n.SettingRow,null,e.React.createElement(l.DataSourceSelector,{isMultiple:!0,types:x,useDataSources:D,useDataSourcesEnabled:I,onToggleUseDataEnabled:()=>{var e;t.builderAppSync.publishWidgetToolbarStateChangeToApp(O,["text-expression","text-arcade"]);const n=j.without("tooltip").set("style",null===(e=j.style)||void 0===e?void 0:e.without("enableDynamicStyle").without("dynamicStyleConfig")),o=!I;C(!N&&!F||o?{id:O,useDataSourcesEnabled:o}:{id:O,config:n,useDataSourcesEnabled:o})},onChange:n=>{var o,a,l;if(t.builderAppSync.publishWidgetToolbarStateChangeToApp(O,["text-expression","text-arcade"]),null==n){const e=j.set("style",null===(o=j.style)||void 0===o?void 0:o.without("enableDynamicStyle").without("dynamicStyleConfig"));C({id:O,config:e})}else if(null===(a=j.style)||void 0===a?void 0:a.enableDynamicStyle){let t;const o=e.dynamicStyleUtils.updateDynamicStyleWhenUseDataSourcesChange(O,D,(0,e.Immutable)(n),(0,e.Immutable)(j.style.dynamicStyleConfig));t=o?j.setIn(["style","dynamicStyleConfig"],o):j.set("style",null===(l=j.style)||void 0===l?void 0:l.without("enableDynamicStyle").without("dynamicStyleConfig")),C({id:O,config:t,useDataSources:n})}else C({id:O,useDataSources:n})},widgetId:O}))),e.React.createElement(n.SettingSection,null,e.React.createElement(n.SettingRow,{flow:"no-wrap",tag:"label",label:Q("wrap")},e.React.createElement(a.Switch,{checked:U,onChange:()=>{C({id:O,config:j.setIn(["style","wrap"],!U)})}})),e.React.createElement(n.SettingRow,{label:Q("tooltip"),flow:"wrap",role:"group","aria-label":Q("tooltip")},e.React.createElement("div",{className:"w-100"},e.React.createElement(r.ExpressionInput,{"aria-label":Q("tooltip"),autoHide:!0,useDataSources:z?D:E,onChange:e=>{null!=e&&(C({id:O,config:j.set("tooltip",e)}),J(!1))},openExpPopup:()=>{J(!0)},expression:"object"==typeof N?N:null,isExpPopupOpen:q,closeExpPopup:()=>{J(!1)},types:Y,widgetId:O}))),A&&e.React.createElement(n.SettingRow,{flow:"wrap",label:Q("placeholder")},e.React.createElement(a.TextArea,{"aria-label":Q("placeholder"),defaultValue:L,onAcceptValue:e=>{e=e.replace(/\n/gm,"");const t=((e,t)=>{const n=a.richTextUtils.getHTMLTextContent(e);return e.replace(null==n?void 0:n.trim(),t)})(B,e);C({id:O,config:j.set("placeholder",t)})}}))),null!=K&&e.React.createElement(n.SettingSection,null,e.React.createElement(n.SettingRow,{flow:"no-wrap",label:Q("textFormat"),role:"group","aria-label":Q("textFormat")},e.React.createElement(g,{editor:K,onChange:X})),e.React.createElement(n.SettingRow,null,e.React.createElement(f,{widgetId:O,editor:K,defaultColor:null===(R=j.style)||void 0===R?void 0:R.color,useDataSources:D,onChange:X}))),z&&e.React.createElement(n.SettingSection,null,e.React.createElement(n.SettingRow,null,e.React.createElement(v.DynamicStyleBuilderSwitch,{widgetId:O,disabled:W,useDataSources:D,expressions:_,widgetDynamicContentCapability:"multiple",useIconsForArcade:!1,config:k,onChange:e=>{const t=j.setIn(["style","dynamicStyleConfig"],e);C({id:O,config:t})},switchChecked:F,onSwitchChange:(e,t)=>{let n=j.setIn(["style","enableDynamicStyle"],t);t||(n=n.set("style",n.style.without("dynamicStyleConfig"))),C({id:O,config:n})},conditionStyleTypes:h,arcacdeStyleTypes:w}))))};function O(e){u.p=e}})(),p})())}}}));